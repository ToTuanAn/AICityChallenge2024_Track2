2024-03-08 21:38:24,059:INFO: Effective parameters:
2024-03-08 21:38:24,059:INFO:   <<< batch_size: 64
2024-03-08 21:38:24,059:INFO:   <<< batch_size_val: 16
2024-03-08 21:38:24,059:INFO:   <<< cache_dir: 
2024-03-08 21:38:24,059:INFO:   <<< cdcr: 0
2024-03-08 21:38:24,059:INFO:   <<< clip_evl: True
2024-03-08 21:38:24,059:INFO:   <<< coef_lr: 0.002
2024-03-08 21:38:24,059:INFO:   <<< cross_model: cross-base
2024-03-08 21:38:24,059:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:38:24,059:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:38:24,059:INFO:   <<< datatype: activity
2024-03-08 21:38:24,059:INFO:   <<< do_eval: False
2024-03-08 21:38:24,059:INFO:   <<< do_lower_case: False
2024-03-08 21:38:24,059:INFO:   <<< do_pretrain: False
2024-03-08 21:38:24,059:INFO:   <<< do_train: True
2024-03-08 21:38:24,059:INFO:   <<< epochs: 30
2024-03-08 21:38:24,059:INFO:   <<< eval_frame_order: 0
2024-03-08 21:38:24,059:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:38:24,059:INFO:   <<< feature_framerate: 1
2024-03-08 21:38:24,059:INFO:   <<< features_path: 
2024-03-08 21:38:24,059:INFO:   <<< fp16: False
2024-03-08 21:38:24,059:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:38:24,059:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:38:24,059:INFO:   <<< gpu: 0
2024-03-08 21:38:24,059:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:38:24,059:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:38:24,059:INFO:   <<< init_model: None
2024-03-08 21:38:24,059:INFO:   <<< interaction: no
2024-03-08 21:38:24,059:INFO:   <<< linear_patch: 2d
2024-03-08 21:38:24,059:INFO:   <<< local_rank: 0
2024-03-08 21:38:24,059:INFO:   <<< loose_type: True
2024-03-08 21:38:24,059:INFO:   <<< lr: 0.001
2024-03-08 21:38:24,059:INFO:   <<< lr_decay: 0.9
2024-03-08 21:38:24,059:INFO:   <<< margin: 0.1
2024-03-08 21:38:24,059:INFO:   <<< max_frames: 64
2024-03-08 21:38:24,059:INFO:   <<< max_words: 77
2024-03-08 21:38:24,060:INFO:   <<< mergeclip: False
2024-03-08 21:38:24,060:INFO:   <<< mergeweight: 0.5
2024-03-08 21:38:24,060:INFO:   <<< n_display: 50
2024-03-08 21:38:24,060:INFO:   <<< n_gpu: 1
2024-03-08 21:38:24,060:INFO:   <<< n_pair: 1
2024-03-08 21:38:24,060:INFO:   <<< negative_weighting: 1
2024-03-08 21:38:24,060:INFO:   <<< num_thread_reader: 1
2024-03-08 21:38:24,060:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:38:24,060:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:38:24,060:INFO:   <<< pretrained_path: 
2024-03-08 21:38:24,060:INFO:   <<< rank: 0
2024-03-08 21:38:24,060:INFO:   <<< resume_model: None
2024-03-08 21:38:24,060:INFO:   <<< sampled_use_mil: False
2024-03-08 21:38:24,060:INFO:   <<< seed: 42
2024-03-08 21:38:24,060:INFO:   <<< sim_header: meanP
2024-03-08 21:38:24,060:INFO:   <<< slice_framepos: 2
2024-03-08 21:38:24,060:INFO:   <<< task_type: retrieval
2024-03-08 21:38:24,060:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:38:24,060:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:38:24,060:INFO:   <<< train_frame_order: 0
2024-03-08 21:38:24,060:INFO:   <<< use_mil: False
2024-03-08 21:38:24,060:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:38:24,060:INFO:   <<< video_dim: 1024
2024-03-08 21:38:24,060:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:38:24,060:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:38:24,060:INFO:   <<< world_size: 1
2024-03-08 21:38:24,060:INFO:   <<< wti_arch: 0
2024-03-08 21:38:24,060:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:39:55,650:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:39:55,651:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:39:55,651:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:39:55,651:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:39:55,651:WARNING: Test retrieval by loose type.
2024-03-08 21:39:55,651:WARNING: 	 embed_dim: 768
2024-03-08 21:39:55,651:WARNING: 	 image_resolution: 224
2024-03-08 21:39:55,651:WARNING: 	 vision_layers: 24
2024-03-08 21:39:55,651:WARNING: 	 vision_width: 1024
2024-03-08 21:39:55,651:WARNING: 	 vision_patch_size: 14
2024-03-08 21:39:55,651:WARNING: 	 context_length: 77
2024-03-08 21:39:55,651:WARNING: 	 vocab_size: 49408
2024-03-08 21:39:55,651:WARNING: 	 transformer_width: 768
2024-03-08 21:39:55,651:WARNING: 	 transformer_heads: 12
2024-03-08 21:39:55,651:WARNING: 	 transformer_layers: 12
2024-03-08 21:39:55,651:WARNING: 		 linear_patch: 2d
2024-03-08 21:39:55,651:WARNING: 	 cut_top_layer: 0
2024-03-08 21:43:10,049:INFO: Effective parameters:
2024-03-08 21:43:10,049:INFO:   <<< batch_size: 64
2024-03-08 21:43:10,049:INFO:   <<< batch_size_val: 16
2024-03-08 21:43:10,049:INFO:   <<< cache_dir: 
2024-03-08 21:43:10,049:INFO:   <<< cdcr: 0
2024-03-08 21:43:10,049:INFO:   <<< clip_evl: True
2024-03-08 21:43:10,049:INFO:   <<< coef_lr: 0.002
2024-03-08 21:43:10,049:INFO:   <<< cross_model: cross-base
2024-03-08 21:43:10,049:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:43:10,050:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:43:10,050:INFO:   <<< datatype: activity
2024-03-08 21:43:10,050:INFO:   <<< do_eval: False
2024-03-08 21:43:10,050:INFO:   <<< do_lower_case: False
2024-03-08 21:43:10,050:INFO:   <<< do_pretrain: False
2024-03-08 21:43:10,050:INFO:   <<< do_train: True
2024-03-08 21:43:10,050:INFO:   <<< epochs: 30
2024-03-08 21:43:10,050:INFO:   <<< eval_frame_order: 0
2024-03-08 21:43:10,050:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:43:10,050:INFO:   <<< feature_framerate: 1
2024-03-08 21:43:10,050:INFO:   <<< features_path: 
2024-03-08 21:43:10,050:INFO:   <<< fp16: False
2024-03-08 21:43:10,050:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:43:10,050:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:43:10,050:INFO:   <<< gpu: 0
2024-03-08 21:43:10,050:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:43:10,050:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:43:10,050:INFO:   <<< init_model: None
2024-03-08 21:43:10,050:INFO:   <<< interaction: no
2024-03-08 21:43:10,050:INFO:   <<< linear_patch: 2d
2024-03-08 21:43:10,050:INFO:   <<< local_rank: 0
2024-03-08 21:43:10,050:INFO:   <<< loose_type: True
2024-03-08 21:43:10,050:INFO:   <<< lr: 0.001
2024-03-08 21:43:10,050:INFO:   <<< lr_decay: 0.9
2024-03-08 21:43:10,050:INFO:   <<< margin: 0.1
2024-03-08 21:43:10,050:INFO:   <<< max_frames: 64
2024-03-08 21:43:10,050:INFO:   <<< max_words: 77
2024-03-08 21:43:10,050:INFO:   <<< mergeclip: False
2024-03-08 21:43:10,050:INFO:   <<< mergeweight: 0.5
2024-03-08 21:43:10,050:INFO:   <<< n_display: 50
2024-03-08 21:43:10,050:INFO:   <<< n_gpu: 1
2024-03-08 21:43:10,050:INFO:   <<< n_pair: 1
2024-03-08 21:43:10,050:INFO:   <<< negative_weighting: 1
2024-03-08 21:43:10,050:INFO:   <<< num_thread_reader: 1
2024-03-08 21:43:10,050:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:43:10,050:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:43:10,050:INFO:   <<< pretrained_path: 
2024-03-08 21:43:10,050:INFO:   <<< rank: 0
2024-03-08 21:43:10,050:INFO:   <<< resume_model: None
2024-03-08 21:43:10,050:INFO:   <<< sampled_use_mil: False
2024-03-08 21:43:10,050:INFO:   <<< seed: 42
2024-03-08 21:43:10,050:INFO:   <<< sim_header: meanP
2024-03-08 21:43:10,050:INFO:   <<< slice_framepos: 2
2024-03-08 21:43:10,050:INFO:   <<< task_type: retrieval
2024-03-08 21:43:10,050:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:43:10,050:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:43:10,050:INFO:   <<< train_frame_order: 0
2024-03-08 21:43:10,050:INFO:   <<< use_mil: False
2024-03-08 21:43:10,050:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:43:10,050:INFO:   <<< video_dim: 1024
2024-03-08 21:43:10,050:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:43:10,050:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:43:10,050:INFO:   <<< world_size: 1
2024-03-08 21:43:10,050:INFO:   <<< wti_arch: 0
2024-03-08 21:43:10,050:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:43:11,320:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:43:11,320:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:43:11,320:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:43:11,320:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:43:11,320:WARNING: Test retrieval by loose type.
2024-03-08 21:43:11,321:WARNING: 	 embed_dim: 768
2024-03-08 21:43:11,321:WARNING: 	 image_resolution: 224
2024-03-08 21:43:11,321:WARNING: 	 vision_layers: 24
2024-03-08 21:43:11,321:WARNING: 	 vision_width: 1024
2024-03-08 21:43:11,321:WARNING: 	 vision_patch_size: 14
2024-03-08 21:43:11,321:WARNING: 	 context_length: 77
2024-03-08 21:43:11,321:WARNING: 	 vocab_size: 49408
2024-03-08 21:43:11,321:WARNING: 	 transformer_width: 768
2024-03-08 21:43:11,321:WARNING: 	 transformer_heads: 12
2024-03-08 21:43:11,321:WARNING: 	 transformer_layers: 12
2024-03-08 21:43:11,321:WARNING: 		 linear_patch: 2d
2024-03-08 21:43:11,321:WARNING: 	 cut_top_layer: 0
2024-03-08 21:43:33,649:INFO: Effective parameters:
2024-03-08 21:43:33,650:INFO:   <<< batch_size: 64
2024-03-08 21:43:33,650:INFO:   <<< batch_size_val: 16
2024-03-08 21:43:33,650:INFO:   <<< cache_dir: 
2024-03-08 21:43:33,650:INFO:   <<< cdcr: 0
2024-03-08 21:43:33,650:INFO:   <<< clip_evl: True
2024-03-08 21:43:33,650:INFO:   <<< coef_lr: 0.002
2024-03-08 21:43:33,650:INFO:   <<< cross_model: cross-base
2024-03-08 21:43:33,650:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:43:33,650:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:43:33,650:INFO:   <<< datatype: activity
2024-03-08 21:43:33,650:INFO:   <<< do_eval: False
2024-03-08 21:43:33,650:INFO:   <<< do_lower_case: False
2024-03-08 21:43:33,650:INFO:   <<< do_pretrain: False
2024-03-08 21:43:33,650:INFO:   <<< do_train: True
2024-03-08 21:43:33,650:INFO:   <<< epochs: 30
2024-03-08 21:43:33,650:INFO:   <<< eval_frame_order: 0
2024-03-08 21:43:33,650:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:43:33,650:INFO:   <<< feature_framerate: 1
2024-03-08 21:43:33,650:INFO:   <<< features_path: 
2024-03-08 21:43:33,650:INFO:   <<< fp16: False
2024-03-08 21:43:33,650:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:43:33,650:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:43:33,650:INFO:   <<< gpu: 0
2024-03-08 21:43:33,650:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:43:33,650:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:43:33,650:INFO:   <<< init_model: None
2024-03-08 21:43:33,650:INFO:   <<< interaction: no
2024-03-08 21:43:33,650:INFO:   <<< linear_patch: 2d
2024-03-08 21:43:33,650:INFO:   <<< local_rank: 0
2024-03-08 21:43:33,650:INFO:   <<< loose_type: True
2024-03-08 21:43:33,650:INFO:   <<< lr: 0.001
2024-03-08 21:43:33,650:INFO:   <<< lr_decay: 0.9
2024-03-08 21:43:33,650:INFO:   <<< margin: 0.1
2024-03-08 21:43:33,650:INFO:   <<< max_frames: 64
2024-03-08 21:43:33,650:INFO:   <<< max_words: 77
2024-03-08 21:43:33,650:INFO:   <<< mergeclip: False
2024-03-08 21:43:33,650:INFO:   <<< mergeweight: 0.5
2024-03-08 21:43:33,650:INFO:   <<< n_display: 50
2024-03-08 21:43:33,650:INFO:   <<< n_gpu: 1
2024-03-08 21:43:33,650:INFO:   <<< n_pair: 1
2024-03-08 21:43:33,650:INFO:   <<< negative_weighting: 1
2024-03-08 21:43:33,650:INFO:   <<< num_thread_reader: 1
2024-03-08 21:43:33,650:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:43:33,650:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:43:33,650:INFO:   <<< pretrained_path: 
2024-03-08 21:43:33,650:INFO:   <<< rank: 0
2024-03-08 21:43:33,650:INFO:   <<< resume_model: None
2024-03-08 21:43:33,650:INFO:   <<< sampled_use_mil: False
2024-03-08 21:43:33,650:INFO:   <<< seed: 42
2024-03-08 21:43:33,650:INFO:   <<< sim_header: meanP
2024-03-08 21:43:33,650:INFO:   <<< slice_framepos: 2
2024-03-08 21:43:33,650:INFO:   <<< task_type: retrieval
2024-03-08 21:43:33,650:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:43:33,650:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:43:33,650:INFO:   <<< train_frame_order: 0
2024-03-08 21:43:33,650:INFO:   <<< use_mil: False
2024-03-08 21:43:33,650:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:43:33,650:INFO:   <<< video_dim: 1024
2024-03-08 21:43:33,650:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:43:33,650:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:43:33,650:INFO:   <<< world_size: 1
2024-03-08 21:43:33,650:INFO:   <<< wti_arch: 0
2024-03-08 21:43:33,650:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:43:34,893:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:43:34,893:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:43:34,893:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:43:34,894:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:43:34,894:WARNING: Test retrieval by loose type.
2024-03-08 21:43:34,894:WARNING: 	 embed_dim: 768
2024-03-08 21:43:34,894:WARNING: 	 image_resolution: 224
2024-03-08 21:43:34,894:WARNING: 	 vision_layers: 24
2024-03-08 21:43:34,894:WARNING: 	 vision_width: 1024
2024-03-08 21:43:34,894:WARNING: 	 vision_patch_size: 14
2024-03-08 21:43:34,894:WARNING: 	 context_length: 77
2024-03-08 21:43:34,894:WARNING: 	 vocab_size: 49408
2024-03-08 21:43:34,894:WARNING: 	 transformer_width: 768
2024-03-08 21:43:34,894:WARNING: 	 transformer_heads: 12
2024-03-08 21:43:34,894:WARNING: 	 transformer_layers: 12
2024-03-08 21:43:34,894:WARNING: 		 linear_patch: 2d
2024-03-08 21:43:34,894:WARNING: 	 cut_top_layer: 0
2024-03-08 21:44:12,397:INFO: Effective parameters:
2024-03-08 21:44:12,397:INFO:   <<< batch_size: 64
2024-03-08 21:44:12,398:INFO:   <<< batch_size_val: 16
2024-03-08 21:44:12,398:INFO:   <<< cache_dir: 
2024-03-08 21:44:12,398:INFO:   <<< cdcr: 0
2024-03-08 21:44:12,398:INFO:   <<< clip_evl: True
2024-03-08 21:44:12,398:INFO:   <<< coef_lr: 0.002
2024-03-08 21:44:12,398:INFO:   <<< cross_model: cross-base
2024-03-08 21:44:12,398:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:44:12,398:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:44:12,398:INFO:   <<< datatype: activity
2024-03-08 21:44:12,398:INFO:   <<< do_eval: False
2024-03-08 21:44:12,398:INFO:   <<< do_lower_case: False
2024-03-08 21:44:12,398:INFO:   <<< do_pretrain: False
2024-03-08 21:44:12,398:INFO:   <<< do_train: True
2024-03-08 21:44:12,398:INFO:   <<< epochs: 30
2024-03-08 21:44:12,398:INFO:   <<< eval_frame_order: 0
2024-03-08 21:44:12,398:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:44:12,398:INFO:   <<< feature_framerate: 1
2024-03-08 21:44:12,398:INFO:   <<< features_path: 
2024-03-08 21:44:12,398:INFO:   <<< fp16: False
2024-03-08 21:44:12,398:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:44:12,398:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:44:12,398:INFO:   <<< gpu: 0
2024-03-08 21:44:12,398:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:44:12,398:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:44:12,398:INFO:   <<< init_model: None
2024-03-08 21:44:12,398:INFO:   <<< interaction: no
2024-03-08 21:44:12,398:INFO:   <<< linear_patch: 2d
2024-03-08 21:44:12,398:INFO:   <<< local_rank: 0
2024-03-08 21:44:12,398:INFO:   <<< loose_type: True
2024-03-08 21:44:12,398:INFO:   <<< lr: 0.001
2024-03-08 21:44:12,398:INFO:   <<< lr_decay: 0.9
2024-03-08 21:44:12,398:INFO:   <<< margin: 0.1
2024-03-08 21:44:12,398:INFO:   <<< max_frames: 64
2024-03-08 21:44:12,398:INFO:   <<< max_words: 77
2024-03-08 21:44:12,398:INFO:   <<< mergeclip: False
2024-03-08 21:44:12,398:INFO:   <<< mergeweight: 0.5
2024-03-08 21:44:12,398:INFO:   <<< n_display: 50
2024-03-08 21:44:12,398:INFO:   <<< n_gpu: 1
2024-03-08 21:44:12,398:INFO:   <<< n_pair: 1
2024-03-08 21:44:12,398:INFO:   <<< negative_weighting: 1
2024-03-08 21:44:12,398:INFO:   <<< num_thread_reader: 1
2024-03-08 21:44:12,398:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:44:12,398:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:44:12,398:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 21:44:12,398:INFO:   <<< rank: 0
2024-03-08 21:44:12,398:INFO:   <<< resume_model: None
2024-03-08 21:44:12,398:INFO:   <<< sampled_use_mil: False
2024-03-08 21:44:12,398:INFO:   <<< seed: 42
2024-03-08 21:44:12,398:INFO:   <<< sim_header: meanP
2024-03-08 21:44:12,398:INFO:   <<< slice_framepos: 2
2024-03-08 21:44:12,398:INFO:   <<< task_type: retrieval
2024-03-08 21:44:12,398:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:44:12,398:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:44:12,398:INFO:   <<< train_frame_order: 0
2024-03-08 21:44:12,398:INFO:   <<< use_mil: False
2024-03-08 21:44:12,398:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:44:12,398:INFO:   <<< video_dim: 1024
2024-03-08 21:44:12,398:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:44:12,398:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:44:12,398:INFO:   <<< world_size: 1
2024-03-08 21:44:12,398:INFO:   <<< wti_arch: 0
2024-03-08 21:44:12,398:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:44:13,637:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:44:13,637:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:44:13,637:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:44:13,637:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:44:13,637:WARNING: Test retrieval by loose type.
2024-03-08 21:44:13,637:WARNING: 	 embed_dim: 768
2024-03-08 21:44:13,637:WARNING: 	 image_resolution: 224
2024-03-08 21:44:13,637:WARNING: 	 vision_layers: 24
2024-03-08 21:44:13,637:WARNING: 	 vision_width: 1024
2024-03-08 21:44:13,637:WARNING: 	 vision_patch_size: 14
2024-03-08 21:44:13,637:WARNING: 	 context_length: 77
2024-03-08 21:44:13,637:WARNING: 	 vocab_size: 49408
2024-03-08 21:44:13,637:WARNING: 	 transformer_width: 768
2024-03-08 21:44:13,637:WARNING: 	 transformer_heads: 12
2024-03-08 21:44:13,637:WARNING: 	 transformer_layers: 12
2024-03-08 21:44:13,637:WARNING: 		 linear_patch: 2d
2024-03-08 21:44:13,637:WARNING: 	 cut_top_layer: 0
2024-03-08 21:45:33,667:INFO: Effective parameters:
2024-03-08 21:45:33,667:INFO:   <<< batch_size: 64
2024-03-08 21:45:33,667:INFO:   <<< batch_size_val: 16
2024-03-08 21:45:33,667:INFO:   <<< cache_dir: 
2024-03-08 21:45:33,667:INFO:   <<< cdcr: 0
2024-03-08 21:45:33,667:INFO:   <<< clip_evl: True
2024-03-08 21:45:33,667:INFO:   <<< coef_lr: 0.002
2024-03-08 21:45:33,667:INFO:   <<< cross_model: cross-base
2024-03-08 21:45:33,667:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:45:33,667:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:45:33,667:INFO:   <<< datatype: activity
2024-03-08 21:45:33,667:INFO:   <<< do_eval: False
2024-03-08 21:45:33,667:INFO:   <<< do_lower_case: False
2024-03-08 21:45:33,667:INFO:   <<< do_pretrain: False
2024-03-08 21:45:33,667:INFO:   <<< do_train: True
2024-03-08 21:45:33,667:INFO:   <<< epochs: 30
2024-03-08 21:45:33,667:INFO:   <<< eval_frame_order: 0
2024-03-08 21:45:33,667:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:45:33,667:INFO:   <<< feature_framerate: 1
2024-03-08 21:45:33,667:INFO:   <<< features_path: 
2024-03-08 21:45:33,667:INFO:   <<< fp16: False
2024-03-08 21:45:33,667:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:45:33,667:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:45:33,667:INFO:   <<< gpu: 0
2024-03-08 21:45:33,667:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:45:33,667:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:45:33,667:INFO:   <<< init_model: None
2024-03-08 21:45:33,667:INFO:   <<< interaction: no
2024-03-08 21:45:33,667:INFO:   <<< linear_patch: 2d
2024-03-08 21:45:33,667:INFO:   <<< local_rank: 0
2024-03-08 21:45:33,667:INFO:   <<< loose_type: True
2024-03-08 21:45:33,667:INFO:   <<< lr: 0.001
2024-03-08 21:45:33,667:INFO:   <<< lr_decay: 0.9
2024-03-08 21:45:33,667:INFO:   <<< margin: 0.1
2024-03-08 21:45:33,667:INFO:   <<< max_frames: 64
2024-03-08 21:45:33,667:INFO:   <<< max_words: 77
2024-03-08 21:45:33,667:INFO:   <<< mergeclip: False
2024-03-08 21:45:33,667:INFO:   <<< mergeweight: 0.5
2024-03-08 21:45:33,667:INFO:   <<< n_display: 50
2024-03-08 21:45:33,667:INFO:   <<< n_gpu: 1
2024-03-08 21:45:33,667:INFO:   <<< n_pair: 1
2024-03-08 21:45:33,667:INFO:   <<< negative_weighting: 1
2024-03-08 21:45:33,667:INFO:   <<< num_thread_reader: 1
2024-03-08 21:45:33,667:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:45:33,667:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:45:33,667:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 21:45:33,667:INFO:   <<< rank: 0
2024-03-08 21:45:33,667:INFO:   <<< resume_model: None
2024-03-08 21:45:33,667:INFO:   <<< sampled_use_mil: False
2024-03-08 21:45:33,667:INFO:   <<< seed: 42
2024-03-08 21:45:33,667:INFO:   <<< sim_header: meanP
2024-03-08 21:45:33,667:INFO:   <<< slice_framepos: 2
2024-03-08 21:45:33,667:INFO:   <<< task_type: retrieval
2024-03-08 21:45:33,667:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:45:33,667:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:45:33,667:INFO:   <<< train_frame_order: 0
2024-03-08 21:45:33,667:INFO:   <<< use_mil: False
2024-03-08 21:45:33,667:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:45:33,667:INFO:   <<< video_dim: 1024
2024-03-08 21:45:33,667:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:45:33,667:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:45:33,667:INFO:   <<< world_size: 1
2024-03-08 21:45:33,667:INFO:   <<< wti_arch: 0
2024-03-08 21:45:33,667:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:45:34,905:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:45:34,906:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:45:34,906:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:45:34,906:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:45:34,906:WARNING: Test retrieval by loose type.
2024-03-08 21:45:34,906:WARNING: 	 embed_dim: 768
2024-03-08 21:45:34,906:WARNING: 	 image_resolution: 224
2024-03-08 21:45:34,906:WARNING: 	 vision_layers: 24
2024-03-08 21:45:34,906:WARNING: 	 vision_width: 1024
2024-03-08 21:45:34,906:WARNING: 	 vision_patch_size: 14
2024-03-08 21:45:34,906:WARNING: 	 context_length: 77
2024-03-08 21:45:34,906:WARNING: 	 vocab_size: 49408
2024-03-08 21:45:34,906:WARNING: 	 transformer_width: 768
2024-03-08 21:45:34,906:WARNING: 	 transformer_heads: 12
2024-03-08 21:45:34,906:WARNING: 	 transformer_layers: 12
2024-03-08 21:45:34,906:WARNING: 		 linear_patch: 2d
2024-03-08 21:45:34,906:WARNING: 	 cut_top_layer: 0
2024-03-08 21:48:22,602:INFO: Effective parameters:
2024-03-08 21:48:22,602:INFO:   <<< batch_size: 64
2024-03-08 21:48:22,602:INFO:   <<< batch_size_val: 16
2024-03-08 21:48:22,602:INFO:   <<< cache_dir: 
2024-03-08 21:48:22,602:INFO:   <<< cdcr: 0
2024-03-08 21:48:22,602:INFO:   <<< clip_evl: True
2024-03-08 21:48:22,602:INFO:   <<< coef_lr: 0.002
2024-03-08 21:48:22,602:INFO:   <<< cross_model: cross-base
2024-03-08 21:48:22,602:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:48:22,602:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:48:22,602:INFO:   <<< datatype: activity
2024-03-08 21:48:22,603:INFO:   <<< do_eval: False
2024-03-08 21:48:22,603:INFO:   <<< do_lower_case: False
2024-03-08 21:48:22,603:INFO:   <<< do_pretrain: False
2024-03-08 21:48:22,603:INFO:   <<< do_train: True
2024-03-08 21:48:22,603:INFO:   <<< epochs: 30
2024-03-08 21:48:22,603:INFO:   <<< eval_frame_order: 0
2024-03-08 21:48:22,603:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:48:22,603:INFO:   <<< feature_framerate: 1
2024-03-08 21:48:22,603:INFO:   <<< features_path: 
2024-03-08 21:48:22,603:INFO:   <<< fp16: False
2024-03-08 21:48:22,603:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:48:22,603:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:48:22,603:INFO:   <<< gpu: 0
2024-03-08 21:48:22,603:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:48:22,603:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:48:22,603:INFO:   <<< init_model: None
2024-03-08 21:48:22,603:INFO:   <<< interaction: no
2024-03-08 21:48:22,603:INFO:   <<< linear_patch: 2d
2024-03-08 21:48:22,603:INFO:   <<< local_rank: 0
2024-03-08 21:48:22,603:INFO:   <<< loose_type: True
2024-03-08 21:48:22,603:INFO:   <<< lr: 0.001
2024-03-08 21:48:22,603:INFO:   <<< lr_decay: 0.9
2024-03-08 21:48:22,603:INFO:   <<< margin: 0.1
2024-03-08 21:48:22,603:INFO:   <<< max_frames: 64
2024-03-08 21:48:22,603:INFO:   <<< max_words: 77
2024-03-08 21:48:22,603:INFO:   <<< mergeclip: False
2024-03-08 21:48:22,603:INFO:   <<< mergeweight: 0.5
2024-03-08 21:48:22,603:INFO:   <<< n_display: 50
2024-03-08 21:48:22,603:INFO:   <<< n_gpu: 1
2024-03-08 21:48:22,603:INFO:   <<< n_pair: 1
2024-03-08 21:48:22,603:INFO:   <<< negative_weighting: 1
2024-03-08 21:48:22,603:INFO:   <<< num_thread_reader: 1
2024-03-08 21:48:22,603:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:48:22,603:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:48:22,603:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 21:48:22,603:INFO:   <<< rank: 0
2024-03-08 21:48:22,603:INFO:   <<< resume_model: None
2024-03-08 21:48:22,603:INFO:   <<< sampled_use_mil: False
2024-03-08 21:48:22,603:INFO:   <<< seed: 42
2024-03-08 21:48:22,603:INFO:   <<< sim_header: meanP
2024-03-08 21:48:22,603:INFO:   <<< slice_framepos: 2
2024-03-08 21:48:22,603:INFO:   <<< task_type: retrieval
2024-03-08 21:48:22,603:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:48:22,603:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:48:22,603:INFO:   <<< train_frame_order: 0
2024-03-08 21:48:22,603:INFO:   <<< use_mil: False
2024-03-08 21:48:22,603:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:48:22,603:INFO:   <<< video_dim: 1024
2024-03-08 21:48:22,603:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:48:22,603:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:48:22,603:INFO:   <<< world_size: 1
2024-03-08 21:48:22,603:INFO:   <<< wti_arch: 0
2024-03-08 21:48:22,603:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:48:23,844:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:48:23,844:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:48:23,844:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:48:23,844:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:48:23,844:WARNING: Test retrieval by loose type.
2024-03-08 21:48:23,844:WARNING: 	 embed_dim: 768
2024-03-08 21:48:23,844:WARNING: 	 image_resolution: 224
2024-03-08 21:48:23,844:WARNING: 	 vision_layers: 24
2024-03-08 21:48:23,844:WARNING: 	 vision_width: 1024
2024-03-08 21:48:23,844:WARNING: 	 vision_patch_size: 14
2024-03-08 21:48:23,844:WARNING: 	 context_length: 77
2024-03-08 21:48:23,844:WARNING: 	 vocab_size: 49408
2024-03-08 21:48:23,844:WARNING: 	 transformer_width: 768
2024-03-08 21:48:23,845:WARNING: 	 transformer_heads: 12
2024-03-08 21:48:23,845:WARNING: 	 transformer_layers: 12
2024-03-08 21:48:23,845:WARNING: 		 linear_patch: 2d
2024-03-08 21:48:23,845:WARNING: 	 cut_top_layer: 0
2024-03-08 21:48:40,410:INFO: Effective parameters:
2024-03-08 21:48:40,411:INFO:   <<< batch_size: 64
2024-03-08 21:48:40,411:INFO:   <<< batch_size_val: 16
2024-03-08 21:48:40,411:INFO:   <<< cache_dir: 
2024-03-08 21:48:40,411:INFO:   <<< cdcr: 0
2024-03-08 21:48:40,411:INFO:   <<< clip_evl: True
2024-03-08 21:48:40,411:INFO:   <<< coef_lr: 0.002
2024-03-08 21:48:40,411:INFO:   <<< cross_model: cross-base
2024-03-08 21:48:40,411:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:48:40,411:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:48:40,411:INFO:   <<< datatype: activity
2024-03-08 21:48:40,411:INFO:   <<< do_eval: False
2024-03-08 21:48:40,411:INFO:   <<< do_lower_case: False
2024-03-08 21:48:40,411:INFO:   <<< do_pretrain: False
2024-03-08 21:48:40,411:INFO:   <<< do_train: True
2024-03-08 21:48:40,411:INFO:   <<< epochs: 30
2024-03-08 21:48:40,411:INFO:   <<< eval_frame_order: 0
2024-03-08 21:48:40,411:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:48:40,411:INFO:   <<< feature_framerate: 1
2024-03-08 21:48:40,411:INFO:   <<< features_path: 
2024-03-08 21:48:40,411:INFO:   <<< fp16: False
2024-03-08 21:48:40,411:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:48:40,411:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:48:40,411:INFO:   <<< gpu: 0
2024-03-08 21:48:40,411:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:48:40,411:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:48:40,411:INFO:   <<< init_model: None
2024-03-08 21:48:40,411:INFO:   <<< interaction: no
2024-03-08 21:48:40,411:INFO:   <<< linear_patch: 2d
2024-03-08 21:48:40,411:INFO:   <<< local_rank: 0
2024-03-08 21:48:40,411:INFO:   <<< loose_type: True
2024-03-08 21:48:40,411:INFO:   <<< lr: 0.001
2024-03-08 21:48:40,411:INFO:   <<< lr_decay: 0.9
2024-03-08 21:48:40,411:INFO:   <<< margin: 0.1
2024-03-08 21:48:40,411:INFO:   <<< max_frames: 64
2024-03-08 21:48:40,411:INFO:   <<< max_words: 77
2024-03-08 21:48:40,411:INFO:   <<< mergeclip: False
2024-03-08 21:48:40,411:INFO:   <<< mergeweight: 0.5
2024-03-08 21:48:40,411:INFO:   <<< n_display: 50
2024-03-08 21:48:40,411:INFO:   <<< n_gpu: 1
2024-03-08 21:48:40,411:INFO:   <<< n_pair: 1
2024-03-08 21:48:40,411:INFO:   <<< negative_weighting: 1
2024-03-08 21:48:40,411:INFO:   <<< num_thread_reader: 1
2024-03-08 21:48:40,411:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:48:40,411:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:48:40,411:INFO:   <<< pretrained_path: ./data/ViT-L/14
2024-03-08 21:48:40,411:INFO:   <<< rank: 0
2024-03-08 21:48:40,411:INFO:   <<< resume_model: None
2024-03-08 21:48:40,411:INFO:   <<< sampled_use_mil: False
2024-03-08 21:48:40,412:INFO:   <<< seed: 42
2024-03-08 21:48:40,412:INFO:   <<< sim_header: meanP
2024-03-08 21:48:40,412:INFO:   <<< slice_framepos: 2
2024-03-08 21:48:40,412:INFO:   <<< task_type: retrieval
2024-03-08 21:48:40,412:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:48:40,412:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:48:40,412:INFO:   <<< train_frame_order: 0
2024-03-08 21:48:40,412:INFO:   <<< use_mil: False
2024-03-08 21:48:40,412:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:48:40,412:INFO:   <<< video_dim: 1024
2024-03-08 21:48:40,412:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:48:40,412:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:48:40,412:INFO:   <<< world_size: 1
2024-03-08 21:48:40,412:INFO:   <<< wti_arch: 0
2024-03-08 21:48:40,412:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:48:41,676:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:48:41,676:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:48:41,676:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:48:41,676:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:48:41,676:WARNING: Test retrieval by loose type.
2024-03-08 21:48:41,677:WARNING: 	 embed_dim: 768
2024-03-08 21:48:41,677:WARNING: 	 image_resolution: 224
2024-03-08 21:48:41,677:WARNING: 	 vision_layers: 24
2024-03-08 21:48:41,677:WARNING: 	 vision_width: 1024
2024-03-08 21:48:41,677:WARNING: 	 vision_patch_size: 14
2024-03-08 21:48:41,677:WARNING: 	 context_length: 77
2024-03-08 21:48:41,677:WARNING: 	 vocab_size: 49408
2024-03-08 21:48:41,677:WARNING: 	 transformer_width: 768
2024-03-08 21:48:41,677:WARNING: 	 transformer_heads: 12
2024-03-08 21:48:41,677:WARNING: 	 transformer_layers: 12
2024-03-08 21:48:41,677:WARNING: 		 linear_patch: 2d
2024-03-08 21:48:41,677:WARNING: 	 cut_top_layer: 0
2024-03-08 21:48:46,308:INFO: Effective parameters:
2024-03-08 21:48:46,308:INFO:   <<< batch_size: 64
2024-03-08 21:48:46,308:INFO:   <<< batch_size_val: 16
2024-03-08 21:48:46,308:INFO:   <<< cache_dir: 
2024-03-08 21:48:46,308:INFO:   <<< cdcr: 0
2024-03-08 21:48:46,308:INFO:   <<< clip_evl: True
2024-03-08 21:48:46,308:INFO:   <<< coef_lr: 0.002
2024-03-08 21:48:46,309:INFO:   <<< cross_model: cross-base
2024-03-08 21:48:46,309:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:48:46,309:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:48:46,309:INFO:   <<< datatype: activity
2024-03-08 21:48:46,309:INFO:   <<< do_eval: False
2024-03-08 21:48:46,309:INFO:   <<< do_lower_case: False
2024-03-08 21:48:46,309:INFO:   <<< do_pretrain: False
2024-03-08 21:48:46,309:INFO:   <<< do_train: True
2024-03-08 21:48:46,309:INFO:   <<< epochs: 30
2024-03-08 21:48:46,309:INFO:   <<< eval_frame_order: 0
2024-03-08 21:48:46,309:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:48:46,309:INFO:   <<< feature_framerate: 1
2024-03-08 21:48:46,309:INFO:   <<< features_path: 
2024-03-08 21:48:46,309:INFO:   <<< fp16: False
2024-03-08 21:48:46,309:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:48:46,309:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:48:46,309:INFO:   <<< gpu: 0
2024-03-08 21:48:46,309:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:48:46,309:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:48:46,309:INFO:   <<< init_model: None
2024-03-08 21:48:46,309:INFO:   <<< interaction: no
2024-03-08 21:48:46,309:INFO:   <<< linear_patch: 2d
2024-03-08 21:48:46,309:INFO:   <<< local_rank: 0
2024-03-08 21:48:46,309:INFO:   <<< loose_type: True
2024-03-08 21:48:46,309:INFO:   <<< lr: 0.001
2024-03-08 21:48:46,309:INFO:   <<< lr_decay: 0.9
2024-03-08 21:48:46,309:INFO:   <<< margin: 0.1
2024-03-08 21:48:46,309:INFO:   <<< max_frames: 64
2024-03-08 21:48:46,309:INFO:   <<< max_words: 77
2024-03-08 21:48:46,309:INFO:   <<< mergeclip: False
2024-03-08 21:48:46,309:INFO:   <<< mergeweight: 0.5
2024-03-08 21:48:46,309:INFO:   <<< n_display: 50
2024-03-08 21:48:46,309:INFO:   <<< n_gpu: 1
2024-03-08 21:48:46,309:INFO:   <<< n_pair: 1
2024-03-08 21:48:46,309:INFO:   <<< negative_weighting: 1
2024-03-08 21:48:46,309:INFO:   <<< num_thread_reader: 1
2024-03-08 21:48:46,309:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:48:46,309:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:48:46,309:INFO:   <<< pretrained_path: ../data/ViT-L/14
2024-03-08 21:48:46,309:INFO:   <<< rank: 0
2024-03-08 21:48:46,309:INFO:   <<< resume_model: None
2024-03-08 21:48:46,309:INFO:   <<< sampled_use_mil: False
2024-03-08 21:48:46,309:INFO:   <<< seed: 42
2024-03-08 21:48:46,309:INFO:   <<< sim_header: meanP
2024-03-08 21:48:46,309:INFO:   <<< slice_framepos: 2
2024-03-08 21:48:46,309:INFO:   <<< task_type: retrieval
2024-03-08 21:48:46,309:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:48:46,309:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:48:46,309:INFO:   <<< train_frame_order: 0
2024-03-08 21:48:46,309:INFO:   <<< use_mil: False
2024-03-08 21:48:46,309:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:48:46,309:INFO:   <<< video_dim: 1024
2024-03-08 21:48:46,309:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:48:46,309:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:48:46,309:INFO:   <<< world_size: 1
2024-03-08 21:48:46,309:INFO:   <<< wti_arch: 0
2024-03-08 21:48:46,309:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:48:47,550:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:48:47,550:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:48:47,550:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:48:47,550:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:48:47,550:WARNING: Test retrieval by loose type.
2024-03-08 21:48:47,550:WARNING: 	 embed_dim: 768
2024-03-08 21:48:47,550:WARNING: 	 image_resolution: 224
2024-03-08 21:48:47,550:WARNING: 	 vision_layers: 24
2024-03-08 21:48:47,550:WARNING: 	 vision_width: 1024
2024-03-08 21:48:47,550:WARNING: 	 vision_patch_size: 14
2024-03-08 21:48:47,550:WARNING: 	 context_length: 77
2024-03-08 21:48:47,550:WARNING: 	 vocab_size: 49408
2024-03-08 21:48:47,550:WARNING: 	 transformer_width: 768
2024-03-08 21:48:47,550:WARNING: 	 transformer_heads: 12
2024-03-08 21:48:47,550:WARNING: 	 transformer_layers: 12
2024-03-08 21:48:47,550:WARNING: 		 linear_patch: 2d
2024-03-08 21:48:47,550:WARNING: 	 cut_top_layer: 0
2024-03-08 21:49:38,431:INFO: Effective parameters:
2024-03-08 21:49:38,431:INFO:   <<< batch_size: 64
2024-03-08 21:49:38,431:INFO:   <<< batch_size_val: 16
2024-03-08 21:49:38,431:INFO:   <<< cache_dir: 
2024-03-08 21:49:38,431:INFO:   <<< cdcr: 0
2024-03-08 21:49:38,431:INFO:   <<< clip_evl: True
2024-03-08 21:49:38,431:INFO:   <<< coef_lr: 0.002
2024-03-08 21:49:38,431:INFO:   <<< cross_model: cross-base
2024-03-08 21:49:38,431:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:49:38,431:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:49:38,431:INFO:   <<< datatype: activity
2024-03-08 21:49:38,431:INFO:   <<< do_eval: False
2024-03-08 21:49:38,431:INFO:   <<< do_lower_case: False
2024-03-08 21:49:38,431:INFO:   <<< do_pretrain: False
2024-03-08 21:49:38,431:INFO:   <<< do_train: True
2024-03-08 21:49:38,431:INFO:   <<< epochs: 30
2024-03-08 21:49:38,431:INFO:   <<< eval_frame_order: 0
2024-03-08 21:49:38,431:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:49:38,431:INFO:   <<< feature_framerate: 1
2024-03-08 21:49:38,431:INFO:   <<< features_path: 
2024-03-08 21:49:38,431:INFO:   <<< fp16: False
2024-03-08 21:49:38,431:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:49:38,431:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:49:38,431:INFO:   <<< gpu: 0
2024-03-08 21:49:38,431:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:49:38,431:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:49:38,431:INFO:   <<< init_model: None
2024-03-08 21:49:38,431:INFO:   <<< interaction: no
2024-03-08 21:49:38,431:INFO:   <<< linear_patch: 2d
2024-03-08 21:49:38,431:INFO:   <<< local_rank: 0
2024-03-08 21:49:38,431:INFO:   <<< loose_type: True
2024-03-08 21:49:38,431:INFO:   <<< lr: 0.001
2024-03-08 21:49:38,431:INFO:   <<< lr_decay: 0.9
2024-03-08 21:49:38,431:INFO:   <<< margin: 0.1
2024-03-08 21:49:38,431:INFO:   <<< max_frames: 64
2024-03-08 21:49:38,431:INFO:   <<< max_words: 77
2024-03-08 21:49:38,431:INFO:   <<< mergeclip: False
2024-03-08 21:49:38,431:INFO:   <<< mergeweight: 0.5
2024-03-08 21:49:38,431:INFO:   <<< n_display: 50
2024-03-08 21:49:38,431:INFO:   <<< n_gpu: 1
2024-03-08 21:49:38,431:INFO:   <<< n_pair: 1
2024-03-08 21:49:38,431:INFO:   <<< negative_weighting: 1
2024-03-08 21:49:38,431:INFO:   <<< num_thread_reader: 1
2024-03-08 21:49:38,431:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:49:38,431:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:49:38,431:INFO:   <<< pretrained_path: ../data/ViT-L/14.pt
2024-03-08 21:49:38,431:INFO:   <<< rank: 0
2024-03-08 21:49:38,431:INFO:   <<< resume_model: None
2024-03-08 21:49:38,431:INFO:   <<< sampled_use_mil: False
2024-03-08 21:49:38,431:INFO:   <<< seed: 42
2024-03-08 21:49:38,431:INFO:   <<< sim_header: meanP
2024-03-08 21:49:38,431:INFO:   <<< slice_framepos: 2
2024-03-08 21:49:38,431:INFO:   <<< task_type: retrieval
2024-03-08 21:49:38,431:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:49:38,431:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:49:38,431:INFO:   <<< train_frame_order: 0
2024-03-08 21:49:38,431:INFO:   <<< use_mil: False
2024-03-08 21:49:38,431:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:49:38,431:INFO:   <<< video_dim: 1024
2024-03-08 21:49:38,431:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:49:38,431:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:49:38,431:INFO:   <<< world_size: 1
2024-03-08 21:49:38,431:INFO:   <<< wti_arch: 0
2024-03-08 21:49:38,431:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:49:39,667:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:49:39,668:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:49:39,668:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:49:39,668:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:49:39,668:WARNING: Test retrieval by loose type.
2024-03-08 21:49:39,668:WARNING: 	 embed_dim: 768
2024-03-08 21:49:39,668:WARNING: 	 image_resolution: 224
2024-03-08 21:49:39,668:WARNING: 	 vision_layers: 24
2024-03-08 21:49:39,668:WARNING: 	 vision_width: 1024
2024-03-08 21:49:39,668:WARNING: 	 vision_patch_size: 14
2024-03-08 21:49:39,668:WARNING: 	 context_length: 77
2024-03-08 21:49:39,668:WARNING: 	 vocab_size: 49408
2024-03-08 21:49:39,668:WARNING: 	 transformer_width: 768
2024-03-08 21:49:39,668:WARNING: 	 transformer_heads: 12
2024-03-08 21:49:39,668:WARNING: 	 transformer_layers: 12
2024-03-08 21:49:39,668:WARNING: 		 linear_patch: 2d
2024-03-08 21:49:39,668:WARNING: 	 cut_top_layer: 0
2024-03-08 21:49:51,379:INFO: Effective parameters:
2024-03-08 21:49:51,379:INFO:   <<< batch_size: 64
2024-03-08 21:49:51,379:INFO:   <<< batch_size_val: 16
2024-03-08 21:49:51,379:INFO:   <<< cache_dir: 
2024-03-08 21:49:51,379:INFO:   <<< cdcr: 0
2024-03-08 21:49:51,380:INFO:   <<< clip_evl: True
2024-03-08 21:49:51,380:INFO:   <<< coef_lr: 0.002
2024-03-08 21:49:51,380:INFO:   <<< cross_model: cross-base
2024-03-08 21:49:51,380:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:49:51,380:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:49:51,380:INFO:   <<< datatype: activity
2024-03-08 21:49:51,380:INFO:   <<< do_eval: False
2024-03-08 21:49:51,380:INFO:   <<< do_lower_case: False
2024-03-08 21:49:51,380:INFO:   <<< do_pretrain: False
2024-03-08 21:49:51,380:INFO:   <<< do_train: True
2024-03-08 21:49:51,380:INFO:   <<< epochs: 30
2024-03-08 21:49:51,380:INFO:   <<< eval_frame_order: 0
2024-03-08 21:49:51,380:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:49:51,380:INFO:   <<< feature_framerate: 1
2024-03-08 21:49:51,380:INFO:   <<< features_path: 
2024-03-08 21:49:51,380:INFO:   <<< fp16: False
2024-03-08 21:49:51,380:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:49:51,380:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:49:51,380:INFO:   <<< gpu: 0
2024-03-08 21:49:51,380:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:49:51,380:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:49:51,380:INFO:   <<< init_model: None
2024-03-08 21:49:51,380:INFO:   <<< interaction: no
2024-03-08 21:49:51,380:INFO:   <<< linear_patch: 2d
2024-03-08 21:49:51,380:INFO:   <<< local_rank: 0
2024-03-08 21:49:51,380:INFO:   <<< loose_type: True
2024-03-08 21:49:51,380:INFO:   <<< lr: 0.001
2024-03-08 21:49:51,380:INFO:   <<< lr_decay: 0.9
2024-03-08 21:49:51,380:INFO:   <<< margin: 0.1
2024-03-08 21:49:51,380:INFO:   <<< max_frames: 64
2024-03-08 21:49:51,380:INFO:   <<< max_words: 77
2024-03-08 21:49:51,380:INFO:   <<< mergeclip: False
2024-03-08 21:49:51,380:INFO:   <<< mergeweight: 0.5
2024-03-08 21:49:51,380:INFO:   <<< n_display: 50
2024-03-08 21:49:51,380:INFO:   <<< n_gpu: 1
2024-03-08 21:49:51,380:INFO:   <<< n_pair: 1
2024-03-08 21:49:51,380:INFO:   <<< negative_weighting: 1
2024-03-08 21:49:51,380:INFO:   <<< num_thread_reader: 1
2024-03-08 21:49:51,380:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:49:51,380:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:49:51,380:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:49:51,380:INFO:   <<< rank: 0
2024-03-08 21:49:51,380:INFO:   <<< resume_model: None
2024-03-08 21:49:51,380:INFO:   <<< sampled_use_mil: False
2024-03-08 21:49:51,380:INFO:   <<< seed: 42
2024-03-08 21:49:51,380:INFO:   <<< sim_header: meanP
2024-03-08 21:49:51,380:INFO:   <<< slice_framepos: 2
2024-03-08 21:49:51,380:INFO:   <<< task_type: retrieval
2024-03-08 21:49:51,380:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:49:51,380:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:49:51,380:INFO:   <<< train_frame_order: 0
2024-03-08 21:49:51,380:INFO:   <<< use_mil: False
2024-03-08 21:49:51,380:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:49:51,380:INFO:   <<< video_dim: 1024
2024-03-08 21:49:51,380:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:49:51,380:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:49:51,380:INFO:   <<< world_size: 1
2024-03-08 21:49:51,380:INFO:   <<< wti_arch: 0
2024-03-08 21:49:51,380:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:49:52,622:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:49:52,622:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:49:52,622:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:49:52,622:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:49:52,622:WARNING: Test retrieval by loose type.
2024-03-08 21:49:52,622:WARNING: 	 embed_dim: 768
2024-03-08 21:49:52,623:WARNING: 	 image_resolution: 224
2024-03-08 21:49:52,623:WARNING: 	 vision_layers: 24
2024-03-08 21:49:52,623:WARNING: 	 vision_width: 1024
2024-03-08 21:49:52,623:WARNING: 	 vision_patch_size: 14
2024-03-08 21:49:52,623:WARNING: 	 context_length: 77
2024-03-08 21:49:52,623:WARNING: 	 vocab_size: 49408
2024-03-08 21:49:52,623:WARNING: 	 transformer_width: 768
2024-03-08 21:49:52,623:WARNING: 	 transformer_heads: 12
2024-03-08 21:49:52,623:WARNING: 	 transformer_layers: 12
2024-03-08 21:49:52,623:WARNING: 		 linear_patch: 2d
2024-03-08 21:49:52,623:WARNING: 	 cut_top_layer: 0
2024-03-08 21:52:58,142:INFO: Effective parameters:
2024-03-08 21:52:58,142:INFO:   <<< batch_size: 64
2024-03-08 21:52:58,142:INFO:   <<< batch_size_val: 16
2024-03-08 21:52:58,142:INFO:   <<< cache_dir: 
2024-03-08 21:52:58,142:INFO:   <<< cdcr: 0
2024-03-08 21:52:58,142:INFO:   <<< clip_evl: True
2024-03-08 21:52:58,142:INFO:   <<< coef_lr: 0.002
2024-03-08 21:52:58,142:INFO:   <<< cross_model: cross-base
2024-03-08 21:52:58,142:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:52:58,142:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:52:58,142:INFO:   <<< datatype: activity
2024-03-08 21:52:58,142:INFO:   <<< do_eval: False
2024-03-08 21:52:58,142:INFO:   <<< do_lower_case: False
2024-03-08 21:52:58,142:INFO:   <<< do_pretrain: False
2024-03-08 21:52:58,142:INFO:   <<< do_train: True
2024-03-08 21:52:58,142:INFO:   <<< epochs: 30
2024-03-08 21:52:58,142:INFO:   <<< eval_frame_order: 0
2024-03-08 21:52:58,142:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:52:58,142:INFO:   <<< feature_framerate: 1
2024-03-08 21:52:58,142:INFO:   <<< features_path: 
2024-03-08 21:52:58,142:INFO:   <<< fp16: False
2024-03-08 21:52:58,142:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:52:58,142:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:52:58,142:INFO:   <<< gpu: 0
2024-03-08 21:52:58,142:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:52:58,142:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:52:58,142:INFO:   <<< init_model: None
2024-03-08 21:52:58,142:INFO:   <<< interaction: no
2024-03-08 21:52:58,142:INFO:   <<< linear_patch: 2d
2024-03-08 21:52:58,142:INFO:   <<< local_rank: 0
2024-03-08 21:52:58,142:INFO:   <<< loose_type: True
2024-03-08 21:52:58,142:INFO:   <<< lr: 0.001
2024-03-08 21:52:58,142:INFO:   <<< lr_decay: 0.9
2024-03-08 21:52:58,142:INFO:   <<< margin: 0.1
2024-03-08 21:52:58,142:INFO:   <<< max_frames: 64
2024-03-08 21:52:58,142:INFO:   <<< max_words: 77
2024-03-08 21:52:58,142:INFO:   <<< mergeclip: False
2024-03-08 21:52:58,142:INFO:   <<< mergeweight: 0.5
2024-03-08 21:52:58,142:INFO:   <<< n_display: 50
2024-03-08 21:52:58,142:INFO:   <<< n_gpu: 1
2024-03-08 21:52:58,143:INFO:   <<< n_pair: 1
2024-03-08 21:52:58,143:INFO:   <<< negative_weighting: 1
2024-03-08 21:52:58,143:INFO:   <<< num_thread_reader: 1
2024-03-08 21:52:58,143:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:52:58,143:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:52:58,143:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:52:58,143:INFO:   <<< rank: 0
2024-03-08 21:52:58,143:INFO:   <<< resume_model: None
2024-03-08 21:52:58,143:INFO:   <<< sampled_use_mil: False
2024-03-08 21:52:58,143:INFO:   <<< seed: 42
2024-03-08 21:52:58,143:INFO:   <<< sim_header: meanP
2024-03-08 21:52:58,143:INFO:   <<< slice_framepos: 2
2024-03-08 21:52:58,143:INFO:   <<< task_type: retrieval
2024-03-08 21:52:58,143:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:52:58,143:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:52:58,143:INFO:   <<< train_frame_order: 0
2024-03-08 21:52:58,143:INFO:   <<< use_mil: False
2024-03-08 21:52:58,143:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:52:58,143:INFO:   <<< video_dim: 1024
2024-03-08 21:52:58,143:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:52:58,143:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:52:58,143:INFO:   <<< world_size: 1
2024-03-08 21:52:58,143:INFO:   <<< wti_arch: 0
2024-03-08 21:52:58,143:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:52:59,381:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:52:59,381:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:52:59,381:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:52:59,381:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:52:59,381:WARNING: Test retrieval by loose type.
2024-03-08 21:52:59,382:WARNING: 	 embed_dim: 768
2024-03-08 21:52:59,382:WARNING: 	 image_resolution: 224
2024-03-08 21:52:59,382:WARNING: 	 vision_layers: 24
2024-03-08 21:52:59,382:WARNING: 	 vision_width: 1024
2024-03-08 21:52:59,382:WARNING: 	 vision_patch_size: 14
2024-03-08 21:52:59,382:WARNING: 	 context_length: 77
2024-03-08 21:52:59,382:WARNING: 	 vocab_size: 49408
2024-03-08 21:52:59,382:WARNING: 	 transformer_width: 768
2024-03-08 21:52:59,382:WARNING: 	 transformer_heads: 12
2024-03-08 21:52:59,382:WARNING: 	 transformer_layers: 12
2024-03-08 21:52:59,382:WARNING: 		 linear_patch: 2d
2024-03-08 21:52:59,382:WARNING: 	 cut_top_layer: 0
2024-03-08 21:55:16,993:INFO: Effective parameters:
2024-03-08 21:55:16,993:INFO:   <<< batch_size: 64
2024-03-08 21:55:16,993:INFO:   <<< batch_size_val: 16
2024-03-08 21:55:16,993:INFO:   <<< cache_dir: 
2024-03-08 21:55:16,993:INFO:   <<< cdcr: 0
2024-03-08 21:55:16,993:INFO:   <<< clip_evl: True
2024-03-08 21:55:16,993:INFO:   <<< coef_lr: 0.002
2024-03-08 21:55:16,993:INFO:   <<< cross_model: cross-base
2024-03-08 21:55:16,993:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:55:16,993:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:55:16,993:INFO:   <<< datatype: activity
2024-03-08 21:55:16,993:INFO:   <<< do_eval: False
2024-03-08 21:55:16,993:INFO:   <<< do_lower_case: False
2024-03-08 21:55:16,993:INFO:   <<< do_pretrain: False
2024-03-08 21:55:16,993:INFO:   <<< do_train: True
2024-03-08 21:55:16,993:INFO:   <<< epochs: 30
2024-03-08 21:55:16,993:INFO:   <<< eval_frame_order: 0
2024-03-08 21:55:16,993:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:55:16,993:INFO:   <<< feature_framerate: 1
2024-03-08 21:55:16,993:INFO:   <<< features_path: 
2024-03-08 21:55:16,993:INFO:   <<< fp16: False
2024-03-08 21:55:16,993:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:55:16,993:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:55:16,993:INFO:   <<< gpu: 0
2024-03-08 21:55:16,993:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:55:16,993:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:55:16,993:INFO:   <<< init_model: None
2024-03-08 21:55:16,993:INFO:   <<< interaction: no
2024-03-08 21:55:16,993:INFO:   <<< linear_patch: 2d
2024-03-08 21:55:16,993:INFO:   <<< local_rank: 0
2024-03-08 21:55:16,993:INFO:   <<< loose_type: True
2024-03-08 21:55:16,993:INFO:   <<< lr: 0.001
2024-03-08 21:55:16,993:INFO:   <<< lr_decay: 0.9
2024-03-08 21:55:16,993:INFO:   <<< margin: 0.1
2024-03-08 21:55:16,993:INFO:   <<< max_frames: 64
2024-03-08 21:55:16,993:INFO:   <<< max_words: 77
2024-03-08 21:55:16,993:INFO:   <<< mergeclip: False
2024-03-08 21:55:16,993:INFO:   <<< mergeweight: 0.5
2024-03-08 21:55:16,993:INFO:   <<< n_display: 50
2024-03-08 21:55:16,993:INFO:   <<< n_gpu: 1
2024-03-08 21:55:16,993:INFO:   <<< n_pair: 1
2024-03-08 21:55:16,993:INFO:   <<< negative_weighting: 1
2024-03-08 21:55:16,994:INFO:   <<< num_thread_reader: 1
2024-03-08 21:55:16,994:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:55:16,994:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:55:16,994:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:55:16,994:INFO:   <<< rank: 0
2024-03-08 21:55:16,994:INFO:   <<< resume_model: None
2024-03-08 21:55:16,994:INFO:   <<< sampled_use_mil: False
2024-03-08 21:55:16,994:INFO:   <<< seed: 42
2024-03-08 21:55:16,994:INFO:   <<< sim_header: meanP
2024-03-08 21:55:16,994:INFO:   <<< slice_framepos: 2
2024-03-08 21:55:16,994:INFO:   <<< task_type: retrieval
2024-03-08 21:55:16,994:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:55:16,994:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:55:16,994:INFO:   <<< train_frame_order: 0
2024-03-08 21:55:16,994:INFO:   <<< use_mil: False
2024-03-08 21:55:16,994:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:55:16,994:INFO:   <<< video_dim: 1024
2024-03-08 21:55:16,994:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:55:16,994:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:55:16,994:INFO:   <<< world_size: 1
2024-03-08 21:55:16,994:INFO:   <<< wti_arch: 0
2024-03-08 21:55:16,994:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:55:18,233:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:55:18,234:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:55:18,234:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:55:18,234:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:55:18,234:WARNING: Test retrieval by loose type.
2024-03-08 21:55:18,234:WARNING: 	 embed_dim: 768
2024-03-08 21:55:18,234:WARNING: 	 image_resolution: 224
2024-03-08 21:55:18,234:WARNING: 	 vision_layers: 24
2024-03-08 21:55:18,234:WARNING: 	 vision_width: 1024
2024-03-08 21:55:18,234:WARNING: 	 vision_patch_size: 14
2024-03-08 21:55:18,234:WARNING: 	 context_length: 77
2024-03-08 21:55:18,234:WARNING: 	 vocab_size: 49408
2024-03-08 21:55:18,234:WARNING: 	 transformer_width: 768
2024-03-08 21:55:18,234:WARNING: 	 transformer_heads: 12
2024-03-08 21:55:18,234:WARNING: 	 transformer_layers: 12
2024-03-08 21:55:18,234:WARNING: 		 linear_patch: 2d
2024-03-08 21:55:18,234:WARNING: 	 cut_top_layer: 0
2024-03-08 21:55:29,779:INFO: Effective parameters:
2024-03-08 21:55:29,779:INFO:   <<< batch_size: 64
2024-03-08 21:55:29,779:INFO:   <<< batch_size_val: 16
2024-03-08 21:55:29,779:INFO:   <<< cache_dir: 
2024-03-08 21:55:29,779:INFO:   <<< cdcr: 0
2024-03-08 21:55:29,779:INFO:   <<< clip_evl: True
2024-03-08 21:55:29,779:INFO:   <<< coef_lr: 0.002
2024-03-08 21:55:29,779:INFO:   <<< cross_model: cross-base
2024-03-08 21:55:29,779:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:55:29,779:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:55:29,779:INFO:   <<< datatype: activity
2024-03-08 21:55:29,779:INFO:   <<< do_eval: False
2024-03-08 21:55:29,779:INFO:   <<< do_lower_case: False
2024-03-08 21:55:29,779:INFO:   <<< do_pretrain: False
2024-03-08 21:55:29,779:INFO:   <<< do_train: True
2024-03-08 21:55:29,779:INFO:   <<< epochs: 30
2024-03-08 21:55:29,779:INFO:   <<< eval_frame_order: 0
2024-03-08 21:55:29,779:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:55:29,779:INFO:   <<< feature_framerate: 1
2024-03-08 21:55:29,779:INFO:   <<< features_path: 
2024-03-08 21:55:29,779:INFO:   <<< fp16: False
2024-03-08 21:55:29,779:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:55:29,779:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:55:29,779:INFO:   <<< gpu: 0
2024-03-08 21:55:29,779:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:55:29,779:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:55:29,779:INFO:   <<< init_model: None
2024-03-08 21:55:29,779:INFO:   <<< interaction: no
2024-03-08 21:55:29,779:INFO:   <<< linear_patch: 2d
2024-03-08 21:55:29,779:INFO:   <<< local_rank: 0
2024-03-08 21:55:29,779:INFO:   <<< loose_type: True
2024-03-08 21:55:29,779:INFO:   <<< lr: 0.001
2024-03-08 21:55:29,779:INFO:   <<< lr_decay: 0.9
2024-03-08 21:55:29,779:INFO:   <<< margin: 0.1
2024-03-08 21:55:29,779:INFO:   <<< max_frames: 64
2024-03-08 21:55:29,779:INFO:   <<< max_words: 77
2024-03-08 21:55:29,780:INFO:   <<< mergeclip: False
2024-03-08 21:55:29,780:INFO:   <<< mergeweight: 0.5
2024-03-08 21:55:29,780:INFO:   <<< n_display: 50
2024-03-08 21:55:29,780:INFO:   <<< n_gpu: 1
2024-03-08 21:55:29,780:INFO:   <<< n_pair: 1
2024-03-08 21:55:29,780:INFO:   <<< negative_weighting: 1
2024-03-08 21:55:29,780:INFO:   <<< num_thread_reader: 1
2024-03-08 21:55:29,780:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:55:29,780:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:55:29,780:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:55:29,780:INFO:   <<< rank: 0
2024-03-08 21:55:29,780:INFO:   <<< resume_model: None
2024-03-08 21:55:29,780:INFO:   <<< sampled_use_mil: False
2024-03-08 21:55:29,780:INFO:   <<< seed: 42
2024-03-08 21:55:29,780:INFO:   <<< sim_header: meanP
2024-03-08 21:55:29,780:INFO:   <<< slice_framepos: 2
2024-03-08 21:55:29,780:INFO:   <<< task_type: retrieval
2024-03-08 21:55:29,780:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:55:29,780:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:55:29,780:INFO:   <<< train_frame_order: 0
2024-03-08 21:55:29,780:INFO:   <<< use_mil: False
2024-03-08 21:55:29,780:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:55:29,780:INFO:   <<< video_dim: 1024
2024-03-08 21:55:29,780:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:55:29,780:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:55:29,780:INFO:   <<< world_size: 1
2024-03-08 21:55:29,780:INFO:   <<< wti_arch: 0
2024-03-08 21:55:29,780:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:55:31,018:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:55:31,018:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:55:31,018:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:55:31,018:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:55:31,018:WARNING: Test retrieval by loose type.
2024-03-08 21:55:31,018:WARNING: 	 embed_dim: 768
2024-03-08 21:55:31,018:WARNING: 	 image_resolution: 224
2024-03-08 21:55:31,018:WARNING: 	 vision_layers: 24
2024-03-08 21:55:31,018:WARNING: 	 vision_width: 1024
2024-03-08 21:55:31,018:WARNING: 	 vision_patch_size: 14
2024-03-08 21:55:31,018:WARNING: 	 context_length: 77
2024-03-08 21:55:31,018:WARNING: 	 vocab_size: 49408
2024-03-08 21:55:31,018:WARNING: 	 transformer_width: 768
2024-03-08 21:55:31,018:WARNING: 	 transformer_heads: 12
2024-03-08 21:55:31,018:WARNING: 	 transformer_layers: 12
2024-03-08 21:55:31,018:WARNING: 		 linear_patch: 2d
2024-03-08 21:55:31,018:WARNING: 	 cut_top_layer: 0
2024-03-08 21:56:25,023:INFO: Effective parameters:
2024-03-08 21:56:25,023:INFO:   <<< batch_size: 64
2024-03-08 21:56:25,023:INFO:   <<< batch_size_val: 16
2024-03-08 21:56:25,023:INFO:   <<< cache_dir: 
2024-03-08 21:56:25,023:INFO:   <<< cdcr: 0
2024-03-08 21:56:25,023:INFO:   <<< clip_evl: True
2024-03-08 21:56:25,023:INFO:   <<< coef_lr: 0.002
2024-03-08 21:56:25,023:INFO:   <<< cross_model: cross-base
2024-03-08 21:56:25,023:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:56:25,023:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:56:25,023:INFO:   <<< datatype: activity
2024-03-08 21:56:25,023:INFO:   <<< do_eval: False
2024-03-08 21:56:25,023:INFO:   <<< do_lower_case: False
2024-03-08 21:56:25,023:INFO:   <<< do_pretrain: False
2024-03-08 21:56:25,023:INFO:   <<< do_train: True
2024-03-08 21:56:25,023:INFO:   <<< epochs: 30
2024-03-08 21:56:25,023:INFO:   <<< eval_frame_order: 0
2024-03-08 21:56:25,023:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:56:25,023:INFO:   <<< feature_framerate: 1
2024-03-08 21:56:25,023:INFO:   <<< features_path: 
2024-03-08 21:56:25,023:INFO:   <<< fp16: False
2024-03-08 21:56:25,023:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:56:25,023:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:56:25,023:INFO:   <<< gpu: 0
2024-03-08 21:56:25,023:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:56:25,023:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:56:25,023:INFO:   <<< init_model: None
2024-03-08 21:56:25,023:INFO:   <<< interaction: no
2024-03-08 21:56:25,023:INFO:   <<< linear_patch: 2d
2024-03-08 21:56:25,023:INFO:   <<< local_rank: 0
2024-03-08 21:56:25,023:INFO:   <<< loose_type: True
2024-03-08 21:56:25,023:INFO:   <<< lr: 0.001
2024-03-08 21:56:25,023:INFO:   <<< lr_decay: 0.9
2024-03-08 21:56:25,023:INFO:   <<< margin: 0.1
2024-03-08 21:56:25,023:INFO:   <<< max_frames: 64
2024-03-08 21:56:25,023:INFO:   <<< max_words: 77
2024-03-08 21:56:25,023:INFO:   <<< mergeclip: False
2024-03-08 21:56:25,023:INFO:   <<< mergeweight: 0.5
2024-03-08 21:56:25,023:INFO:   <<< n_display: 50
2024-03-08 21:56:25,023:INFO:   <<< n_gpu: 1
2024-03-08 21:56:25,023:INFO:   <<< n_pair: 1
2024-03-08 21:56:25,023:INFO:   <<< negative_weighting: 1
2024-03-08 21:56:25,023:INFO:   <<< num_thread_reader: 1
2024-03-08 21:56:25,023:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:56:25,023:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:56:25,023:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:56:25,023:INFO:   <<< rank: 0
2024-03-08 21:56:25,023:INFO:   <<< resume_model: None
2024-03-08 21:56:25,023:INFO:   <<< sampled_use_mil: False
2024-03-08 21:56:25,023:INFO:   <<< seed: 42
2024-03-08 21:56:25,023:INFO:   <<< sim_header: meanP
2024-03-08 21:56:25,023:INFO:   <<< slice_framepos: 2
2024-03-08 21:56:25,023:INFO:   <<< task_type: retrieval
2024-03-08 21:56:25,023:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:56:25,023:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:56:25,023:INFO:   <<< train_frame_order: 0
2024-03-08 21:56:25,023:INFO:   <<< use_mil: False
2024-03-08 21:56:25,023:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:56:25,023:INFO:   <<< video_dim: 1024
2024-03-08 21:56:25,023:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:56:25,023:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:56:25,023:INFO:   <<< world_size: 1
2024-03-08 21:56:25,023:INFO:   <<< wti_arch: 0
2024-03-08 21:56:25,024:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:56:26,261:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:56:26,261:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:56:26,261:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:56:26,261:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:56:26,261:WARNING: Test retrieval by loose type.
2024-03-08 21:56:26,261:WARNING: 	 embed_dim: 768
2024-03-08 21:56:26,261:WARNING: 	 image_resolution: 224
2024-03-08 21:56:26,261:WARNING: 	 vision_layers: 24
2024-03-08 21:56:26,261:WARNING: 	 vision_width: 1024
2024-03-08 21:56:26,261:WARNING: 	 vision_patch_size: 14
2024-03-08 21:56:26,261:WARNING: 	 context_length: 77
2024-03-08 21:56:26,262:WARNING: 	 vocab_size: 49408
2024-03-08 21:56:26,262:WARNING: 	 transformer_width: 768
2024-03-08 21:56:26,262:WARNING: 	 transformer_heads: 12
2024-03-08 21:56:26,262:WARNING: 	 transformer_layers: 12
2024-03-08 21:56:26,262:WARNING: 		 linear_patch: 2d
2024-03-08 21:56:26,262:WARNING: 	 cut_top_layer: 0
2024-03-08 21:58:18,924:INFO: Effective parameters:
2024-03-08 21:58:18,924:INFO:   <<< batch_size: 64
2024-03-08 21:58:18,924:INFO:   <<< batch_size_val: 16
2024-03-08 21:58:18,924:INFO:   <<< cache_dir: 
2024-03-08 21:58:18,924:INFO:   <<< cdcr: 0
2024-03-08 21:58:18,924:INFO:   <<< clip_evl: True
2024-03-08 21:58:18,924:INFO:   <<< coef_lr: 0.002
2024-03-08 21:58:18,924:INFO:   <<< cross_model: cross-base
2024-03-08 21:58:18,924:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:58:18,924:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:58:18,924:INFO:   <<< datatype: activity
2024-03-08 21:58:18,924:INFO:   <<< do_eval: False
2024-03-08 21:58:18,924:INFO:   <<< do_lower_case: False
2024-03-08 21:58:18,925:INFO:   <<< do_pretrain: False
2024-03-08 21:58:18,925:INFO:   <<< do_train: True
2024-03-08 21:58:18,925:INFO:   <<< epochs: 30
2024-03-08 21:58:18,925:INFO:   <<< eval_frame_order: 0
2024-03-08 21:58:18,925:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:58:18,925:INFO:   <<< feature_framerate: 1
2024-03-08 21:58:18,925:INFO:   <<< features_path: 
2024-03-08 21:58:18,925:INFO:   <<< fp16: False
2024-03-08 21:58:18,925:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:58:18,925:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:58:18,925:INFO:   <<< gpu: 0
2024-03-08 21:58:18,925:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:58:18,925:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:58:18,925:INFO:   <<< init_model: None
2024-03-08 21:58:18,925:INFO:   <<< interaction: no
2024-03-08 21:58:18,925:INFO:   <<< linear_patch: 2d
2024-03-08 21:58:18,925:INFO:   <<< local_rank: 0
2024-03-08 21:58:18,925:INFO:   <<< loose_type: True
2024-03-08 21:58:18,925:INFO:   <<< lr: 0.001
2024-03-08 21:58:18,925:INFO:   <<< lr_decay: 0.9
2024-03-08 21:58:18,925:INFO:   <<< margin: 0.1
2024-03-08 21:58:18,925:INFO:   <<< max_frames: 64
2024-03-08 21:58:18,925:INFO:   <<< max_words: 77
2024-03-08 21:58:18,925:INFO:   <<< mergeclip: False
2024-03-08 21:58:18,925:INFO:   <<< mergeweight: 0.5
2024-03-08 21:58:18,925:INFO:   <<< n_display: 50
2024-03-08 21:58:18,925:INFO:   <<< n_gpu: 1
2024-03-08 21:58:18,925:INFO:   <<< n_pair: 1
2024-03-08 21:58:18,925:INFO:   <<< negative_weighting: 1
2024-03-08 21:58:18,925:INFO:   <<< num_thread_reader: 1
2024-03-08 21:58:18,925:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:58:18,925:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:58:18,925:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:58:18,925:INFO:   <<< rank: 0
2024-03-08 21:58:18,925:INFO:   <<< resume_model: None
2024-03-08 21:58:18,925:INFO:   <<< sampled_use_mil: False
2024-03-08 21:58:18,925:INFO:   <<< seed: 42
2024-03-08 21:58:18,925:INFO:   <<< sim_header: meanP
2024-03-08 21:58:18,925:INFO:   <<< slice_framepos: 2
2024-03-08 21:58:18,925:INFO:   <<< task_type: retrieval
2024-03-08 21:58:18,925:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:58:18,925:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:58:18,925:INFO:   <<< train_frame_order: 0
2024-03-08 21:58:18,925:INFO:   <<< use_mil: False
2024-03-08 21:58:18,925:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:58:18,925:INFO:   <<< video_dim: 1024
2024-03-08 21:58:18,925:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:58:18,925:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:58:18,925:INFO:   <<< world_size: 1
2024-03-08 21:58:18,925:INFO:   <<< wti_arch: 0
2024-03-08 21:58:18,925:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:58:20,165:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:58:20,166:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:58:20,166:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:58:20,166:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:58:20,166:WARNING: Test retrieval by loose type.
2024-03-08 21:58:20,166:WARNING: 	 embed_dim: 768
2024-03-08 21:58:20,166:WARNING: 	 image_resolution: 224
2024-03-08 21:58:20,166:WARNING: 	 vision_layers: 24
2024-03-08 21:58:20,166:WARNING: 	 vision_width: 1024
2024-03-08 21:58:20,166:WARNING: 	 vision_patch_size: 14
2024-03-08 21:58:20,166:WARNING: 	 context_length: 77
2024-03-08 21:58:20,166:WARNING: 	 vocab_size: 49408
2024-03-08 21:58:20,166:WARNING: 	 transformer_width: 768
2024-03-08 21:58:20,166:WARNING: 	 transformer_heads: 12
2024-03-08 21:58:20,166:WARNING: 	 transformer_layers: 12
2024-03-08 21:58:20,166:WARNING: 		 linear_patch: 2d
2024-03-08 21:58:20,166:WARNING: 	 cut_top_layer: 0
2024-03-08 21:59:54,300:INFO: Effective parameters:
2024-03-08 21:59:54,300:INFO:   <<< batch_size: 64
2024-03-08 21:59:54,300:INFO:   <<< batch_size_val: 16
2024-03-08 21:59:54,300:INFO:   <<< cache_dir: 
2024-03-08 21:59:54,301:INFO:   <<< cdcr: 0
2024-03-08 21:59:54,301:INFO:   <<< clip_evl: True
2024-03-08 21:59:54,301:INFO:   <<< coef_lr: 0.002
2024-03-08 21:59:54,301:INFO:   <<< cross_model: cross-base
2024-03-08 21:59:54,301:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 21:59:54,301:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 21:59:54,301:INFO:   <<< datatype: activity
2024-03-08 21:59:54,301:INFO:   <<< do_eval: False
2024-03-08 21:59:54,301:INFO:   <<< do_lower_case: False
2024-03-08 21:59:54,301:INFO:   <<< do_pretrain: False
2024-03-08 21:59:54,301:INFO:   <<< do_train: True
2024-03-08 21:59:54,301:INFO:   <<< epochs: 30
2024-03-08 21:59:54,301:INFO:   <<< eval_frame_order: 0
2024-03-08 21:59:54,301:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 21:59:54,301:INFO:   <<< feature_framerate: 1
2024-03-08 21:59:54,301:INFO:   <<< features_path: 
2024-03-08 21:59:54,301:INFO:   <<< fp16: False
2024-03-08 21:59:54,301:INFO:   <<< fp16_opt_level: O1
2024-03-08 21:59:54,301:INFO:   <<< freeze_layer_num: 0
2024-03-08 21:59:54,301:INFO:   <<< gpu: 0
2024-03-08 21:59:54,301:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 21:59:54,301:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 21:59:54,301:INFO:   <<< init_model: None
2024-03-08 21:59:54,301:INFO:   <<< interaction: no
2024-03-08 21:59:54,301:INFO:   <<< linear_patch: 2d
2024-03-08 21:59:54,301:INFO:   <<< local_rank: 0
2024-03-08 21:59:54,301:INFO:   <<< loose_type: True
2024-03-08 21:59:54,301:INFO:   <<< lr: 0.001
2024-03-08 21:59:54,301:INFO:   <<< lr_decay: 0.9
2024-03-08 21:59:54,301:INFO:   <<< margin: 0.1
2024-03-08 21:59:54,301:INFO:   <<< max_frames: 64
2024-03-08 21:59:54,301:INFO:   <<< max_words: 77
2024-03-08 21:59:54,301:INFO:   <<< mergeclip: False
2024-03-08 21:59:54,301:INFO:   <<< mergeweight: 0.5
2024-03-08 21:59:54,301:INFO:   <<< n_display: 50
2024-03-08 21:59:54,301:INFO:   <<< n_gpu: 1
2024-03-08 21:59:54,301:INFO:   <<< n_pair: 1
2024-03-08 21:59:54,301:INFO:   <<< negative_weighting: 1
2024-03-08 21:59:54,301:INFO:   <<< num_thread_reader: 1
2024-03-08 21:59:54,301:INFO:   <<< output_dir: vidintern_output
2024-03-08 21:59:54,301:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 21:59:54,301:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 21:59:54,301:INFO:   <<< rank: 0
2024-03-08 21:59:54,301:INFO:   <<< resume_model: None
2024-03-08 21:59:54,301:INFO:   <<< sampled_use_mil: False
2024-03-08 21:59:54,301:INFO:   <<< seed: 42
2024-03-08 21:59:54,301:INFO:   <<< sim_header: meanP
2024-03-08 21:59:54,301:INFO:   <<< slice_framepos: 2
2024-03-08 21:59:54,301:INFO:   <<< task_type: retrieval
2024-03-08 21:59:54,301:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 21:59:54,301:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 21:59:54,301:INFO:   <<< train_frame_order: 0
2024-03-08 21:59:54,301:INFO:   <<< use_mil: False
2024-03-08 21:59:54,301:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 21:59:54,301:INFO:   <<< video_dim: 1024
2024-03-08 21:59:54,301:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 21:59:54,301:INFO:   <<< warmup_proportion: 0.1
2024-03-08 21:59:54,301:INFO:   <<< world_size: 1
2024-03-08 21:59:54,301:INFO:   <<< wti_arch: 0
2024-03-08 21:59:54,301:INFO: device: cuda:0 n_gpu: 1
2024-03-08 21:59:55,541:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 21:59:55,542:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 21:59:55,542:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 21:59:55,542:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 21:59:55,542:WARNING: Test retrieval by loose type.
2024-03-08 21:59:55,542:WARNING: 	 embed_dim: 768
2024-03-08 21:59:55,542:WARNING: 	 image_resolution: 224
2024-03-08 21:59:55,542:WARNING: 	 vision_layers: 24
2024-03-08 21:59:55,542:WARNING: 	 vision_width: 1024
2024-03-08 21:59:55,542:WARNING: 	 vision_patch_size: 14
2024-03-08 21:59:55,542:WARNING: 	 context_length: 77
2024-03-08 21:59:55,542:WARNING: 	 vocab_size: 49408
2024-03-08 21:59:55,542:WARNING: 	 transformer_width: 768
2024-03-08 21:59:55,542:WARNING: 	 transformer_heads: 12
2024-03-08 21:59:55,542:WARNING: 	 transformer_layers: 12
2024-03-08 21:59:55,542:WARNING: 		 linear_patch: 2d
2024-03-08 21:59:55,542:WARNING: 	 cut_top_layer: 0
2024-03-08 22:04:27,328:INFO: Effective parameters:
2024-03-08 22:04:27,328:INFO:   <<< batch_size: 64
2024-03-08 22:04:27,328:INFO:   <<< batch_size_val: 16
2024-03-08 22:04:27,328:INFO:   <<< cache_dir: 
2024-03-08 22:04:27,328:INFO:   <<< cdcr: 0
2024-03-08 22:04:27,328:INFO:   <<< clip_evl: True
2024-03-08 22:04:27,328:INFO:   <<< coef_lr: 0.002
2024-03-08 22:04:27,328:INFO:   <<< cross_model: cross-base
2024-03-08 22:04:27,328:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:04:27,328:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:04:27,328:INFO:   <<< datatype: activity
2024-03-08 22:04:27,328:INFO:   <<< do_eval: False
2024-03-08 22:04:27,328:INFO:   <<< do_lower_case: False
2024-03-08 22:04:27,328:INFO:   <<< do_pretrain: False
2024-03-08 22:04:27,328:INFO:   <<< do_train: True
2024-03-08 22:04:27,328:INFO:   <<< epochs: 30
2024-03-08 22:04:27,328:INFO:   <<< eval_frame_order: 0
2024-03-08 22:04:27,328:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:04:27,328:INFO:   <<< feature_framerate: 1
2024-03-08 22:04:27,328:INFO:   <<< features_path: 
2024-03-08 22:04:27,328:INFO:   <<< fp16: False
2024-03-08 22:04:27,328:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:04:27,328:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:04:27,328:INFO:   <<< gpu: 0
2024-03-08 22:04:27,328:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:04:27,328:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:04:27,328:INFO:   <<< init_model: None
2024-03-08 22:04:27,328:INFO:   <<< interaction: no
2024-03-08 22:04:27,328:INFO:   <<< linear_patch: 2d
2024-03-08 22:04:27,328:INFO:   <<< local_rank: 0
2024-03-08 22:04:27,328:INFO:   <<< loose_type: True
2024-03-08 22:04:27,328:INFO:   <<< lr: 0.001
2024-03-08 22:04:27,328:INFO:   <<< lr_decay: 0.9
2024-03-08 22:04:27,328:INFO:   <<< margin: 0.1
2024-03-08 22:04:27,328:INFO:   <<< max_frames: 64
2024-03-08 22:04:27,328:INFO:   <<< max_words: 77
2024-03-08 22:04:27,328:INFO:   <<< mergeclip: False
2024-03-08 22:04:27,328:INFO:   <<< mergeweight: 0.5
2024-03-08 22:04:27,328:INFO:   <<< n_display: 50
2024-03-08 22:04:27,328:INFO:   <<< n_gpu: 1
2024-03-08 22:04:27,328:INFO:   <<< n_pair: 1
2024-03-08 22:04:27,328:INFO:   <<< negative_weighting: 1
2024-03-08 22:04:27,328:INFO:   <<< num_thread_reader: 1
2024-03-08 22:04:27,328:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:04:27,328:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:04:27,328:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 22:04:27,328:INFO:   <<< rank: 0
2024-03-08 22:04:27,329:INFO:   <<< resume_model: None
2024-03-08 22:04:27,329:INFO:   <<< sampled_use_mil: False
2024-03-08 22:04:27,329:INFO:   <<< seed: 42
2024-03-08 22:04:27,329:INFO:   <<< sim_header: meanP
2024-03-08 22:04:27,329:INFO:   <<< slice_framepos: 2
2024-03-08 22:04:27,329:INFO:   <<< task_type: retrieval
2024-03-08 22:04:27,329:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:04:27,329:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:04:27,329:INFO:   <<< train_frame_order: 0
2024-03-08 22:04:27,329:INFO:   <<< use_mil: False
2024-03-08 22:04:27,329:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:04:27,329:INFO:   <<< video_dim: 1024
2024-03-08 22:04:27,329:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:04:27,329:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:04:27,329:INFO:   <<< world_size: 1
2024-03-08 22:04:27,329:INFO:   <<< wti_arch: 0
2024-03-08 22:04:27,329:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:04:28,578:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:04:28,578:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:04:28,578:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:04:28,578:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:04:28,578:WARNING: Test retrieval by loose type.
2024-03-08 22:04:28,578:WARNING: 	 embed_dim: 768
2024-03-08 22:04:28,578:WARNING: 	 image_resolution: 224
2024-03-08 22:04:28,578:WARNING: 	 vision_layers: 24
2024-03-08 22:04:28,578:WARNING: 	 vision_width: 1024
2024-03-08 22:04:28,578:WARNING: 	 vision_patch_size: 14
2024-03-08 22:04:28,578:WARNING: 	 context_length: 77
2024-03-08 22:04:28,578:WARNING: 	 vocab_size: 49408
2024-03-08 22:04:28,578:WARNING: 	 transformer_width: 768
2024-03-08 22:04:28,578:WARNING: 	 transformer_heads: 12
2024-03-08 22:04:28,578:WARNING: 	 transformer_layers: 12
2024-03-08 22:04:28,578:WARNING: 		 linear_patch: 2d
2024-03-08 22:04:28,578:WARNING: 	 cut_top_layer: 0
2024-03-08 22:07:26,211:INFO: Effective parameters:
2024-03-08 22:07:26,211:INFO:   <<< batch_size: 64
2024-03-08 22:07:26,211:INFO:   <<< batch_size_val: 16
2024-03-08 22:07:26,211:INFO:   <<< cache_dir: 
2024-03-08 22:07:26,211:INFO:   <<< cdcr: 0
2024-03-08 22:07:26,211:INFO:   <<< clip_evl: True
2024-03-08 22:07:26,211:INFO:   <<< coef_lr: 0.002
2024-03-08 22:07:26,211:INFO:   <<< cross_model: cross-base
2024-03-08 22:07:26,211:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:07:26,211:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:07:26,211:INFO:   <<< datatype: activity
2024-03-08 22:07:26,212:INFO:   <<< do_eval: False
2024-03-08 22:07:26,212:INFO:   <<< do_lower_case: False
2024-03-08 22:07:26,212:INFO:   <<< do_pretrain: False
2024-03-08 22:07:26,212:INFO:   <<< do_train: True
2024-03-08 22:07:26,212:INFO:   <<< epochs: 30
2024-03-08 22:07:26,212:INFO:   <<< eval_frame_order: 0
2024-03-08 22:07:26,212:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:07:26,212:INFO:   <<< feature_framerate: 1
2024-03-08 22:07:26,212:INFO:   <<< features_path: 
2024-03-08 22:07:26,212:INFO:   <<< fp16: False
2024-03-08 22:07:26,212:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:07:26,212:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:07:26,212:INFO:   <<< gpu: 0
2024-03-08 22:07:26,212:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:07:26,212:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:07:26,212:INFO:   <<< init_model: None
2024-03-08 22:07:26,212:INFO:   <<< interaction: no
2024-03-08 22:07:26,212:INFO:   <<< linear_patch: 2d
2024-03-08 22:07:26,212:INFO:   <<< local_rank: 0
2024-03-08 22:07:26,212:INFO:   <<< loose_type: True
2024-03-08 22:07:26,212:INFO:   <<< lr: 0.001
2024-03-08 22:07:26,212:INFO:   <<< lr_decay: 0.9
2024-03-08 22:07:26,212:INFO:   <<< margin: 0.1
2024-03-08 22:07:26,212:INFO:   <<< max_frames: 64
2024-03-08 22:07:26,212:INFO:   <<< max_words: 77
2024-03-08 22:07:26,212:INFO:   <<< mergeclip: False
2024-03-08 22:07:26,212:INFO:   <<< mergeweight: 0.5
2024-03-08 22:07:26,212:INFO:   <<< n_display: 50
2024-03-08 22:07:26,212:INFO:   <<< n_gpu: 1
2024-03-08 22:07:26,212:INFO:   <<< n_pair: 1
2024-03-08 22:07:26,212:INFO:   <<< negative_weighting: 1
2024-03-08 22:07:26,212:INFO:   <<< num_thread_reader: 1
2024-03-08 22:07:26,212:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:07:26,212:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:07:26,212:INFO:   <<< pretrained_path: ../data/ViT-L-14.pt
2024-03-08 22:07:26,212:INFO:   <<< rank: 0
2024-03-08 22:07:26,212:INFO:   <<< resume_model: None
2024-03-08 22:07:26,212:INFO:   <<< sampled_use_mil: False
2024-03-08 22:07:26,212:INFO:   <<< seed: 42
2024-03-08 22:07:26,212:INFO:   <<< sim_header: meanP
2024-03-08 22:07:26,212:INFO:   <<< slice_framepos: 2
2024-03-08 22:07:26,212:INFO:   <<< task_type: retrieval
2024-03-08 22:07:26,212:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:07:26,212:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:07:26,212:INFO:   <<< train_frame_order: 0
2024-03-08 22:07:26,212:INFO:   <<< use_mil: False
2024-03-08 22:07:26,212:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:07:26,212:INFO:   <<< video_dim: 1024
2024-03-08 22:07:26,212:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:07:26,212:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:07:26,212:INFO:   <<< world_size: 1
2024-03-08 22:07:26,212:INFO:   <<< wti_arch: 0
2024-03-08 22:07:26,212:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:07:27,454:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:07:27,454:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:07:27,454:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:07:27,454:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:07:27,454:WARNING: Test retrieval by loose type.
2024-03-08 22:07:27,454:WARNING: 	 embed_dim: 768
2024-03-08 22:07:27,454:WARNING: 	 image_resolution: 224
2024-03-08 22:07:27,454:WARNING: 	 vision_layers: 24
2024-03-08 22:07:27,454:WARNING: 	 vision_width: 1024
2024-03-08 22:07:27,454:WARNING: 	 vision_patch_size: 14
2024-03-08 22:07:27,454:WARNING: 	 context_length: 77
2024-03-08 22:07:27,454:WARNING: 	 vocab_size: 49408
2024-03-08 22:07:27,454:WARNING: 	 transformer_width: 768
2024-03-08 22:07:27,454:WARNING: 	 transformer_heads: 12
2024-03-08 22:07:27,454:WARNING: 	 transformer_layers: 12
2024-03-08 22:07:27,454:WARNING: 		 linear_patch: 2d
2024-03-08 22:07:27,454:WARNING: 	 cut_top_layer: 0
2024-03-08 22:07:28,929:INFO: Drop path rate: 0.0
2024-03-08 22:07:28,985:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,026:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,067:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,109:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,151:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,192:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,234:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,275:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,318:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,360:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,401:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,443:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,485:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,527:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,569:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,610:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,651:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,693:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,734:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,775:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,817:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,859:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,901:INFO: Drop path rate: 0.0
2024-03-08 22:07:29,943:INFO: Use checkpoint: True
2024-03-08 22:07:29,943:INFO: Checkpoint number: [24, 100]
2024-03-08 22:07:29,944:INFO: Drop path rate: 0.0
2024-03-08 22:07:30,008:INFO: Drop path rate: 0.0
2024-03-08 22:07:30,070:INFO: Drop path rate: 0.0
2024-03-08 22:07:30,131:INFO: Drop path rate: 0.0
2024-03-08 22:08:14,192:INFO: Effective parameters:
2024-03-08 22:08:14,192:INFO:   <<< batch_size: 64
2024-03-08 22:08:14,192:INFO:   <<< batch_size_val: 16
2024-03-08 22:08:14,192:INFO:   <<< cache_dir: 
2024-03-08 22:08:14,192:INFO:   <<< cdcr: 0
2024-03-08 22:08:14,192:INFO:   <<< clip_evl: True
2024-03-08 22:08:14,192:INFO:   <<< coef_lr: 0.002
2024-03-08 22:08:14,192:INFO:   <<< cross_model: cross-base
2024-03-08 22:08:14,192:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:08:14,192:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:08:14,192:INFO:   <<< datatype: activity
2024-03-08 22:08:14,192:INFO:   <<< do_eval: False
2024-03-08 22:08:14,192:INFO:   <<< do_lower_case: False
2024-03-08 22:08:14,192:INFO:   <<< do_pretrain: False
2024-03-08 22:08:14,192:INFO:   <<< do_train: True
2024-03-08 22:08:14,192:INFO:   <<< epochs: 30
2024-03-08 22:08:14,192:INFO:   <<< eval_frame_order: 0
2024-03-08 22:08:14,192:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:08:14,192:INFO:   <<< feature_framerate: 1
2024-03-08 22:08:14,192:INFO:   <<< features_path: 
2024-03-08 22:08:14,192:INFO:   <<< fp16: False
2024-03-08 22:08:14,192:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:08:14,192:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:08:14,192:INFO:   <<< gpu: 0
2024-03-08 22:08:14,192:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:08:14,192:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:08:14,192:INFO:   <<< init_model: None
2024-03-08 22:08:14,192:INFO:   <<< interaction: no
2024-03-08 22:08:14,192:INFO:   <<< linear_patch: 2d
2024-03-08 22:08:14,192:INFO:   <<< local_rank: 0
2024-03-08 22:08:14,192:INFO:   <<< loose_type: True
2024-03-08 22:08:14,192:INFO:   <<< lr: 0.001
2024-03-08 22:08:14,192:INFO:   <<< lr_decay: 0.9
2024-03-08 22:08:14,192:INFO:   <<< margin: 0.1
2024-03-08 22:08:14,192:INFO:   <<< max_frames: 64
2024-03-08 22:08:14,192:INFO:   <<< max_words: 77
2024-03-08 22:08:14,192:INFO:   <<< mergeclip: False
2024-03-08 22:08:14,192:INFO:   <<< mergeweight: 0.5
2024-03-08 22:08:14,192:INFO:   <<< n_display: 50
2024-03-08 22:08:14,192:INFO:   <<< n_gpu: 1
2024-03-08 22:08:14,192:INFO:   <<< n_pair: 1
2024-03-08 22:08:14,192:INFO:   <<< negative_weighting: 1
2024-03-08 22:08:14,192:INFO:   <<< num_thread_reader: 1
2024-03-08 22:08:14,192:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:08:14,192:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:08:14,192:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:08:14,192:INFO:   <<< rank: 0
2024-03-08 22:08:14,192:INFO:   <<< resume_model: None
2024-03-08 22:08:14,192:INFO:   <<< sampled_use_mil: False
2024-03-08 22:08:14,192:INFO:   <<< seed: 42
2024-03-08 22:08:14,192:INFO:   <<< sim_header: meanP
2024-03-08 22:08:14,192:INFO:   <<< slice_framepos: 2
2024-03-08 22:08:14,192:INFO:   <<< task_type: retrieval
2024-03-08 22:08:14,192:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:08:14,192:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:08:14,192:INFO:   <<< train_frame_order: 0
2024-03-08 22:08:14,192:INFO:   <<< use_mil: False
2024-03-08 22:08:14,193:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:08:14,193:INFO:   <<< video_dim: 1024
2024-03-08 22:08:14,193:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:08:14,193:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:08:14,193:INFO:   <<< world_size: 1
2024-03-08 22:08:14,193:INFO:   <<< wti_arch: 0
2024-03-08 22:08:14,193:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:08:15,429:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:08:15,429:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:08:15,429:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:08:15,429:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:08:15,429:WARNING: Test retrieval by loose type.
2024-03-08 22:08:15,429:WARNING: 	 embed_dim: 768
2024-03-08 22:08:15,429:WARNING: 	 image_resolution: 224
2024-03-08 22:08:15,429:WARNING: 	 vision_layers: 24
2024-03-08 22:08:15,429:WARNING: 	 vision_width: 1024
2024-03-08 22:08:15,429:WARNING: 	 vision_patch_size: 14
2024-03-08 22:08:15,429:WARNING: 	 context_length: 77
2024-03-08 22:08:15,429:WARNING: 	 vocab_size: 49408
2024-03-08 22:08:15,429:WARNING: 	 transformer_width: 768
2024-03-08 22:08:15,429:WARNING: 	 transformer_heads: 12
2024-03-08 22:08:15,429:WARNING: 	 transformer_layers: 12
2024-03-08 22:08:15,429:WARNING: 		 linear_patch: 2d
2024-03-08 22:08:15,429:WARNING: 	 cut_top_layer: 0
2024-03-08 22:08:17,505:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,561:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,603:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,645:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,687:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,728:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,770:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,812:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,855:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,897:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,938:INFO: Drop path rate: 0.0
2024-03-08 22:08:17,981:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,023:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,065:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,107:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,148:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,189:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,230:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,271:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,312:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,355:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,397:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,438:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,480:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,521:INFO: Use checkpoint: True
2024-03-08 22:08:18,521:INFO: Checkpoint number: [24, 100]
2024-03-08 22:08:18,521:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,582:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,643:INFO: Drop path rate: 0.0
2024-03-08 22:08:18,704:INFO: Drop path rate: 0.0
2024-03-08 22:09:17,618:INFO: Effective parameters:
2024-03-08 22:09:17,618:INFO:   <<< batch_size: 64
2024-03-08 22:09:17,618:INFO:   <<< batch_size_val: 16
2024-03-08 22:09:17,618:INFO:   <<< cache_dir: 
2024-03-08 22:09:17,618:INFO:   <<< cdcr: 0
2024-03-08 22:09:17,618:INFO:   <<< clip_evl: True
2024-03-08 22:09:17,618:INFO:   <<< coef_lr: 0.002
2024-03-08 22:09:17,618:INFO:   <<< cross_model: cross-base
2024-03-08 22:09:17,618:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:09:17,618:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:09:17,618:INFO:   <<< datatype: activity
2024-03-08 22:09:17,618:INFO:   <<< do_eval: False
2024-03-08 22:09:17,618:INFO:   <<< do_lower_case: False
2024-03-08 22:09:17,618:INFO:   <<< do_pretrain: False
2024-03-08 22:09:17,618:INFO:   <<< do_train: True
2024-03-08 22:09:17,618:INFO:   <<< epochs: 30
2024-03-08 22:09:17,618:INFO:   <<< eval_frame_order: 0
2024-03-08 22:09:17,618:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:09:17,618:INFO:   <<< feature_framerate: 1
2024-03-08 22:09:17,619:INFO:   <<< features_path: 
2024-03-08 22:09:17,619:INFO:   <<< fp16: False
2024-03-08 22:09:17,619:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:09:17,619:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:09:17,619:INFO:   <<< gpu: 0
2024-03-08 22:09:17,619:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:09:17,619:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:09:17,619:INFO:   <<< init_model: None
2024-03-08 22:09:17,619:INFO:   <<< interaction: no
2024-03-08 22:09:17,619:INFO:   <<< linear_patch: 2d
2024-03-08 22:09:17,619:INFO:   <<< local_rank: 0
2024-03-08 22:09:17,619:INFO:   <<< loose_type: True
2024-03-08 22:09:17,619:INFO:   <<< lr: 0.001
2024-03-08 22:09:17,619:INFO:   <<< lr_decay: 0.9
2024-03-08 22:09:17,619:INFO:   <<< margin: 0.1
2024-03-08 22:09:17,619:INFO:   <<< max_frames: 64
2024-03-08 22:09:17,619:INFO:   <<< max_words: 77
2024-03-08 22:09:17,619:INFO:   <<< mergeclip: False
2024-03-08 22:09:17,619:INFO:   <<< mergeweight: 0.5
2024-03-08 22:09:17,619:INFO:   <<< n_display: 50
2024-03-08 22:09:17,619:INFO:   <<< n_gpu: 1
2024-03-08 22:09:17,619:INFO:   <<< n_pair: 1
2024-03-08 22:09:17,619:INFO:   <<< negative_weighting: 1
2024-03-08 22:09:17,619:INFO:   <<< num_thread_reader: 1
2024-03-08 22:09:17,619:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:09:17,619:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-03-08 22:09:17,619:INFO:   <<< pretrained_path: ViT-B/32
2024-03-08 22:09:17,619:INFO:   <<< rank: 0
2024-03-08 22:09:17,619:INFO:   <<< resume_model: None
2024-03-08 22:09:17,619:INFO:   <<< sampled_use_mil: False
2024-03-08 22:09:17,619:INFO:   <<< seed: 42
2024-03-08 22:09:17,619:INFO:   <<< sim_header: meanP
2024-03-08 22:09:17,619:INFO:   <<< slice_framepos: 2
2024-03-08 22:09:17,619:INFO:   <<< task_type: retrieval
2024-03-08 22:09:17,619:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:09:17,619:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:09:17,619:INFO:   <<< train_frame_order: 0
2024-03-08 22:09:17,619:INFO:   <<< use_mil: False
2024-03-08 22:09:17,619:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:09:17,619:INFO:   <<< video_dim: 1024
2024-03-08 22:09:17,619:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:09:17,619:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:09:17,619:INFO:   <<< world_size: 1
2024-03-08 22:09:17,619:INFO:   <<< wti_arch: 0
2024-03-08 22:09:17,619:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:09:18,330:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:09:18,330:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:09:18,330:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:09:18,330:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:09:18,330:WARNING: Test retrieval by loose type.
2024-03-08 22:09:18,330:WARNING: 	 embed_dim: 512
2024-03-08 22:09:18,330:WARNING: 	 image_resolution: 224
2024-03-08 22:09:18,330:WARNING: 	 vision_layers: 12
2024-03-08 22:09:18,330:WARNING: 	 vision_width: 768
2024-03-08 22:09:18,330:WARNING: 	 vision_patch_size: 32
2024-03-08 22:09:18,330:WARNING: 	 context_length: 77
2024-03-08 22:09:18,330:WARNING: 	 vocab_size: 49408
2024-03-08 22:09:18,330:WARNING: 	 transformer_width: 512
2024-03-08 22:09:18,330:WARNING: 	 transformer_heads: 8
2024-03-08 22:09:18,330:WARNING: 	 transformer_layers: 12
2024-03-08 22:09:18,330:WARNING: 		 linear_patch: 2d
2024-03-08 22:09:18,330:WARNING: 	 cut_top_layer: 0
2024-03-08 22:09:19,459:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,484:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,507:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,530:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,553:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,577:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,600:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,624:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,647:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,670:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,694:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,717:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,742:INFO: Use checkpoint: True
2024-03-08 22:09:19,743:INFO: Checkpoint number: [24, 100]
2024-03-08 22:09:19,743:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,777:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,819:INFO: Drop path rate: 0.0
2024-03-08 22:09:19,854:INFO: Drop path rate: 0.0
2024-03-08 22:09:38,516:INFO: Effective parameters:
2024-03-08 22:09:38,516:INFO:   <<< batch_size: 64
2024-03-08 22:09:38,516:INFO:   <<< batch_size_val: 16
2024-03-08 22:09:38,516:INFO:   <<< cache_dir: 
2024-03-08 22:09:38,516:INFO:   <<< cdcr: 0
2024-03-08 22:09:38,516:INFO:   <<< clip_evl: True
2024-03-08 22:09:38,516:INFO:   <<< coef_lr: 0.002
2024-03-08 22:09:38,516:INFO:   <<< cross_model: cross-base
2024-03-08 22:09:38,516:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:09:38,516:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:09:38,516:INFO:   <<< datatype: activity
2024-03-08 22:09:38,516:INFO:   <<< do_eval: False
2024-03-08 22:09:38,516:INFO:   <<< do_lower_case: False
2024-03-08 22:09:38,516:INFO:   <<< do_pretrain: False
2024-03-08 22:09:38,516:INFO:   <<< do_train: True
2024-03-08 22:09:38,516:INFO:   <<< epochs: 30
2024-03-08 22:09:38,516:INFO:   <<< eval_frame_order: 0
2024-03-08 22:09:38,516:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:09:38,516:INFO:   <<< feature_framerate: 1
2024-03-08 22:09:38,516:INFO:   <<< features_path: 
2024-03-08 22:09:38,516:INFO:   <<< fp16: False
2024-03-08 22:09:38,516:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:09:38,516:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:09:38,516:INFO:   <<< gpu: 0
2024-03-08 22:09:38,516:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:09:38,517:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:09:38,517:INFO:   <<< init_model: None
2024-03-08 22:09:38,517:INFO:   <<< interaction: no
2024-03-08 22:09:38,517:INFO:   <<< linear_patch: 2d
2024-03-08 22:09:38,517:INFO:   <<< local_rank: 0
2024-03-08 22:09:38,517:INFO:   <<< loose_type: True
2024-03-08 22:09:38,517:INFO:   <<< lr: 0.001
2024-03-08 22:09:38,517:INFO:   <<< lr_decay: 0.9
2024-03-08 22:09:38,517:INFO:   <<< margin: 0.1
2024-03-08 22:09:38,517:INFO:   <<< max_frames: 64
2024-03-08 22:09:38,517:INFO:   <<< max_words: 77
2024-03-08 22:09:38,517:INFO:   <<< mergeclip: False
2024-03-08 22:09:38,517:INFO:   <<< mergeweight: 0.5
2024-03-08 22:09:38,517:INFO:   <<< n_display: 50
2024-03-08 22:09:38,517:INFO:   <<< n_gpu: 1
2024-03-08 22:09:38,517:INFO:   <<< n_pair: 1
2024-03-08 22:09:38,517:INFO:   <<< negative_weighting: 1
2024-03-08 22:09:38,517:INFO:   <<< num_thread_reader: 1
2024-03-08 22:09:38,517:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:09:38,517:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:09:38,517:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:09:38,517:INFO:   <<< rank: 0
2024-03-08 22:09:38,517:INFO:   <<< resume_model: None
2024-03-08 22:09:38,517:INFO:   <<< sampled_use_mil: False
2024-03-08 22:09:38,517:INFO:   <<< seed: 42
2024-03-08 22:09:38,517:INFO:   <<< sim_header: meanP
2024-03-08 22:09:38,517:INFO:   <<< slice_framepos: 2
2024-03-08 22:09:38,517:INFO:   <<< task_type: retrieval
2024-03-08 22:09:38,517:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:09:38,517:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:09:38,517:INFO:   <<< train_frame_order: 0
2024-03-08 22:09:38,517:INFO:   <<< use_mil: False
2024-03-08 22:09:38,517:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:09:38,517:INFO:   <<< video_dim: 1024
2024-03-08 22:09:38,517:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:09:38,517:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:09:38,517:INFO:   <<< world_size: 1
2024-03-08 22:09:38,517:INFO:   <<< wti_arch: 0
2024-03-08 22:09:38,517:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:09:39,753:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:09:39,753:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:09:39,753:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:09:39,753:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:09:39,754:WARNING: Test retrieval by loose type.
2024-03-08 22:09:39,754:WARNING: 	 embed_dim: 768
2024-03-08 22:09:39,754:WARNING: 	 image_resolution: 224
2024-03-08 22:09:39,754:WARNING: 	 vision_layers: 24
2024-03-08 22:09:39,754:WARNING: 	 vision_width: 1024
2024-03-08 22:09:39,754:WARNING: 	 vision_patch_size: 14
2024-03-08 22:09:39,754:WARNING: 	 context_length: 77
2024-03-08 22:09:39,754:WARNING: 	 vocab_size: 49408
2024-03-08 22:09:39,754:WARNING: 	 transformer_width: 768
2024-03-08 22:09:39,754:WARNING: 	 transformer_heads: 12
2024-03-08 22:09:39,754:WARNING: 	 transformer_layers: 12
2024-03-08 22:09:39,754:WARNING: 		 linear_patch: 2d
2024-03-08 22:09:39,754:WARNING: 	 cut_top_layer: 0
2024-03-08 22:09:41,856:INFO: Drop path rate: 0.0
2024-03-08 22:09:41,896:INFO: Drop path rate: 0.0
2024-03-08 22:09:41,937:INFO: Drop path rate: 0.0
2024-03-08 22:09:41,979:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,019:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,060:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,100:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,141:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,181:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,222:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,263:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,304:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,346:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,389:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,431:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,472:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,514:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,555:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,596:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,638:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,679:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,721:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,762:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,803:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,844:INFO: Use checkpoint: True
2024-03-08 22:09:42,844:INFO: Checkpoint number: [24, 100]
2024-03-08 22:09:42,845:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,907:INFO: Drop path rate: 0.0
2024-03-08 22:09:42,968:INFO: Drop path rate: 0.0
2024-03-08 22:09:43,029:INFO: Drop path rate: 0.0
2024-03-08 22:16:57,464:INFO: Effective parameters:
2024-03-08 22:16:57,464:INFO:   <<< batch_size: 64
2024-03-08 22:16:57,464:INFO:   <<< batch_size_val: 16
2024-03-08 22:16:57,464:INFO:   <<< cache_dir: 
2024-03-08 22:16:57,464:INFO:   <<< cdcr: 0
2024-03-08 22:16:57,464:INFO:   <<< clip_evl: True
2024-03-08 22:16:57,464:INFO:   <<< coef_lr: 0.002
2024-03-08 22:16:57,464:INFO:   <<< cross_model: cross-base
2024-03-08 22:16:57,464:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:16:57,464:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:16:57,464:INFO:   <<< datatype: activity
2024-03-08 22:16:57,464:INFO:   <<< do_eval: False
2024-03-08 22:16:57,464:INFO:   <<< do_lower_case: False
2024-03-08 22:16:57,464:INFO:   <<< do_pretrain: False
2024-03-08 22:16:57,464:INFO:   <<< do_train: True
2024-03-08 22:16:57,464:INFO:   <<< epochs: 30
2024-03-08 22:16:57,464:INFO:   <<< eval_frame_order: 0
2024-03-08 22:16:57,464:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:16:57,464:INFO:   <<< feature_framerate: 1
2024-03-08 22:16:57,464:INFO:   <<< features_path: 
2024-03-08 22:16:57,464:INFO:   <<< fp16: False
2024-03-08 22:16:57,464:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:16:57,464:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:16:57,464:INFO:   <<< gpu: 0
2024-03-08 22:16:57,464:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:16:57,464:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:16:57,464:INFO:   <<< init_model: None
2024-03-08 22:16:57,464:INFO:   <<< interaction: no
2024-03-08 22:16:57,464:INFO:   <<< linear_patch: 2d
2024-03-08 22:16:57,464:INFO:   <<< local_rank: 0
2024-03-08 22:16:57,464:INFO:   <<< loose_type: True
2024-03-08 22:16:57,464:INFO:   <<< lr: 0.001
2024-03-08 22:16:57,464:INFO:   <<< lr_decay: 0.9
2024-03-08 22:16:57,464:INFO:   <<< margin: 0.1
2024-03-08 22:16:57,464:INFO:   <<< max_frames: 64
2024-03-08 22:16:57,464:INFO:   <<< max_words: 77
2024-03-08 22:16:57,464:INFO:   <<< mergeclip: False
2024-03-08 22:16:57,464:INFO:   <<< mergeweight: 0.5
2024-03-08 22:16:57,464:INFO:   <<< n_display: 50
2024-03-08 22:16:57,464:INFO:   <<< n_gpu: 1
2024-03-08 22:16:57,464:INFO:   <<< n_pair: 1
2024-03-08 22:16:57,464:INFO:   <<< negative_weighting: 1
2024-03-08 22:16:57,464:INFO:   <<< num_thread_reader: 1
2024-03-08 22:16:57,464:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:16:57,464:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:16:57,464:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:16:57,464:INFO:   <<< rank: 0
2024-03-08 22:16:57,464:INFO:   <<< resume_model: None
2024-03-08 22:16:57,464:INFO:   <<< sampled_use_mil: False
2024-03-08 22:16:57,464:INFO:   <<< seed: 42
2024-03-08 22:16:57,464:INFO:   <<< sim_header: meanP
2024-03-08 22:16:57,464:INFO:   <<< slice_framepos: 2
2024-03-08 22:16:57,464:INFO:   <<< task_type: retrieval
2024-03-08 22:16:57,464:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:16:57,464:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:16:57,464:INFO:   <<< train_frame_order: 0
2024-03-08 22:16:57,464:INFO:   <<< use_mil: False
2024-03-08 22:16:57,464:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:16:57,464:INFO:   <<< video_dim: 1024
2024-03-08 22:16:57,464:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:16:57,464:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:16:57,464:INFO:   <<< world_size: 1
2024-03-08 22:16:57,464:INFO:   <<< wti_arch: 0
2024-03-08 22:16:57,465:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:16:58,706:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:16:58,706:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:16:58,707:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:16:58,707:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:16:58,707:WARNING: Test retrieval by loose type.
2024-03-08 22:16:58,707:WARNING: 	 embed_dim: 768
2024-03-08 22:16:58,707:WARNING: 	 image_resolution: 224
2024-03-08 22:16:58,707:WARNING: 	 vision_layers: 24
2024-03-08 22:16:58,707:WARNING: 	 vision_width: 1024
2024-03-08 22:16:58,707:WARNING: 	 vision_patch_size: 14
2024-03-08 22:16:58,707:WARNING: 	 context_length: 77
2024-03-08 22:16:58,707:WARNING: 	 vocab_size: 49408
2024-03-08 22:16:58,707:WARNING: 	 transformer_width: 768
2024-03-08 22:16:58,707:WARNING: 	 transformer_heads: 12
2024-03-08 22:16:58,707:WARNING: 	 transformer_layers: 12
2024-03-08 22:16:58,707:WARNING: 		 linear_patch: 2d
2024-03-08 22:16:58,707:WARNING: 	 cut_top_layer: 0
2024-03-08 22:17:00,783:INFO: Drop path rate: 0.0
2024-03-08 22:17:00,825:INFO: Drop path rate: 0.0
2024-03-08 22:17:00,867:INFO: Drop path rate: 0.0
2024-03-08 22:17:00,909:INFO: Drop path rate: 0.0
2024-03-08 22:17:00,950:INFO: Drop path rate: 0.0
2024-03-08 22:17:00,992:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,033:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,075:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,116:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,157:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,198:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,240:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,281:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,322:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,365:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,407:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,448:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,489:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,530:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,570:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,611:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,652:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,693:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,733:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,775:INFO: Use checkpoint: True
2024-03-08 22:17:01,775:INFO: Checkpoint number: [24, 100]
2024-03-08 22:17:01,775:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,836:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,897:INFO: Drop path rate: 0.0
2024-03-08 22:17:01,959:INFO: Drop path rate: 0.0
2024-03-08 22:17:26,157:INFO: Effective parameters:
2024-03-08 22:17:26,157:INFO:   <<< batch_size: 64
2024-03-08 22:17:26,157:INFO:   <<< batch_size_val: 16
2024-03-08 22:17:26,157:INFO:   <<< cache_dir: 
2024-03-08 22:17:26,157:INFO:   <<< cdcr: 0
2024-03-08 22:17:26,158:INFO:   <<< clip_evl: True
2024-03-08 22:17:26,158:INFO:   <<< coef_lr: 0.002
2024-03-08 22:17:26,158:INFO:   <<< cross_model: cross-base
2024-03-08 22:17:26,158:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:17:26,158:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:17:26,158:INFO:   <<< datatype: activity
2024-03-08 22:17:26,158:INFO:   <<< do_eval: False
2024-03-08 22:17:26,158:INFO:   <<< do_lower_case: False
2024-03-08 22:17:26,158:INFO:   <<< do_pretrain: False
2024-03-08 22:17:26,158:INFO:   <<< do_train: True
2024-03-08 22:17:26,158:INFO:   <<< epochs: 30
2024-03-08 22:17:26,158:INFO:   <<< eval_frame_order: 0
2024-03-08 22:17:26,158:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:17:26,158:INFO:   <<< feature_framerate: 1
2024-03-08 22:17:26,158:INFO:   <<< features_path: 
2024-03-08 22:17:26,158:INFO:   <<< fp16: False
2024-03-08 22:17:26,158:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:17:26,158:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:17:26,158:INFO:   <<< gpu: 0
2024-03-08 22:17:26,158:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:17:26,158:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:17:26,158:INFO:   <<< init_model: None
2024-03-08 22:17:26,158:INFO:   <<< interaction: no
2024-03-08 22:17:26,158:INFO:   <<< linear_patch: 2d
2024-03-08 22:17:26,158:INFO:   <<< local_rank: 0
2024-03-08 22:17:26,158:INFO:   <<< loose_type: True
2024-03-08 22:17:26,158:INFO:   <<< lr: 0.001
2024-03-08 22:17:26,158:INFO:   <<< lr_decay: 0.9
2024-03-08 22:17:26,158:INFO:   <<< margin: 0.1
2024-03-08 22:17:26,158:INFO:   <<< max_frames: 64
2024-03-08 22:17:26,158:INFO:   <<< max_words: 77
2024-03-08 22:17:26,158:INFO:   <<< mergeclip: False
2024-03-08 22:17:26,158:INFO:   <<< mergeweight: 0.5
2024-03-08 22:17:26,158:INFO:   <<< n_display: 50
2024-03-08 22:17:26,158:INFO:   <<< n_gpu: 1
2024-03-08 22:17:26,158:INFO:   <<< n_pair: 1
2024-03-08 22:17:26,158:INFO:   <<< negative_weighting: 1
2024-03-08 22:17:26,158:INFO:   <<< num_thread_reader: 1
2024-03-08 22:17:26,158:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:17:26,158:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:17:26,158:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:17:26,158:INFO:   <<< rank: 0
2024-03-08 22:17:26,158:INFO:   <<< resume_model: None
2024-03-08 22:17:26,158:INFO:   <<< sampled_use_mil: False
2024-03-08 22:17:26,158:INFO:   <<< seed: 42
2024-03-08 22:17:26,158:INFO:   <<< sim_header: meanP
2024-03-08 22:17:26,158:INFO:   <<< slice_framepos: 2
2024-03-08 22:17:26,158:INFO:   <<< task_type: retrieval
2024-03-08 22:17:26,158:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:17:26,158:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:17:26,158:INFO:   <<< train_frame_order: 0
2024-03-08 22:17:26,158:INFO:   <<< use_mil: False
2024-03-08 22:17:26,158:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:17:26,158:INFO:   <<< video_dim: 1024
2024-03-08 22:17:26,158:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:17:26,158:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:17:26,158:INFO:   <<< world_size: 1
2024-03-08 22:17:26,158:INFO:   <<< wti_arch: 0
2024-03-08 22:17:26,158:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:17:27,410:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:17:27,410:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:17:27,410:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:17:27,410:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:17:27,410:WARNING: Test retrieval by loose type.
2024-03-08 22:17:27,411:WARNING: 	 embed_dim: 768
2024-03-08 22:17:27,411:WARNING: 	 image_resolution: 224
2024-03-08 22:17:27,411:WARNING: 	 vision_layers: 24
2024-03-08 22:17:27,411:WARNING: 	 vision_width: 1024
2024-03-08 22:17:27,411:WARNING: 	 vision_patch_size: 14
2024-03-08 22:17:27,411:WARNING: 	 context_length: 77
2024-03-08 22:17:27,411:WARNING: 	 vocab_size: 49408
2024-03-08 22:17:27,411:WARNING: 	 transformer_width: 768
2024-03-08 22:17:27,411:WARNING: 	 transformer_heads: 12
2024-03-08 22:17:27,411:WARNING: 	 transformer_layers: 12
2024-03-08 22:17:27,411:WARNING: 		 linear_patch: 2d
2024-03-08 22:17:27,411:WARNING: 	 cut_top_layer: 0
2024-03-08 22:17:29,544:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,604:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,645:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,687:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,728:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,770:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,812:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,853:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,895:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,936:INFO: Drop path rate: 0.0
2024-03-08 22:17:29,978:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,021:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,063:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,105:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,146:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,187:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,228:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,270:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,310:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,351:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,394:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,437:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,478:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,519:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,561:INFO: Use checkpoint: True
2024-03-08 22:17:30,561:INFO: Checkpoint number: [24, 100]
2024-03-08 22:17:30,562:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,624:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,686:INFO: Drop path rate: 0.0
2024-03-08 22:17:30,748:INFO: Drop path rate: 0.0
2024-03-08 22:18:53,121:INFO: Effective parameters:
2024-03-08 22:18:53,121:INFO:   <<< batch_size: 64
2024-03-08 22:18:53,121:INFO:   <<< batch_size_val: 16
2024-03-08 22:18:53,121:INFO:   <<< cache_dir: 
2024-03-08 22:18:53,121:INFO:   <<< cdcr: 0
2024-03-08 22:18:53,121:INFO:   <<< clip_evl: True
2024-03-08 22:18:53,121:INFO:   <<< coef_lr: 0.002
2024-03-08 22:18:53,121:INFO:   <<< cross_model: cross-base
2024-03-08 22:18:53,121:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:18:53,121:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:18:53,121:INFO:   <<< datatype: activity
2024-03-08 22:18:53,121:INFO:   <<< do_eval: False
2024-03-08 22:18:53,121:INFO:   <<< do_lower_case: False
2024-03-08 22:18:53,121:INFO:   <<< do_pretrain: False
2024-03-08 22:18:53,121:INFO:   <<< do_train: True
2024-03-08 22:18:53,121:INFO:   <<< epochs: 30
2024-03-08 22:18:53,121:INFO:   <<< eval_frame_order: 0
2024-03-08 22:18:53,121:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:18:53,121:INFO:   <<< feature_framerate: 1
2024-03-08 22:18:53,121:INFO:   <<< features_path: 
2024-03-08 22:18:53,121:INFO:   <<< fp16: False
2024-03-08 22:18:53,121:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:18:53,121:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:18:53,121:INFO:   <<< gpu: 0
2024-03-08 22:18:53,121:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:18:53,121:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:18:53,121:INFO:   <<< init_model: None
2024-03-08 22:18:53,121:INFO:   <<< interaction: no
2024-03-08 22:18:53,121:INFO:   <<< linear_patch: 2d
2024-03-08 22:18:53,122:INFO:   <<< local_rank: 0
2024-03-08 22:18:53,122:INFO:   <<< loose_type: True
2024-03-08 22:18:53,122:INFO:   <<< lr: 0.001
2024-03-08 22:18:53,122:INFO:   <<< lr_decay: 0.9
2024-03-08 22:18:53,122:INFO:   <<< margin: 0.1
2024-03-08 22:18:53,122:INFO:   <<< max_frames: 64
2024-03-08 22:18:53,122:INFO:   <<< max_words: 77
2024-03-08 22:18:53,122:INFO:   <<< mergeclip: False
2024-03-08 22:18:53,122:INFO:   <<< mergeweight: 0.5
2024-03-08 22:18:53,122:INFO:   <<< n_display: 50
2024-03-08 22:18:53,122:INFO:   <<< n_gpu: 1
2024-03-08 22:18:53,122:INFO:   <<< n_pair: 1
2024-03-08 22:18:53,122:INFO:   <<< negative_weighting: 1
2024-03-08 22:18:53,122:INFO:   <<< num_thread_reader: 1
2024-03-08 22:18:53,122:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:18:53,122:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:18:53,122:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:18:53,122:INFO:   <<< rank: 0
2024-03-08 22:18:53,122:INFO:   <<< resume_model: None
2024-03-08 22:18:53,122:INFO:   <<< sampled_use_mil: False
2024-03-08 22:18:53,122:INFO:   <<< seed: 42
2024-03-08 22:18:53,122:INFO:   <<< sim_header: meanP
2024-03-08 22:18:53,122:INFO:   <<< slice_framepos: 2
2024-03-08 22:18:53,122:INFO:   <<< task_type: retrieval
2024-03-08 22:18:53,122:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:18:53,122:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:18:53,122:INFO:   <<< train_frame_order: 0
2024-03-08 22:18:53,122:INFO:   <<< use_mil: False
2024-03-08 22:18:53,122:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:18:53,122:INFO:   <<< video_dim: 1024
2024-03-08 22:18:53,122:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:18:53,122:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:18:53,122:INFO:   <<< world_size: 1
2024-03-08 22:18:53,122:INFO:   <<< wti_arch: 0
2024-03-08 22:18:53,122:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:18:54,361:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:18:54,361:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:18:54,361:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:18:54,361:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:18:54,361:WARNING: Test retrieval by loose type.
2024-03-08 22:18:54,362:WARNING: 	 embed_dim: 768
2024-03-08 22:18:54,362:WARNING: 	 image_resolution: 224
2024-03-08 22:18:54,362:WARNING: 	 vision_layers: 24
2024-03-08 22:18:54,362:WARNING: 	 vision_width: 1024
2024-03-08 22:18:54,362:WARNING: 	 vision_patch_size: 14
2024-03-08 22:18:54,362:WARNING: 	 context_length: 77
2024-03-08 22:18:54,362:WARNING: 	 vocab_size: 49408
2024-03-08 22:18:54,362:WARNING: 	 transformer_width: 768
2024-03-08 22:18:54,362:WARNING: 	 transformer_heads: 12
2024-03-08 22:18:54,362:WARNING: 	 transformer_layers: 12
2024-03-08 22:18:54,362:WARNING: 		 linear_patch: 2d
2024-03-08 22:18:54,362:WARNING: 	 cut_top_layer: 0
2024-03-08 22:19:09,178:INFO: Effective parameters:
2024-03-08 22:19:09,178:INFO:   <<< batch_size: 64
2024-03-08 22:19:09,178:INFO:   <<< batch_size_val: 16
2024-03-08 22:19:09,178:INFO:   <<< cache_dir: 
2024-03-08 22:19:09,178:INFO:   <<< cdcr: 0
2024-03-08 22:19:09,178:INFO:   <<< clip_evl: True
2024-03-08 22:19:09,178:INFO:   <<< coef_lr: 0.002
2024-03-08 22:19:09,178:INFO:   <<< cross_model: cross-base
2024-03-08 22:19:09,178:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:19:09,178:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:19:09,178:INFO:   <<< datatype: activity
2024-03-08 22:19:09,178:INFO:   <<< do_eval: False
2024-03-08 22:19:09,178:INFO:   <<< do_lower_case: False
2024-03-08 22:19:09,178:INFO:   <<< do_pretrain: False
2024-03-08 22:19:09,178:INFO:   <<< do_train: True
2024-03-08 22:19:09,178:INFO:   <<< epochs: 30
2024-03-08 22:19:09,178:INFO:   <<< eval_frame_order: 0
2024-03-08 22:19:09,178:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:19:09,178:INFO:   <<< feature_framerate: 1
2024-03-08 22:19:09,178:INFO:   <<< features_path: 
2024-03-08 22:19:09,178:INFO:   <<< fp16: False
2024-03-08 22:19:09,178:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:19:09,178:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:19:09,178:INFO:   <<< gpu: 0
2024-03-08 22:19:09,178:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:19:09,178:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:19:09,178:INFO:   <<< init_model: None
2024-03-08 22:19:09,178:INFO:   <<< interaction: no
2024-03-08 22:19:09,178:INFO:   <<< linear_patch: 2d
2024-03-08 22:19:09,178:INFO:   <<< local_rank: 0
2024-03-08 22:19:09,178:INFO:   <<< loose_type: True
2024-03-08 22:19:09,178:INFO:   <<< lr: 0.001
2024-03-08 22:19:09,178:INFO:   <<< lr_decay: 0.9
2024-03-08 22:19:09,178:INFO:   <<< margin: 0.1
2024-03-08 22:19:09,178:INFO:   <<< max_frames: 64
2024-03-08 22:19:09,178:INFO:   <<< max_words: 77
2024-03-08 22:19:09,178:INFO:   <<< mergeclip: False
2024-03-08 22:19:09,178:INFO:   <<< mergeweight: 0.5
2024-03-08 22:19:09,178:INFO:   <<< n_display: 50
2024-03-08 22:19:09,178:INFO:   <<< n_gpu: 1
2024-03-08 22:19:09,178:INFO:   <<< n_pair: 1
2024-03-08 22:19:09,178:INFO:   <<< negative_weighting: 1
2024-03-08 22:19:09,178:INFO:   <<< num_thread_reader: 1
2024-03-08 22:19:09,178:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:19:09,178:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:19:09,179:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:19:09,179:INFO:   <<< rank: 0
2024-03-08 22:19:09,179:INFO:   <<< resume_model: None
2024-03-08 22:19:09,179:INFO:   <<< sampled_use_mil: False
2024-03-08 22:19:09,179:INFO:   <<< seed: 42
2024-03-08 22:19:09,179:INFO:   <<< sim_header: meanP
2024-03-08 22:19:09,179:INFO:   <<< slice_framepos: 2
2024-03-08 22:19:09,179:INFO:   <<< task_type: retrieval
2024-03-08 22:19:09,179:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:19:09,179:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:19:09,179:INFO:   <<< train_frame_order: 0
2024-03-08 22:19:09,179:INFO:   <<< use_mil: False
2024-03-08 22:19:09,179:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:19:09,179:INFO:   <<< video_dim: 1024
2024-03-08 22:19:09,179:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:19:09,179:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:19:09,179:INFO:   <<< world_size: 1
2024-03-08 22:19:09,179:INFO:   <<< wti_arch: 0
2024-03-08 22:19:09,179:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:19:10,425:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:19:10,426:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:19:10,426:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:19:10,426:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:19:10,426:WARNING: Test retrieval by loose type.
2024-03-08 22:19:10,426:WARNING: 	 embed_dim: 768
2024-03-08 22:19:10,426:WARNING: 	 image_resolution: 224
2024-03-08 22:19:10,426:WARNING: 	 vision_layers: 24
2024-03-08 22:19:10,426:WARNING: 	 vision_width: 1024
2024-03-08 22:19:10,426:WARNING: 	 vision_patch_size: 14
2024-03-08 22:19:10,426:WARNING: 	 context_length: 77
2024-03-08 22:19:10,426:WARNING: 	 vocab_size: 49408
2024-03-08 22:19:10,426:WARNING: 	 transformer_width: 768
2024-03-08 22:19:10,426:WARNING: 	 transformer_heads: 12
2024-03-08 22:19:10,426:WARNING: 	 transformer_layers: 12
2024-03-08 22:19:10,426:WARNING: 		 linear_patch: 2d
2024-03-08 22:19:10,426:WARNING: 	 cut_top_layer: 0
2024-03-08 22:19:12,517:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,560:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,602:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,648:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,689:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,730:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,771:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,813:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,855:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,896:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,939:INFO: Drop path rate: 0.0
2024-03-08 22:19:12,981:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,024:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,065:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,107:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,148:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,190:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,231:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,272:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,314:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,355:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,396:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,437:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,478:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,519:INFO: Use checkpoint: True
2024-03-08 22:19:13,519:INFO: Checkpoint number: [24, 100]
2024-03-08 22:19:13,519:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,580:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,646:INFO: Drop path rate: 0.0
2024-03-08 22:19:13,710:INFO: Drop path rate: 0.0
2024-03-08 22:21:32,828:INFO: Effective parameters:
2024-03-08 22:21:32,828:INFO:   <<< batch_size: 64
2024-03-08 22:21:32,828:INFO:   <<< batch_size_val: 16
2024-03-08 22:21:32,828:INFO:   <<< cache_dir: 
2024-03-08 22:21:32,828:INFO:   <<< cdcr: 0
2024-03-08 22:21:32,828:INFO:   <<< clip_evl: True
2024-03-08 22:21:32,828:INFO:   <<< coef_lr: 0.002
2024-03-08 22:21:32,828:INFO:   <<< cross_model: cross-base
2024-03-08 22:21:32,828:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:21:32,828:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:21:32,828:INFO:   <<< datatype: activity
2024-03-08 22:21:32,828:INFO:   <<< do_eval: False
2024-03-08 22:21:32,828:INFO:   <<< do_lower_case: False
2024-03-08 22:21:32,828:INFO:   <<< do_pretrain: False
2024-03-08 22:21:32,828:INFO:   <<< do_train: True
2024-03-08 22:21:32,828:INFO:   <<< epochs: 30
2024-03-08 22:21:32,828:INFO:   <<< eval_frame_order: 0
2024-03-08 22:21:32,828:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:21:32,828:INFO:   <<< feature_framerate: 1
2024-03-08 22:21:32,828:INFO:   <<< features_path: 
2024-03-08 22:21:32,828:INFO:   <<< fp16: False
2024-03-08 22:21:32,828:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:21:32,828:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:21:32,828:INFO:   <<< gpu: 0
2024-03-08 22:21:32,828:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:21:32,829:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:21:32,829:INFO:   <<< init_model: None
2024-03-08 22:21:32,829:INFO:   <<< interaction: no
2024-03-08 22:21:32,829:INFO:   <<< linear_patch: 2d
2024-03-08 22:21:32,829:INFO:   <<< local_rank: 0
2024-03-08 22:21:32,829:INFO:   <<< loose_type: True
2024-03-08 22:21:32,829:INFO:   <<< lr: 0.001
2024-03-08 22:21:32,829:INFO:   <<< lr_decay: 0.9
2024-03-08 22:21:32,829:INFO:   <<< margin: 0.1
2024-03-08 22:21:32,829:INFO:   <<< max_frames: 64
2024-03-08 22:21:32,829:INFO:   <<< max_words: 77
2024-03-08 22:21:32,829:INFO:   <<< mergeclip: False
2024-03-08 22:21:32,829:INFO:   <<< mergeweight: 0.5
2024-03-08 22:21:32,829:INFO:   <<< n_display: 50
2024-03-08 22:21:32,829:INFO:   <<< n_gpu: 1
2024-03-08 22:21:32,829:INFO:   <<< n_pair: 1
2024-03-08 22:21:32,829:INFO:   <<< negative_weighting: 1
2024-03-08 22:21:32,829:INFO:   <<< num_thread_reader: 1
2024-03-08 22:21:32,829:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:21:32,829:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:21:32,829:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:21:32,829:INFO:   <<< rank: 0
2024-03-08 22:21:32,829:INFO:   <<< resume_model: None
2024-03-08 22:21:32,829:INFO:   <<< sampled_use_mil: False
2024-03-08 22:21:32,829:INFO:   <<< seed: 42
2024-03-08 22:21:32,829:INFO:   <<< sim_header: meanP
2024-03-08 22:21:32,829:INFO:   <<< slice_framepos: 2
2024-03-08 22:21:32,829:INFO:   <<< task_type: retrieval
2024-03-08 22:21:32,829:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:21:32,829:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:21:32,829:INFO:   <<< train_frame_order: 0
2024-03-08 22:21:32,829:INFO:   <<< use_mil: False
2024-03-08 22:21:32,829:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:21:32,829:INFO:   <<< video_dim: 1024
2024-03-08 22:21:32,829:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:21:32,829:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:21:32,829:INFO:   <<< world_size: 1
2024-03-08 22:21:32,829:INFO:   <<< wti_arch: 0
2024-03-08 22:21:32,829:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:21:34,069:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:21:34,069:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:21:34,069:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:21:34,069:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:21:34,070:WARNING: Test retrieval by loose type.
2024-03-08 22:21:34,070:WARNING: 	 embed_dim: 768
2024-03-08 22:21:34,070:WARNING: 	 image_resolution: 224
2024-03-08 22:21:34,070:WARNING: 	 vision_layers: 24
2024-03-08 22:21:34,070:WARNING: 	 vision_width: 1024
2024-03-08 22:21:34,070:WARNING: 	 vision_patch_size: 14
2024-03-08 22:21:34,070:WARNING: 	 context_length: 77
2024-03-08 22:21:34,070:WARNING: 	 vocab_size: 49408
2024-03-08 22:21:34,070:WARNING: 	 transformer_width: 768
2024-03-08 22:21:34,070:WARNING: 	 transformer_heads: 12
2024-03-08 22:21:34,070:WARNING: 	 transformer_layers: 12
2024-03-08 22:21:34,070:WARNING: 		 linear_patch: 2d
2024-03-08 22:21:34,070:WARNING: 	 cut_top_layer: 0
2024-03-08 22:21:35,840:INFO: Drop path rate: 0.0
2024-03-08 22:21:35,882:INFO: Drop path rate: 0.0
2024-03-08 22:21:35,924:INFO: Drop path rate: 0.0
2024-03-08 22:21:35,965:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,007:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,048:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,089:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,131:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,172:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,213:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,255:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,296:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,337:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,378:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,420:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,465:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,509:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,554:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,596:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,637:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,680:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,722:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,763:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,806:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,848:INFO: Use checkpoint: True
2024-03-08 22:21:36,848:INFO: Checkpoint number: [24, 100]
2024-03-08 22:21:36,849:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,914:INFO: Drop path rate: 0.0
2024-03-08 22:21:36,979:INFO: Drop path rate: 0.0
2024-03-08 22:21:37,040:INFO: Drop path rate: 0.0
2024-03-08 22:24:53,639:INFO: Effective parameters:
2024-03-08 22:24:53,639:INFO:   <<< batch_size: 64
2024-03-08 22:24:53,639:INFO:   <<< batch_size_val: 16
2024-03-08 22:24:53,639:INFO:   <<< cache_dir: 
2024-03-08 22:24:53,639:INFO:   <<< cdcr: 0
2024-03-08 22:24:53,639:INFO:   <<< clip_evl: True
2024-03-08 22:24:53,639:INFO:   <<< coef_lr: 0.002
2024-03-08 22:24:53,639:INFO:   <<< cross_model: cross-base
2024-03-08 22:24:53,640:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:24:53,640:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:24:53,640:INFO:   <<< datatype: activity
2024-03-08 22:24:53,640:INFO:   <<< do_eval: False
2024-03-08 22:24:53,640:INFO:   <<< do_lower_case: False
2024-03-08 22:24:53,640:INFO:   <<< do_pretrain: False
2024-03-08 22:24:53,640:INFO:   <<< do_train: True
2024-03-08 22:24:53,640:INFO:   <<< epochs: 30
2024-03-08 22:24:53,640:INFO:   <<< eval_frame_order: 0
2024-03-08 22:24:53,640:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:24:53,640:INFO:   <<< feature_framerate: 1
2024-03-08 22:24:53,640:INFO:   <<< features_path: 
2024-03-08 22:24:53,640:INFO:   <<< fp16: False
2024-03-08 22:24:53,640:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:24:53,640:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:24:53,640:INFO:   <<< gpu: 0
2024-03-08 22:24:53,640:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:24:53,640:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:24:53,640:INFO:   <<< init_model: None
2024-03-08 22:24:53,640:INFO:   <<< interaction: no
2024-03-08 22:24:53,640:INFO:   <<< linear_patch: 2d
2024-03-08 22:24:53,640:INFO:   <<< local_rank: 0
2024-03-08 22:24:53,640:INFO:   <<< loose_type: True
2024-03-08 22:24:53,640:INFO:   <<< lr: 0.001
2024-03-08 22:24:53,640:INFO:   <<< lr_decay: 0.9
2024-03-08 22:24:53,640:INFO:   <<< margin: 0.1
2024-03-08 22:24:53,640:INFO:   <<< max_frames: 64
2024-03-08 22:24:53,640:INFO:   <<< max_words: 77
2024-03-08 22:24:53,640:INFO:   <<< mergeclip: False
2024-03-08 22:24:53,640:INFO:   <<< mergeweight: 0.5
2024-03-08 22:24:53,640:INFO:   <<< n_display: 50
2024-03-08 22:24:53,640:INFO:   <<< n_gpu: 1
2024-03-08 22:24:53,640:INFO:   <<< n_pair: 1
2024-03-08 22:24:53,640:INFO:   <<< negative_weighting: 1
2024-03-08 22:24:53,640:INFO:   <<< num_thread_reader: 1
2024-03-08 22:24:53,640:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:24:53,640:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:24:53,640:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:24:53,640:INFO:   <<< rank: 0
2024-03-08 22:24:53,640:INFO:   <<< resume_model: None
2024-03-08 22:24:53,640:INFO:   <<< sampled_use_mil: False
2024-03-08 22:24:53,640:INFO:   <<< seed: 42
2024-03-08 22:24:53,640:INFO:   <<< sim_header: meanP
2024-03-08 22:24:53,640:INFO:   <<< slice_framepos: 2
2024-03-08 22:24:53,640:INFO:   <<< task_type: retrieval
2024-03-08 22:24:53,640:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:24:53,640:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:24:53,640:INFO:   <<< train_frame_order: 0
2024-03-08 22:24:53,640:INFO:   <<< use_mil: False
2024-03-08 22:24:53,640:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:24:53,640:INFO:   <<< video_dim: 1024
2024-03-08 22:24:53,640:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:24:53,640:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:24:53,640:INFO:   <<< world_size: 1
2024-03-08 22:24:53,640:INFO:   <<< wti_arch: 0
2024-03-08 22:24:53,640:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:24:54,935:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:24:54,935:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:24:54,935:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:24:54,935:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:24:54,935:WARNING: Test retrieval by loose type.
2024-03-08 22:24:54,935:WARNING: 	 embed_dim: 768
2024-03-08 22:24:54,935:WARNING: 	 image_resolution: 224
2024-03-08 22:24:54,935:WARNING: 	 vision_layers: 24
2024-03-08 22:24:54,935:WARNING: 	 vision_width: 1024
2024-03-08 22:24:54,935:WARNING: 	 vision_patch_size: 14
2024-03-08 22:24:54,935:WARNING: 	 context_length: 77
2024-03-08 22:24:54,935:WARNING: 	 vocab_size: 49408
2024-03-08 22:24:54,935:WARNING: 	 transformer_width: 768
2024-03-08 22:24:54,935:WARNING: 	 transformer_heads: 12
2024-03-08 22:24:54,935:WARNING: 	 transformer_layers: 12
2024-03-08 22:24:54,936:WARNING: 		 linear_patch: 2d
2024-03-08 22:24:54,936:WARNING: 	 cut_top_layer: 0
2024-03-08 22:25:58,689:INFO: Effective parameters:
2024-03-08 22:25:58,689:INFO:   <<< batch_size: 64
2024-03-08 22:25:58,689:INFO:   <<< batch_size_val: 16
2024-03-08 22:25:58,689:INFO:   <<< cache_dir: 
2024-03-08 22:25:58,689:INFO:   <<< cdcr: 0
2024-03-08 22:25:58,689:INFO:   <<< clip_evl: True
2024-03-08 22:25:58,689:INFO:   <<< coef_lr: 0.002
2024-03-08 22:25:58,689:INFO:   <<< cross_model: cross-base
2024-03-08 22:25:58,689:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:25:58,689:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:25:58,689:INFO:   <<< datatype: activity
2024-03-08 22:25:58,689:INFO:   <<< do_eval: False
2024-03-08 22:25:58,689:INFO:   <<< do_lower_case: False
2024-03-08 22:25:58,689:INFO:   <<< do_pretrain: False
2024-03-08 22:25:58,689:INFO:   <<< do_train: True
2024-03-08 22:25:58,689:INFO:   <<< epochs: 30
2024-03-08 22:25:58,689:INFO:   <<< eval_frame_order: 0
2024-03-08 22:25:58,689:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:25:58,689:INFO:   <<< feature_framerate: 1
2024-03-08 22:25:58,689:INFO:   <<< features_path: 
2024-03-08 22:25:58,690:INFO:   <<< fp16: False
2024-03-08 22:25:58,690:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:25:58,690:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:25:58,690:INFO:   <<< gpu: 0
2024-03-08 22:25:58,690:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:25:58,690:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:25:58,690:INFO:   <<< init_model: None
2024-03-08 22:25:58,690:INFO:   <<< interaction: no
2024-03-08 22:25:58,690:INFO:   <<< linear_patch: 2d
2024-03-08 22:25:58,690:INFO:   <<< local_rank: 0
2024-03-08 22:25:58,690:INFO:   <<< loose_type: True
2024-03-08 22:25:58,690:INFO:   <<< lr: 0.001
2024-03-08 22:25:58,690:INFO:   <<< lr_decay: 0.9
2024-03-08 22:25:58,690:INFO:   <<< margin: 0.1
2024-03-08 22:25:58,690:INFO:   <<< max_frames: 64
2024-03-08 22:25:58,690:INFO:   <<< max_words: 77
2024-03-08 22:25:58,690:INFO:   <<< mergeclip: False
2024-03-08 22:25:58,690:INFO:   <<< mergeweight: 0.5
2024-03-08 22:25:58,690:INFO:   <<< n_display: 50
2024-03-08 22:25:58,690:INFO:   <<< n_gpu: 1
2024-03-08 22:25:58,690:INFO:   <<< n_pair: 1
2024-03-08 22:25:58,690:INFO:   <<< negative_weighting: 1
2024-03-08 22:25:58,690:INFO:   <<< num_thread_reader: 1
2024-03-08 22:25:58,690:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:25:58,690:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:25:58,690:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:25:58,690:INFO:   <<< rank: 0
2024-03-08 22:25:58,690:INFO:   <<< resume_model: None
2024-03-08 22:25:58,690:INFO:   <<< sampled_use_mil: False
2024-03-08 22:25:58,690:INFO:   <<< seed: 42
2024-03-08 22:25:58,690:INFO:   <<< sim_header: meanP
2024-03-08 22:25:58,690:INFO:   <<< slice_framepos: 2
2024-03-08 22:25:58,690:INFO:   <<< task_type: retrieval
2024-03-08 22:25:58,690:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:25:58,690:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:25:58,690:INFO:   <<< train_frame_order: 0
2024-03-08 22:25:58,690:INFO:   <<< use_mil: False
2024-03-08 22:25:58,690:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:25:58,690:INFO:   <<< video_dim: 1024
2024-03-08 22:25:58,690:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:25:58,690:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:25:58,690:INFO:   <<< world_size: 1
2024-03-08 22:25:58,690:INFO:   <<< wti_arch: 0
2024-03-08 22:25:58,690:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:25:59,933:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:25:59,934:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:25:59,934:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:25:59,934:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:25:59,934:WARNING: Test retrieval by loose type.
2024-03-08 22:25:59,934:WARNING: 	 embed_dim: 768
2024-03-08 22:25:59,934:WARNING: 	 image_resolution: 224
2024-03-08 22:25:59,934:WARNING: 	 vision_layers: 24
2024-03-08 22:25:59,934:WARNING: 	 vision_width: 1024
2024-03-08 22:25:59,934:WARNING: 	 vision_patch_size: 14
2024-03-08 22:25:59,934:WARNING: 	 context_length: 77
2024-03-08 22:25:59,934:WARNING: 	 vocab_size: 49408
2024-03-08 22:25:59,934:WARNING: 	 transformer_width: 768
2024-03-08 22:25:59,934:WARNING: 	 transformer_heads: 12
2024-03-08 22:25:59,934:WARNING: 	 transformer_layers: 12
2024-03-08 22:25:59,934:WARNING: 		 linear_patch: 2d
2024-03-08 22:25:59,934:WARNING: 	 cut_top_layer: 0
2024-03-08 22:26:01,745:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,791:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,833:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,874:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,916:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,957:INFO: Drop path rate: 0.0
2024-03-08 22:26:01,998:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,039:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,080:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,122:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,164:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,206:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,247:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,288:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,330:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,371:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,413:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,455:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,496:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,538:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,581:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,623:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,665:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,707:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,748:INFO: Use checkpoint: True
2024-03-08 22:26:02,748:INFO: Checkpoint number: [24, 100]
2024-03-08 22:26:02,749:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,810:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,871:INFO: Drop path rate: 0.0
2024-03-08 22:26:02,933:INFO: Drop path rate: 0.0
2024-03-08 22:26:03,959:WARNING: 	 sim_header: meanP
2024-03-08 22:27:26,076:INFO: Effective parameters:
2024-03-08 22:27:26,076:INFO:   <<< batch_size: 64
2024-03-08 22:27:26,076:INFO:   <<< batch_size_val: 16
2024-03-08 22:27:26,076:INFO:   <<< cache_dir: 
2024-03-08 22:27:26,076:INFO:   <<< cdcr: 0
2024-03-08 22:27:26,076:INFO:   <<< clip_evl: True
2024-03-08 22:27:26,076:INFO:   <<< coef_lr: 0.002
2024-03-08 22:27:26,076:INFO:   <<< cross_model: cross-base
2024-03-08 22:27:26,076:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:27:26,076:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:27:26,076:INFO:   <<< datatype: activity
2024-03-08 22:27:26,076:INFO:   <<< do_eval: False
2024-03-08 22:27:26,076:INFO:   <<< do_lower_case: False
2024-03-08 22:27:26,076:INFO:   <<< do_pretrain: False
2024-03-08 22:27:26,076:INFO:   <<< do_train: True
2024-03-08 22:27:26,076:INFO:   <<< epochs: 30
2024-03-08 22:27:26,076:INFO:   <<< eval_frame_order: 0
2024-03-08 22:27:26,076:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:27:26,076:INFO:   <<< feature_framerate: 1
2024-03-08 22:27:26,076:INFO:   <<< features_path: 
2024-03-08 22:27:26,076:INFO:   <<< fp16: False
2024-03-08 22:27:26,076:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:27:26,076:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:27:26,076:INFO:   <<< gpu: 0
2024-03-08 22:27:26,076:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:27:26,076:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:27:26,076:INFO:   <<< init_model: None
2024-03-08 22:27:26,076:INFO:   <<< interaction: no
2024-03-08 22:27:26,076:INFO:   <<< linear_patch: 2d
2024-03-08 22:27:26,076:INFO:   <<< local_rank: 0
2024-03-08 22:27:26,076:INFO:   <<< loose_type: True
2024-03-08 22:27:26,076:INFO:   <<< lr: 0.001
2024-03-08 22:27:26,076:INFO:   <<< lr_decay: 0.9
2024-03-08 22:27:26,076:INFO:   <<< margin: 0.1
2024-03-08 22:27:26,076:INFO:   <<< max_frames: 64
2024-03-08 22:27:26,076:INFO:   <<< max_words: 77
2024-03-08 22:27:26,076:INFO:   <<< mergeclip: False
2024-03-08 22:27:26,076:INFO:   <<< mergeweight: 0.5
2024-03-08 22:27:26,076:INFO:   <<< n_display: 50
2024-03-08 22:27:26,076:INFO:   <<< n_gpu: 1
2024-03-08 22:27:26,076:INFO:   <<< n_pair: 1
2024-03-08 22:27:26,076:INFO:   <<< negative_weighting: 1
2024-03-08 22:27:26,076:INFO:   <<< num_thread_reader: 1
2024-03-08 22:27:26,076:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:27:26,076:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:27:26,076:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:27:26,076:INFO:   <<< rank: 0
2024-03-08 22:27:26,076:INFO:   <<< resume_model: None
2024-03-08 22:27:26,076:INFO:   <<< sampled_use_mil: False
2024-03-08 22:27:26,076:INFO:   <<< seed: 42
2024-03-08 22:27:26,076:INFO:   <<< sim_header: meanP
2024-03-08 22:27:26,076:INFO:   <<< slice_framepos: 2
2024-03-08 22:27:26,076:INFO:   <<< task_type: retrieval
2024-03-08 22:27:26,076:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:27:26,076:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:27:26,076:INFO:   <<< train_frame_order: 0
2024-03-08 22:27:26,076:INFO:   <<< use_mil: False
2024-03-08 22:27:26,076:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:27:26,076:INFO:   <<< video_dim: 1024
2024-03-08 22:27:26,076:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:27:26,076:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:27:26,076:INFO:   <<< world_size: 1
2024-03-08 22:27:26,076:INFO:   <<< wti_arch: 0
2024-03-08 22:27:26,076:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:27:27,313:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:27:27,313:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:27:27,313:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:27:27,313:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:27:27,313:WARNING: Test retrieval by loose type.
2024-03-08 22:27:27,313:WARNING: 	 embed_dim: 768
2024-03-08 22:27:27,313:WARNING: 	 image_resolution: 224
2024-03-08 22:27:27,313:WARNING: 	 vision_layers: 24
2024-03-08 22:27:27,313:WARNING: 	 vision_width: 1024
2024-03-08 22:27:27,313:WARNING: 	 vision_patch_size: 14
2024-03-08 22:27:27,313:WARNING: 	 context_length: 77
2024-03-08 22:27:27,313:WARNING: 	 vocab_size: 49408
2024-03-08 22:27:27,313:WARNING: 	 transformer_width: 768
2024-03-08 22:27:27,313:WARNING: 	 transformer_heads: 12
2024-03-08 22:27:27,313:WARNING: 	 transformer_layers: 12
2024-03-08 22:27:27,313:WARNING: 		 linear_patch: 2d
2024-03-08 22:27:27,314:WARNING: 	 cut_top_layer: 0
2024-03-08 22:27:29,079:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,121:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,161:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,202:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,243:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,284:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,325:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,366:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,407:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,449:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,490:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,532:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,573:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,614:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,655:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,697:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,738:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,779:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,821:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,862:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,905:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,947:INFO: Drop path rate: 0.0
2024-03-08 22:27:29,989:INFO: Drop path rate: 0.0
2024-03-08 22:27:30,031:INFO: Drop path rate: 0.0
2024-03-08 22:27:30,072:INFO: Use checkpoint: True
2024-03-08 22:27:30,072:INFO: Checkpoint number: [24, 100]
2024-03-08 22:27:30,073:INFO: Drop path rate: 0.0
2024-03-08 22:27:30,134:INFO: Drop path rate: 0.0
2024-03-08 22:27:30,195:INFO: Drop path rate: 0.0
2024-03-08 22:27:30,262:INFO: Drop path rate: 0.0
2024-03-08 22:27:31,307:WARNING: 	 sim_header: meanP
2024-03-08 22:28:27,929:INFO: Effective parameters:
2024-03-08 22:28:27,929:INFO:   <<< batch_size: 64
2024-03-08 22:28:27,929:INFO:   <<< batch_size_val: 16
2024-03-08 22:28:27,929:INFO:   <<< cache_dir: 
2024-03-08 22:28:27,929:INFO:   <<< cdcr: 0
2024-03-08 22:28:27,929:INFO:   <<< clip_evl: True
2024-03-08 22:28:27,929:INFO:   <<< coef_lr: 0.002
2024-03-08 22:28:27,929:INFO:   <<< cross_model: cross-base
2024-03-08 22:28:27,929:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:28:27,929:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:28:27,929:INFO:   <<< datatype: activity
2024-03-08 22:28:27,929:INFO:   <<< do_eval: False
2024-03-08 22:28:27,929:INFO:   <<< do_lower_case: False
2024-03-08 22:28:27,929:INFO:   <<< do_pretrain: False
2024-03-08 22:28:27,929:INFO:   <<< do_train: True
2024-03-08 22:28:27,929:INFO:   <<< epochs: 30
2024-03-08 22:28:27,929:INFO:   <<< eval_frame_order: 0
2024-03-08 22:28:27,929:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:28:27,929:INFO:   <<< feature_framerate: 1
2024-03-08 22:28:27,929:INFO:   <<< features_path: 
2024-03-08 22:28:27,929:INFO:   <<< fp16: False
2024-03-08 22:28:27,929:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:28:27,929:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:28:27,929:INFO:   <<< gpu: 0
2024-03-08 22:28:27,929:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:28:27,929:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:28:27,929:INFO:   <<< init_model: None
2024-03-08 22:28:27,929:INFO:   <<< interaction: no
2024-03-08 22:28:27,929:INFO:   <<< linear_patch: 2d
2024-03-08 22:28:27,929:INFO:   <<< local_rank: 0
2024-03-08 22:28:27,929:INFO:   <<< loose_type: True
2024-03-08 22:28:27,929:INFO:   <<< lr: 0.001
2024-03-08 22:28:27,929:INFO:   <<< lr_decay: 0.9
2024-03-08 22:28:27,929:INFO:   <<< margin: 0.1
2024-03-08 22:28:27,929:INFO:   <<< max_frames: 64
2024-03-08 22:28:27,929:INFO:   <<< max_words: 77
2024-03-08 22:28:27,929:INFO:   <<< mergeclip: False
2024-03-08 22:28:27,929:INFO:   <<< mergeweight: 0.5
2024-03-08 22:28:27,929:INFO:   <<< n_display: 50
2024-03-08 22:28:27,929:INFO:   <<< n_gpu: 1
2024-03-08 22:28:27,929:INFO:   <<< n_pair: 1
2024-03-08 22:28:27,929:INFO:   <<< negative_weighting: 1
2024-03-08 22:28:27,929:INFO:   <<< num_thread_reader: 1
2024-03-08 22:28:27,929:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:28:27,929:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:28:27,929:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:28:27,929:INFO:   <<< rank: 0
2024-03-08 22:28:27,929:INFO:   <<< resume_model: None
2024-03-08 22:28:27,929:INFO:   <<< sampled_use_mil: False
2024-03-08 22:28:27,929:INFO:   <<< seed: 42
2024-03-08 22:28:27,929:INFO:   <<< sim_header: meanP
2024-03-08 22:28:27,929:INFO:   <<< slice_framepos: 2
2024-03-08 22:28:27,929:INFO:   <<< task_type: retrieval
2024-03-08 22:28:27,929:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:28:27,929:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:28:27,930:INFO:   <<< train_frame_order: 0
2024-03-08 22:28:27,930:INFO:   <<< use_mil: False
2024-03-08 22:28:27,930:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:28:27,930:INFO:   <<< video_dim: 1024
2024-03-08 22:28:27,930:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:28:27,930:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:28:27,930:INFO:   <<< world_size: 1
2024-03-08 22:28:27,930:INFO:   <<< wti_arch: 0
2024-03-08 22:28:27,930:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:28:29,179:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:28:29,179:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:28:29,179:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:28:29,179:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:28:29,179:WARNING: Test retrieval by loose type.
2024-03-08 22:28:29,179:WARNING: 	 embed_dim: 768
2024-03-08 22:28:29,179:WARNING: 	 image_resolution: 224
2024-03-08 22:28:29,180:WARNING: 	 vision_layers: 24
2024-03-08 22:28:29,180:WARNING: 	 vision_width: 1024
2024-03-08 22:28:29,180:WARNING: 	 vision_patch_size: 14
2024-03-08 22:28:29,180:WARNING: 	 context_length: 77
2024-03-08 22:28:29,180:WARNING: 	 vocab_size: 49408
2024-03-08 22:28:29,180:WARNING: 	 transformer_width: 768
2024-03-08 22:28:29,180:WARNING: 	 transformer_heads: 12
2024-03-08 22:28:29,180:WARNING: 	 transformer_layers: 12
2024-03-08 22:28:29,180:WARNING: 		 linear_patch: 2d
2024-03-08 22:28:29,180:WARNING: 	 cut_top_layer: 0
2024-03-08 22:28:31,065:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,108:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,150:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,191:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,232:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,273:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,315:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,356:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,397:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,438:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,479:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,520:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,561:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,602:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,643:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,684:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,725:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,766:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,807:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,849:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,890:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,931:INFO: Drop path rate: 0.0
2024-03-08 22:28:31,972:INFO: Drop path rate: 0.0
2024-03-08 22:28:32,013:INFO: Drop path rate: 0.0
2024-03-08 22:28:32,054:INFO: Use checkpoint: True
2024-03-08 22:28:32,054:INFO: Checkpoint number: [24, 100]
2024-03-08 22:28:32,055:INFO: Drop path rate: 0.0
2024-03-08 22:28:32,116:INFO: Drop path rate: 0.0
2024-03-08 22:28:32,177:INFO: Drop path rate: 0.0
2024-03-08 22:28:32,238:INFO: Drop path rate: 0.0
2024-03-08 22:28:33,286:WARNING: 	 sim_header: meanP
2024-03-08 22:29:49,660:INFO: Effective parameters:
2024-03-08 22:29:49,661:INFO:   <<< batch_size: 64
2024-03-08 22:29:49,661:INFO:   <<< batch_size_val: 16
2024-03-08 22:29:49,661:INFO:   <<< cache_dir: 
2024-03-08 22:29:49,661:INFO:   <<< cdcr: 0
2024-03-08 22:29:49,661:INFO:   <<< clip_evl: True
2024-03-08 22:29:49,661:INFO:   <<< coef_lr: 0.002
2024-03-08 22:29:49,661:INFO:   <<< cross_model: cross-base
2024-03-08 22:29:49,661:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:29:49,661:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:29:49,661:INFO:   <<< datatype: activity
2024-03-08 22:29:49,661:INFO:   <<< do_eval: False
2024-03-08 22:29:49,661:INFO:   <<< do_lower_case: False
2024-03-08 22:29:49,661:INFO:   <<< do_pretrain: False
2024-03-08 22:29:49,661:INFO:   <<< do_train: True
2024-03-08 22:29:49,661:INFO:   <<< epochs: 30
2024-03-08 22:29:49,661:INFO:   <<< eval_frame_order: 0
2024-03-08 22:29:49,661:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:29:49,661:INFO:   <<< feature_framerate: 1
2024-03-08 22:29:49,661:INFO:   <<< features_path: 
2024-03-08 22:29:49,661:INFO:   <<< fp16: False
2024-03-08 22:29:49,661:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:29:49,661:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:29:49,661:INFO:   <<< gpu: 0
2024-03-08 22:29:49,661:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:29:49,661:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:29:49,661:INFO:   <<< init_model: None
2024-03-08 22:29:49,661:INFO:   <<< interaction: no
2024-03-08 22:29:49,661:INFO:   <<< linear_patch: 2d
2024-03-08 22:29:49,661:INFO:   <<< local_rank: 0
2024-03-08 22:29:49,661:INFO:   <<< loose_type: True
2024-03-08 22:29:49,661:INFO:   <<< lr: 0.001
2024-03-08 22:29:49,661:INFO:   <<< lr_decay: 0.9
2024-03-08 22:29:49,661:INFO:   <<< margin: 0.1
2024-03-08 22:29:49,661:INFO:   <<< max_frames: 64
2024-03-08 22:29:49,661:INFO:   <<< max_words: 77
2024-03-08 22:29:49,661:INFO:   <<< mergeclip: False
2024-03-08 22:29:49,661:INFO:   <<< mergeweight: 0.5
2024-03-08 22:29:49,661:INFO:   <<< n_display: 50
2024-03-08 22:29:49,661:INFO:   <<< n_gpu: 1
2024-03-08 22:29:49,661:INFO:   <<< n_pair: 1
2024-03-08 22:29:49,661:INFO:   <<< negative_weighting: 1
2024-03-08 22:29:49,661:INFO:   <<< num_thread_reader: 1
2024-03-08 22:29:49,661:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:29:49,661:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:29:49,661:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:29:49,661:INFO:   <<< rank: 0
2024-03-08 22:29:49,661:INFO:   <<< resume_model: None
2024-03-08 22:29:49,661:INFO:   <<< sampled_use_mil: False
2024-03-08 22:29:49,661:INFO:   <<< seed: 42
2024-03-08 22:29:49,661:INFO:   <<< sim_header: meanP
2024-03-08 22:29:49,661:INFO:   <<< slice_framepos: 2
2024-03-08 22:29:49,661:INFO:   <<< task_type: retrieval
2024-03-08 22:29:49,661:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:29:49,661:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:29:49,661:INFO:   <<< train_frame_order: 0
2024-03-08 22:29:49,661:INFO:   <<< use_mil: False
2024-03-08 22:29:49,661:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:29:49,661:INFO:   <<< video_dim: 1024
2024-03-08 22:29:49,661:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:29:49,661:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:29:49,661:INFO:   <<< world_size: 1
2024-03-08 22:29:49,661:INFO:   <<< wti_arch: 0
2024-03-08 22:29:49,661:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:29:50,902:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:29:50,902:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:29:50,902:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:29:50,902:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:29:50,902:WARNING: Test retrieval by loose type.
2024-03-08 22:29:50,902:WARNING: 	 embed_dim: 768
2024-03-08 22:29:50,902:WARNING: 	 image_resolution: 224
2024-03-08 22:29:50,902:WARNING: 	 vision_layers: 24
2024-03-08 22:29:50,902:WARNING: 	 vision_width: 1024
2024-03-08 22:29:50,902:WARNING: 	 vision_patch_size: 14
2024-03-08 22:29:50,902:WARNING: 	 context_length: 77
2024-03-08 22:29:50,902:WARNING: 	 vocab_size: 49408
2024-03-08 22:29:50,902:WARNING: 	 transformer_width: 768
2024-03-08 22:29:50,902:WARNING: 	 transformer_heads: 12
2024-03-08 22:29:50,902:WARNING: 	 transformer_layers: 12
2024-03-08 22:29:50,902:WARNING: 		 linear_patch: 2d
2024-03-08 22:29:50,903:WARNING: 	 cut_top_layer: 0
2024-03-08 22:29:52,673:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,715:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,756:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,797:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,839:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,881:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,922:INFO: Drop path rate: 0.0
2024-03-08 22:29:52,964:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,005:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,046:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,088:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,129:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,170:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,211:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,252:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,294:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,335:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,376:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,418:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,459:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,501:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,543:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,584:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,625:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,666:INFO: Use checkpoint: True
2024-03-08 22:29:53,667:INFO: Checkpoint number: [24, 100]
2024-03-08 22:29:53,667:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,728:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,789:INFO: Drop path rate: 0.0
2024-03-08 22:29:53,850:INFO: Drop path rate: 0.0
2024-03-08 22:29:54,895:WARNING: 	 sim_header: meanP
2024-03-08 22:30:17,501:INFO: Effective parameters:
2024-03-08 22:30:17,502:INFO:   <<< batch_size: 64
2024-03-08 22:30:17,502:INFO:   <<< batch_size_val: 16
2024-03-08 22:30:17,502:INFO:   <<< cache_dir: 
2024-03-08 22:30:17,502:INFO:   <<< cdcr: 0
2024-03-08 22:30:17,502:INFO:   <<< clip_evl: True
2024-03-08 22:30:17,502:INFO:   <<< coef_lr: 0.002
2024-03-08 22:30:17,502:INFO:   <<< cross_model: cross-base
2024-03-08 22:30:17,502:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:30:17,502:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:30:17,502:INFO:   <<< datatype: activity
2024-03-08 22:30:17,502:INFO:   <<< do_eval: False
2024-03-08 22:30:17,502:INFO:   <<< do_lower_case: False
2024-03-08 22:30:17,502:INFO:   <<< do_pretrain: False
2024-03-08 22:30:17,502:INFO:   <<< do_train: True
2024-03-08 22:30:17,502:INFO:   <<< epochs: 30
2024-03-08 22:30:17,502:INFO:   <<< eval_frame_order: 0
2024-03-08 22:30:17,502:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:30:17,502:INFO:   <<< feature_framerate: 1
2024-03-08 22:30:17,502:INFO:   <<< features_path: 
2024-03-08 22:30:17,502:INFO:   <<< fp16: False
2024-03-08 22:30:17,502:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:30:17,502:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:30:17,502:INFO:   <<< gpu: 0
2024-03-08 22:30:17,502:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:30:17,502:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:30:17,502:INFO:   <<< init_model: None
2024-03-08 22:30:17,502:INFO:   <<< interaction: no
2024-03-08 22:30:17,502:INFO:   <<< linear_patch: 2d
2024-03-08 22:30:17,502:INFO:   <<< local_rank: 0
2024-03-08 22:30:17,502:INFO:   <<< loose_type: True
2024-03-08 22:30:17,502:INFO:   <<< lr: 0.001
2024-03-08 22:30:17,502:INFO:   <<< lr_decay: 0.9
2024-03-08 22:30:17,502:INFO:   <<< margin: 0.1
2024-03-08 22:30:17,502:INFO:   <<< max_frames: 64
2024-03-08 22:30:17,502:INFO:   <<< max_words: 77
2024-03-08 22:30:17,502:INFO:   <<< mergeclip: False
2024-03-08 22:30:17,502:INFO:   <<< mergeweight: 0.5
2024-03-08 22:30:17,502:INFO:   <<< n_display: 50
2024-03-08 22:30:17,502:INFO:   <<< n_gpu: 1
2024-03-08 22:30:17,502:INFO:   <<< n_pair: 1
2024-03-08 22:30:17,502:INFO:   <<< negative_weighting: 1
2024-03-08 22:30:17,502:INFO:   <<< num_thread_reader: 1
2024-03-08 22:30:17,502:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:30:17,502:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:30:17,502:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:30:17,502:INFO:   <<< rank: 0
2024-03-08 22:30:17,502:INFO:   <<< resume_model: None
2024-03-08 22:30:17,502:INFO:   <<< sampled_use_mil: False
2024-03-08 22:30:17,502:INFO:   <<< seed: 42
2024-03-08 22:30:17,502:INFO:   <<< sim_header: meanP
2024-03-08 22:30:17,502:INFO:   <<< slice_framepos: 2
2024-03-08 22:30:17,502:INFO:   <<< task_type: retrieval
2024-03-08 22:30:17,502:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:30:17,502:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:30:17,502:INFO:   <<< train_frame_order: 0
2024-03-08 22:30:17,502:INFO:   <<< use_mil: False
2024-03-08 22:30:17,502:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:30:17,502:INFO:   <<< video_dim: 1024
2024-03-08 22:30:17,502:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:30:17,502:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:30:17,502:INFO:   <<< world_size: 1
2024-03-08 22:30:17,502:INFO:   <<< wti_arch: 0
2024-03-08 22:30:17,502:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:30:18,746:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:30:18,746:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:30:18,746:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:30:18,746:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:30:18,746:WARNING: Test retrieval by loose type.
2024-03-08 22:30:18,746:WARNING: 	 embed_dim: 768
2024-03-08 22:30:18,746:WARNING: 	 image_resolution: 224
2024-03-08 22:30:18,747:WARNING: 	 vision_layers: 24
2024-03-08 22:30:18,747:WARNING: 	 vision_width: 1024
2024-03-08 22:30:18,747:WARNING: 	 vision_patch_size: 14
2024-03-08 22:30:18,747:WARNING: 	 context_length: 77
2024-03-08 22:30:18,747:WARNING: 	 vocab_size: 49408
2024-03-08 22:30:18,747:WARNING: 	 transformer_width: 768
2024-03-08 22:30:18,747:WARNING: 	 transformer_heads: 12
2024-03-08 22:30:18,747:WARNING: 	 transformer_layers: 12
2024-03-08 22:30:18,747:WARNING: 		 linear_patch: 2d
2024-03-08 22:30:18,747:WARNING: 	 cut_top_layer: 0
2024-03-08 22:30:20,510:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,552:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,593:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,635:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,676:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,717:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,758:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,799:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,840:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,882:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,923:INFO: Drop path rate: 0.0
2024-03-08 22:30:20,964:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,006:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,048:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,090:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,132:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,174:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,215:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,257:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,299:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,342:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,384:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,426:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,468:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,510:INFO: Use checkpoint: True
2024-03-08 22:30:21,510:INFO: Checkpoint number: [24, 100]
2024-03-08 22:30:21,511:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,573:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,634:INFO: Drop path rate: 0.0
2024-03-08 22:30:21,695:INFO: Drop path rate: 0.0
2024-03-08 22:30:22,727:WARNING: 	 sim_header: meanP
2024-03-08 22:38:11,236:INFO: Effective parameters:
2024-03-08 22:38:11,237:INFO:   <<< batch_size: 64
2024-03-08 22:38:11,237:INFO:   <<< batch_size_val: 16
2024-03-08 22:38:11,237:INFO:   <<< cache_dir: 
2024-03-08 22:38:11,237:INFO:   <<< cdcr: 0
2024-03-08 22:38:11,237:INFO:   <<< clip_evl: True
2024-03-08 22:38:11,237:INFO:   <<< coef_lr: 0.002
2024-03-08 22:38:11,237:INFO:   <<< cross_model: cross-base
2024-03-08 22:38:11,237:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:38:11,237:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:38:11,237:INFO:   <<< datatype: activity
2024-03-08 22:38:11,237:INFO:   <<< do_eval: False
2024-03-08 22:38:11,237:INFO:   <<< do_lower_case: False
2024-03-08 22:38:11,237:INFO:   <<< do_pretrain: False
2024-03-08 22:38:11,237:INFO:   <<< do_train: True
2024-03-08 22:38:11,237:INFO:   <<< epochs: 30
2024-03-08 22:38:11,237:INFO:   <<< eval_frame_order: 0
2024-03-08 22:38:11,237:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:38:11,237:INFO:   <<< feature_framerate: 1
2024-03-08 22:38:11,237:INFO:   <<< features_path: ./data
2024-03-08 22:38:11,237:INFO:   <<< fp16: False
2024-03-08 22:38:11,237:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:38:11,237:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:38:11,237:INFO:   <<< gpu: 0
2024-03-08 22:38:11,237:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:38:11,237:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:38:11,237:INFO:   <<< init_model: None
2024-03-08 22:38:11,237:INFO:   <<< interaction: no
2024-03-08 22:38:11,237:INFO:   <<< linear_patch: 2d
2024-03-08 22:38:11,237:INFO:   <<< local_rank: 0
2024-03-08 22:38:11,237:INFO:   <<< loose_type: True
2024-03-08 22:38:11,237:INFO:   <<< lr: 0.001
2024-03-08 22:38:11,237:INFO:   <<< lr_decay: 0.9
2024-03-08 22:38:11,237:INFO:   <<< margin: 0.1
2024-03-08 22:38:11,237:INFO:   <<< max_frames: 64
2024-03-08 22:38:11,237:INFO:   <<< max_words: 77
2024-03-08 22:38:11,237:INFO:   <<< mergeclip: False
2024-03-08 22:38:11,237:INFO:   <<< mergeweight: 0.5
2024-03-08 22:38:11,237:INFO:   <<< n_display: 50
2024-03-08 22:38:11,237:INFO:   <<< n_gpu: 1
2024-03-08 22:38:11,237:INFO:   <<< n_pair: 1
2024-03-08 22:38:11,237:INFO:   <<< negative_weighting: 1
2024-03-08 22:38:11,237:INFO:   <<< num_thread_reader: 1
2024-03-08 22:38:11,237:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:38:11,237:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:38:11,237:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:38:11,237:INFO:   <<< rank: 0
2024-03-08 22:38:11,237:INFO:   <<< resume_model: None
2024-03-08 22:38:11,237:INFO:   <<< sampled_use_mil: False
2024-03-08 22:38:11,237:INFO:   <<< seed: 42
2024-03-08 22:38:11,237:INFO:   <<< sim_header: meanP
2024-03-08 22:38:11,237:INFO:   <<< slice_framepos: 2
2024-03-08 22:38:11,237:INFO:   <<< task_type: retrieval
2024-03-08 22:38:11,237:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:38:11,237:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:38:11,237:INFO:   <<< train_frame_order: 0
2024-03-08 22:38:11,237:INFO:   <<< use_mil: False
2024-03-08 22:38:11,237:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:38:11,237:INFO:   <<< video_dim: 1024
2024-03-08 22:38:11,237:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:38:11,237:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:38:11,237:INFO:   <<< world_size: 1
2024-03-08 22:38:11,237:INFO:   <<< wti_arch: 0
2024-03-08 22:38:11,237:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:38:12,477:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:38:12,477:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:38:12,477:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:38:12,477:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:38:12,477:WARNING: Test retrieval by loose type.
2024-03-08 22:38:12,477:WARNING: 	 embed_dim: 768
2024-03-08 22:38:12,477:WARNING: 	 image_resolution: 224
2024-03-08 22:38:12,477:WARNING: 	 vision_layers: 24
2024-03-08 22:38:12,477:WARNING: 	 vision_width: 1024
2024-03-08 22:38:12,477:WARNING: 	 vision_patch_size: 14
2024-03-08 22:38:12,477:WARNING: 	 context_length: 77
2024-03-08 22:38:12,477:WARNING: 	 vocab_size: 49408
2024-03-08 22:38:12,478:WARNING: 	 transformer_width: 768
2024-03-08 22:38:12,478:WARNING: 	 transformer_heads: 12
2024-03-08 22:38:12,478:WARNING: 	 transformer_layers: 12
2024-03-08 22:38:12,478:WARNING: 		 linear_patch: 2d
2024-03-08 22:38:12,478:WARNING: 	 cut_top_layer: 0
2024-03-08 22:38:14,244:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,286:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,329:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,371:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,413:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,456:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,499:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,542:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,584:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,626:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,667:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,709:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,750:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,792:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,833:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,876:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,918:INFO: Drop path rate: 0.0
2024-03-08 22:38:14,960:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,002:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,045:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,087:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,130:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,171:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,214:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,255:INFO: Use checkpoint: True
2024-03-08 22:38:15,255:INFO: Checkpoint number: [24, 100]
2024-03-08 22:38:15,256:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,318:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,382:INFO: Drop path rate: 0.0
2024-03-08 22:38:15,444:INFO: Drop path rate: 0.0
2024-03-08 22:38:16,466:WARNING: 	 sim_header: meanP
2024-03-08 22:42:09,200:INFO: Effective parameters:
2024-03-08 22:42:09,201:INFO:   <<< batch_size: 64
2024-03-08 22:42:09,201:INFO:   <<< batch_size_val: 16
2024-03-08 22:42:09,201:INFO:   <<< cache_dir: 
2024-03-08 22:42:09,201:INFO:   <<< cdcr: 0
2024-03-08 22:42:09,201:INFO:   <<< clip_evl: True
2024-03-08 22:42:09,201:INFO:   <<< coef_lr: 0.002
2024-03-08 22:42:09,201:INFO:   <<< cross_model: cross-base
2024-03-08 22:42:09,201:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:42:09,201:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:42:09,201:INFO:   <<< datatype: activity
2024-03-08 22:42:09,201:INFO:   <<< do_eval: False
2024-03-08 22:42:09,201:INFO:   <<< do_lower_case: False
2024-03-08 22:42:09,201:INFO:   <<< do_pretrain: False
2024-03-08 22:42:09,201:INFO:   <<< do_train: True
2024-03-08 22:42:09,201:INFO:   <<< epochs: 30
2024-03-08 22:42:09,201:INFO:   <<< eval_frame_order: 0
2024-03-08 22:42:09,201:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:42:09,201:INFO:   <<< feature_framerate: 1
2024-03-08 22:42:09,201:INFO:   <<< features_path: ./data
2024-03-08 22:42:09,201:INFO:   <<< fp16: False
2024-03-08 22:42:09,201:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:42:09,201:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:42:09,201:INFO:   <<< gpu: 0
2024-03-08 22:42:09,201:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:42:09,201:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:42:09,201:INFO:   <<< init_model: None
2024-03-08 22:42:09,201:INFO:   <<< interaction: no
2024-03-08 22:42:09,201:INFO:   <<< linear_patch: 2d
2024-03-08 22:42:09,201:INFO:   <<< local_rank: 0
2024-03-08 22:42:09,201:INFO:   <<< loose_type: True
2024-03-08 22:42:09,201:INFO:   <<< lr: 0.001
2024-03-08 22:42:09,201:INFO:   <<< lr_decay: 0.9
2024-03-08 22:42:09,201:INFO:   <<< margin: 0.1
2024-03-08 22:42:09,201:INFO:   <<< max_frames: 64
2024-03-08 22:42:09,201:INFO:   <<< max_words: 77
2024-03-08 22:42:09,201:INFO:   <<< mergeclip: False
2024-03-08 22:42:09,201:INFO:   <<< mergeweight: 0.5
2024-03-08 22:42:09,201:INFO:   <<< n_display: 50
2024-03-08 22:42:09,201:INFO:   <<< n_gpu: 1
2024-03-08 22:42:09,201:INFO:   <<< n_pair: 1
2024-03-08 22:42:09,201:INFO:   <<< negative_weighting: 1
2024-03-08 22:42:09,201:INFO:   <<< num_thread_reader: 1
2024-03-08 22:42:09,201:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:42:09,201:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:42:09,201:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:42:09,201:INFO:   <<< rank: 0
2024-03-08 22:42:09,201:INFO:   <<< resume_model: None
2024-03-08 22:42:09,201:INFO:   <<< sampled_use_mil: False
2024-03-08 22:42:09,201:INFO:   <<< seed: 42
2024-03-08 22:42:09,201:INFO:   <<< sim_header: meanP
2024-03-08 22:42:09,201:INFO:   <<< slice_framepos: 2
2024-03-08 22:42:09,201:INFO:   <<< task_type: retrieval
2024-03-08 22:42:09,201:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:42:09,201:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:42:09,201:INFO:   <<< train_frame_order: 0
2024-03-08 22:42:09,201:INFO:   <<< use_mil: False
2024-03-08 22:42:09,201:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:42:09,201:INFO:   <<< video_dim: 1024
2024-03-08 22:42:09,201:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:42:09,201:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:42:09,201:INFO:   <<< world_size: 1
2024-03-08 22:42:09,201:INFO:   <<< wti_arch: 0
2024-03-08 22:42:09,201:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:42:10,447:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:42:10,447:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:42:10,447:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:42:10,447:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:42:10,447:WARNING: Test retrieval by loose type.
2024-03-08 22:42:10,447:WARNING: 	 embed_dim: 768
2024-03-08 22:42:10,447:WARNING: 	 image_resolution: 224
2024-03-08 22:42:10,447:WARNING: 	 vision_layers: 24
2024-03-08 22:42:10,447:WARNING: 	 vision_width: 1024
2024-03-08 22:42:10,447:WARNING: 	 vision_patch_size: 14
2024-03-08 22:42:10,447:WARNING: 	 context_length: 77
2024-03-08 22:42:10,447:WARNING: 	 vocab_size: 49408
2024-03-08 22:42:10,447:WARNING: 	 transformer_width: 768
2024-03-08 22:42:10,447:WARNING: 	 transformer_heads: 12
2024-03-08 22:42:10,447:WARNING: 	 transformer_layers: 12
2024-03-08 22:42:10,447:WARNING: 		 linear_patch: 2d
2024-03-08 22:42:10,447:WARNING: 	 cut_top_layer: 0
2024-03-08 22:42:12,212:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,253:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,295:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,336:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,378:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,419:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,461:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,504:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,545:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,587:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,630:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,671:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,713:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,755:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,796:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,838:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,880:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,921:INFO: Drop path rate: 0.0
2024-03-08 22:42:12,962:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,004:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,045:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,086:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,128:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,170:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,212:INFO: Use checkpoint: True
2024-03-08 22:42:13,212:INFO: Checkpoint number: [24, 100]
2024-03-08 22:42:13,213:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,274:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,335:INFO: Drop path rate: 0.0
2024-03-08 22:42:13,396:INFO: Drop path rate: 0.0
2024-03-08 22:42:14,419:WARNING: 	 sim_header: meanP
2024-03-08 22:42:14,510:INFO: ***** Running test *****
2024-03-08 22:42:14,510:INFO:   Num examples = 4916
2024-03-08 22:42:14,510:INFO:   Batch size = 16
2024-03-08 22:42:14,510:INFO:   Num steps = 308
2024-03-08 22:42:14,510:INFO: ***** Running val *****
2024-03-08 22:42:14,510:INFO:   Num examples = 4916
2024-03-08 22:42:14,928:INFO: ***** Running training *****
2024-03-08 22:42:14,928:INFO:   Num examples = 10009
2024-03-08 22:42:14,928:INFO:   Batch size = 64
2024-03-08 22:42:14,928:INFO:   Num steps = 4680
2024-03-08 22:43:24,062:INFO: Effective parameters:
2024-03-08 22:43:24,062:INFO:   <<< batch_size: 64
2024-03-08 22:43:24,062:INFO:   <<< batch_size_val: 16
2024-03-08 22:43:24,062:INFO:   <<< cache_dir: 
2024-03-08 22:43:24,062:INFO:   <<< cdcr: 0
2024-03-08 22:43:24,062:INFO:   <<< clip_evl: True
2024-03-08 22:43:24,062:INFO:   <<< coef_lr: 0.002
2024-03-08 22:43:24,062:INFO:   <<< cross_model: cross-base
2024-03-08 22:43:24,062:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:43:24,062:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:43:24,062:INFO:   <<< datatype: activity
2024-03-08 22:43:24,062:INFO:   <<< do_eval: False
2024-03-08 22:43:24,062:INFO:   <<< do_lower_case: False
2024-03-08 22:43:24,062:INFO:   <<< do_pretrain: False
2024-03-08 22:43:24,062:INFO:   <<< do_train: True
2024-03-08 22:43:24,062:INFO:   <<< epochs: 30
2024-03-08 22:43:24,062:INFO:   <<< eval_frame_order: 0
2024-03-08 22:43:24,062:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:43:24,062:INFO:   <<< feature_framerate: 1
2024-03-08 22:43:24,062:INFO:   <<< features_path: ./data
2024-03-08 22:43:24,062:INFO:   <<< fp16: False
2024-03-08 22:43:24,062:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:43:24,062:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:43:24,062:INFO:   <<< gpu: 0
2024-03-08 22:43:24,062:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:43:24,062:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:43:24,062:INFO:   <<< init_model: None
2024-03-08 22:43:24,062:INFO:   <<< interaction: no
2024-03-08 22:43:24,062:INFO:   <<< linear_patch: 2d
2024-03-08 22:43:24,062:INFO:   <<< local_rank: 0
2024-03-08 22:43:24,062:INFO:   <<< loose_type: True
2024-03-08 22:43:24,062:INFO:   <<< lr: 0.001
2024-03-08 22:43:24,062:INFO:   <<< lr_decay: 0.9
2024-03-08 22:43:24,062:INFO:   <<< margin: 0.1
2024-03-08 22:43:24,062:INFO:   <<< max_frames: 64
2024-03-08 22:43:24,062:INFO:   <<< max_words: 77
2024-03-08 22:43:24,062:INFO:   <<< mergeclip: False
2024-03-08 22:43:24,062:INFO:   <<< mergeweight: 0.5
2024-03-08 22:43:24,062:INFO:   <<< n_display: 50
2024-03-08 22:43:24,062:INFO:   <<< n_gpu: 1
2024-03-08 22:43:24,062:INFO:   <<< n_pair: 1
2024-03-08 22:43:24,062:INFO:   <<< negative_weighting: 1
2024-03-08 22:43:24,062:INFO:   <<< num_thread_reader: 1
2024-03-08 22:43:24,062:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:43:24,062:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:43:24,062:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:43:24,062:INFO:   <<< rank: 0
2024-03-08 22:43:24,062:INFO:   <<< resume_model: None
2024-03-08 22:43:24,062:INFO:   <<< sampled_use_mil: False
2024-03-08 22:43:24,062:INFO:   <<< seed: 42
2024-03-08 22:43:24,062:INFO:   <<< sim_header: meanP
2024-03-08 22:43:24,062:INFO:   <<< slice_framepos: 2
2024-03-08 22:43:24,062:INFO:   <<< task_type: retrieval
2024-03-08 22:43:24,062:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:43:24,062:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:43:24,062:INFO:   <<< train_frame_order: 0
2024-03-08 22:43:24,062:INFO:   <<< use_mil: False
2024-03-08 22:43:24,062:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:43:24,062:INFO:   <<< video_dim: 1024
2024-03-08 22:43:24,063:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:43:24,063:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:43:24,063:INFO:   <<< world_size: 1
2024-03-08 22:43:24,063:INFO:   <<< wti_arch: 0
2024-03-08 22:43:24,063:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:43:25,306:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:43:25,306:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:43:25,306:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:43:25,306:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:43:25,306:WARNING: Test retrieval by loose type.
2024-03-08 22:43:25,306:WARNING: 	 embed_dim: 768
2024-03-08 22:43:25,307:WARNING: 	 image_resolution: 224
2024-03-08 22:43:25,307:WARNING: 	 vision_layers: 24
2024-03-08 22:43:25,307:WARNING: 	 vision_width: 1024
2024-03-08 22:43:25,307:WARNING: 	 vision_patch_size: 14
2024-03-08 22:43:25,307:WARNING: 	 context_length: 77
2024-03-08 22:43:25,307:WARNING: 	 vocab_size: 49408
2024-03-08 22:43:25,307:WARNING: 	 transformer_width: 768
2024-03-08 22:43:25,307:WARNING: 	 transformer_heads: 12
2024-03-08 22:43:25,307:WARNING: 	 transformer_layers: 12
2024-03-08 22:43:25,307:WARNING: 		 linear_patch: 2d
2024-03-08 22:43:25,307:WARNING: 	 cut_top_layer: 0
2024-03-08 22:43:27,081:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,124:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,166:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,208:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,249:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,290:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,331:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,373:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,415:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,458:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,500:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,541:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,583:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,626:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,669:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,710:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,752:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,793:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,834:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,876:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,920:INFO: Drop path rate: 0.0
2024-03-08 22:43:27,963:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,005:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,049:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,091:INFO: Use checkpoint: True
2024-03-08 22:43:28,091:INFO: Checkpoint number: [24, 100]
2024-03-08 22:43:28,092:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,154:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,217:INFO: Drop path rate: 0.0
2024-03-08 22:43:28,281:INFO: Drop path rate: 0.0
2024-03-08 22:43:29,329:WARNING: 	 sim_header: meanP
2024-03-08 22:43:29,421:INFO: ***** Running test *****
2024-03-08 22:43:29,421:INFO:   Num examples = 4916
2024-03-08 22:43:29,421:INFO:   Batch size = 16
2024-03-08 22:43:29,421:INFO:   Num steps = 308
2024-03-08 22:43:29,421:INFO: ***** Running val *****
2024-03-08 22:43:29,421:INFO:   Num examples = 4916
2024-03-08 22:43:29,769:INFO: ***** Running training *****
2024-03-08 22:43:29,769:INFO:   Num examples = 10009
2024-03-08 22:43:29,769:INFO:   Batch size = 64
2024-03-08 22:43:29,769:INFO:   Num steps = 4680
2024-03-08 22:43:40,012:INFO: Effective parameters:
2024-03-08 22:43:40,012:INFO:   <<< batch_size: 64
2024-03-08 22:43:40,012:INFO:   <<< batch_size_val: 16
2024-03-08 22:43:40,012:INFO:   <<< cache_dir: 
2024-03-08 22:43:40,012:INFO:   <<< cdcr: 0
2024-03-08 22:43:40,012:INFO:   <<< clip_evl: True
2024-03-08 22:43:40,012:INFO:   <<< coef_lr: 0.002
2024-03-08 22:43:40,012:INFO:   <<< cross_model: cross-base
2024-03-08 22:43:40,012:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:43:40,012:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:43:40,013:INFO:   <<< datatype: activity
2024-03-08 22:43:40,013:INFO:   <<< do_eval: False
2024-03-08 22:43:40,013:INFO:   <<< do_lower_case: False
2024-03-08 22:43:40,013:INFO:   <<< do_pretrain: False
2024-03-08 22:43:40,013:INFO:   <<< do_train: True
2024-03-08 22:43:40,013:INFO:   <<< epochs: 30
2024-03-08 22:43:40,013:INFO:   <<< eval_frame_order: 0
2024-03-08 22:43:40,013:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:43:40,013:INFO:   <<< feature_framerate: 1
2024-03-08 22:43:40,013:INFO:   <<< features_path: ./data
2024-03-08 22:43:40,013:INFO:   <<< fp16: False
2024-03-08 22:43:40,013:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:43:40,013:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:43:40,013:INFO:   <<< gpu: 0
2024-03-08 22:43:40,013:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:43:40,013:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:43:40,013:INFO:   <<< init_model: None
2024-03-08 22:43:40,013:INFO:   <<< interaction: no
2024-03-08 22:43:40,013:INFO:   <<< linear_patch: 2d
2024-03-08 22:43:40,013:INFO:   <<< local_rank: 0
2024-03-08 22:43:40,013:INFO:   <<< loose_type: True
2024-03-08 22:43:40,013:INFO:   <<< lr: 0.001
2024-03-08 22:43:40,013:INFO:   <<< lr_decay: 0.9
2024-03-08 22:43:40,013:INFO:   <<< margin: 0.1
2024-03-08 22:43:40,013:INFO:   <<< max_frames: 64
2024-03-08 22:43:40,013:INFO:   <<< max_words: 77
2024-03-08 22:43:40,013:INFO:   <<< mergeclip: False
2024-03-08 22:43:40,013:INFO:   <<< mergeweight: 0.5
2024-03-08 22:43:40,013:INFO:   <<< n_display: 50
2024-03-08 22:43:40,013:INFO:   <<< n_gpu: 1
2024-03-08 22:43:40,013:INFO:   <<< n_pair: 1
2024-03-08 22:43:40,013:INFO:   <<< negative_weighting: 1
2024-03-08 22:43:40,013:INFO:   <<< num_thread_reader: 1
2024-03-08 22:43:40,013:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:43:40,013:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:43:40,013:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:43:40,013:INFO:   <<< rank: 0
2024-03-08 22:43:40,013:INFO:   <<< resume_model: None
2024-03-08 22:43:40,013:INFO:   <<< sampled_use_mil: False
2024-03-08 22:43:40,013:INFO:   <<< seed: 42
2024-03-08 22:43:40,013:INFO:   <<< sim_header: meanP
2024-03-08 22:43:40,013:INFO:   <<< slice_framepos: 2
2024-03-08 22:43:40,013:INFO:   <<< task_type: retrieval
2024-03-08 22:43:40,013:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:43:40,013:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:43:40,013:INFO:   <<< train_frame_order: 0
2024-03-08 22:43:40,013:INFO:   <<< use_mil: False
2024-03-08 22:43:40,013:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:43:40,013:INFO:   <<< video_dim: 1024
2024-03-08 22:43:40,013:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:43:40,013:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:43:40,013:INFO:   <<< world_size: 1
2024-03-08 22:43:40,013:INFO:   <<< wti_arch: 0
2024-03-08 22:43:40,013:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:43:41,254:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:43:41,254:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:43:41,254:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:43:41,254:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:43:41,254:WARNING: Test retrieval by loose type.
2024-03-08 22:43:41,254:WARNING: 	 embed_dim: 768
2024-03-08 22:43:41,254:WARNING: 	 image_resolution: 224
2024-03-08 22:43:41,254:WARNING: 	 vision_layers: 24
2024-03-08 22:43:41,254:WARNING: 	 vision_width: 1024
2024-03-08 22:43:41,254:WARNING: 	 vision_patch_size: 14
2024-03-08 22:43:41,254:WARNING: 	 context_length: 77
2024-03-08 22:43:41,254:WARNING: 	 vocab_size: 49408
2024-03-08 22:43:41,254:WARNING: 	 transformer_width: 768
2024-03-08 22:43:41,254:WARNING: 	 transformer_heads: 12
2024-03-08 22:43:41,254:WARNING: 	 transformer_layers: 12
2024-03-08 22:43:41,254:WARNING: 		 linear_patch: 2d
2024-03-08 22:43:41,254:WARNING: 	 cut_top_layer: 0
2024-03-08 22:43:43,021:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,063:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,104:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,147:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,188:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,229:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,270:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,311:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,353:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,395:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,436:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,477:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,519:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,560:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,602:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,643:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,684:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,726:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,767:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,808:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,850:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,892:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,933:INFO: Drop path rate: 0.0
2024-03-08 22:43:43,974:INFO: Drop path rate: 0.0
2024-03-08 22:43:44,016:INFO: Use checkpoint: True
2024-03-08 22:43:44,016:INFO: Checkpoint number: [24, 100]
2024-03-08 22:43:44,016:INFO: Drop path rate: 0.0
2024-03-08 22:43:44,077:INFO: Drop path rate: 0.0
2024-03-08 22:43:44,140:INFO: Drop path rate: 0.0
2024-03-08 22:43:44,201:INFO: Drop path rate: 0.0
2024-03-08 22:43:45,246:WARNING: 	 sim_header: meanP
2024-03-08 22:43:45,336:INFO: ***** Running test *****
2024-03-08 22:43:45,337:INFO:   Num examples = 4916
2024-03-08 22:43:45,337:INFO:   Batch size = 16
2024-03-08 22:43:45,337:INFO:   Num steps = 308
2024-03-08 22:43:45,337:INFO: ***** Running val *****
2024-03-08 22:43:45,337:INFO:   Num examples = 4916
2024-03-08 22:43:45,685:INFO: ***** Running training *****
2024-03-08 22:43:45,685:INFO:   Num examples = 10009
2024-03-08 22:43:45,685:INFO:   Batch size = 64
2024-03-08 22:43:45,685:INFO:   Num steps = 4680
2024-03-08 22:43:59,230:INFO: Effective parameters:
2024-03-08 22:43:59,230:INFO:   <<< batch_size: 64
2024-03-08 22:43:59,230:INFO:   <<< batch_size_val: 16
2024-03-08 22:43:59,230:INFO:   <<< cache_dir: 
2024-03-08 22:43:59,230:INFO:   <<< cdcr: 0
2024-03-08 22:43:59,230:INFO:   <<< clip_evl: True
2024-03-08 22:43:59,230:INFO:   <<< coef_lr: 0.002
2024-03-08 22:43:59,230:INFO:   <<< cross_model: cross-base
2024-03-08 22:43:59,230:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:43:59,230:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:43:59,230:INFO:   <<< datatype: activity
2024-03-08 22:43:59,230:INFO:   <<< do_eval: False
2024-03-08 22:43:59,230:INFO:   <<< do_lower_case: False
2024-03-08 22:43:59,230:INFO:   <<< do_pretrain: False
2024-03-08 22:43:59,230:INFO:   <<< do_train: True
2024-03-08 22:43:59,230:INFO:   <<< epochs: 30
2024-03-08 22:43:59,230:INFO:   <<< eval_frame_order: 0
2024-03-08 22:43:59,230:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:43:59,230:INFO:   <<< feature_framerate: 1
2024-03-08 22:43:59,230:INFO:   <<< features_path: ./data
2024-03-08 22:43:59,230:INFO:   <<< fp16: False
2024-03-08 22:43:59,230:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:43:59,230:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:43:59,230:INFO:   <<< gpu: 0
2024-03-08 22:43:59,230:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:43:59,230:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:43:59,230:INFO:   <<< init_model: None
2024-03-08 22:43:59,230:INFO:   <<< interaction: no
2024-03-08 22:43:59,230:INFO:   <<< linear_patch: 2d
2024-03-08 22:43:59,230:INFO:   <<< local_rank: 0
2024-03-08 22:43:59,230:INFO:   <<< loose_type: True
2024-03-08 22:43:59,230:INFO:   <<< lr: 0.001
2024-03-08 22:43:59,230:INFO:   <<< lr_decay: 0.9
2024-03-08 22:43:59,231:INFO:   <<< margin: 0.1
2024-03-08 22:43:59,231:INFO:   <<< max_frames: 64
2024-03-08 22:43:59,231:INFO:   <<< max_words: 77
2024-03-08 22:43:59,231:INFO:   <<< mergeclip: False
2024-03-08 22:43:59,231:INFO:   <<< mergeweight: 0.5
2024-03-08 22:43:59,231:INFO:   <<< n_display: 50
2024-03-08 22:43:59,231:INFO:   <<< n_gpu: 1
2024-03-08 22:43:59,231:INFO:   <<< n_pair: 1
2024-03-08 22:43:59,231:INFO:   <<< negative_weighting: 1
2024-03-08 22:43:59,231:INFO:   <<< num_thread_reader: 1
2024-03-08 22:43:59,231:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:43:59,231:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:43:59,231:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:43:59,231:INFO:   <<< rank: 0
2024-03-08 22:43:59,231:INFO:   <<< resume_model: None
2024-03-08 22:43:59,231:INFO:   <<< sampled_use_mil: False
2024-03-08 22:43:59,231:INFO:   <<< seed: 42
2024-03-08 22:43:59,231:INFO:   <<< sim_header: meanP
2024-03-08 22:43:59,231:INFO:   <<< slice_framepos: 2
2024-03-08 22:43:59,231:INFO:   <<< task_type: retrieval
2024-03-08 22:43:59,231:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:43:59,231:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:43:59,231:INFO:   <<< train_frame_order: 0
2024-03-08 22:43:59,231:INFO:   <<< use_mil: False
2024-03-08 22:43:59,231:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:43:59,231:INFO:   <<< video_dim: 1024
2024-03-08 22:43:59,231:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:43:59,231:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:43:59,231:INFO:   <<< world_size: 1
2024-03-08 22:43:59,231:INFO:   <<< wti_arch: 0
2024-03-08 22:43:59,231:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:44:00,470:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:44:00,470:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:44:00,470:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:44:00,470:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:44:00,470:WARNING: Test retrieval by loose type.
2024-03-08 22:44:00,470:WARNING: 	 embed_dim: 768
2024-03-08 22:44:00,470:WARNING: 	 image_resolution: 224
2024-03-08 22:44:00,470:WARNING: 	 vision_layers: 24
2024-03-08 22:44:00,470:WARNING: 	 vision_width: 1024
2024-03-08 22:44:00,470:WARNING: 	 vision_patch_size: 14
2024-03-08 22:44:00,470:WARNING: 	 context_length: 77
2024-03-08 22:44:00,470:WARNING: 	 vocab_size: 49408
2024-03-08 22:44:00,470:WARNING: 	 transformer_width: 768
2024-03-08 22:44:00,470:WARNING: 	 transformer_heads: 12
2024-03-08 22:44:00,470:WARNING: 	 transformer_layers: 12
2024-03-08 22:44:00,470:WARNING: 		 linear_patch: 2d
2024-03-08 22:44:00,470:WARNING: 	 cut_top_layer: 0
2024-03-08 22:44:02,237:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,278:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,320:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,361:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,402:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,444:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,485:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,527:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,568:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,609:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,651:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,692:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,733:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,774:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,816:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,858:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,900:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,942:INFO: Drop path rate: 0.0
2024-03-08 22:44:02,984:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,026:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,069:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,111:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,152:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,194:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,235:INFO: Use checkpoint: True
2024-03-08 22:44:03,235:INFO: Checkpoint number: [24, 100]
2024-03-08 22:44:03,236:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,297:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,358:INFO: Drop path rate: 0.0
2024-03-08 22:44:03,420:INFO: Drop path rate: 0.0
2024-03-08 22:44:04,439:WARNING: 	 sim_header: meanP
2024-03-08 22:44:04,530:INFO: ***** Running test *****
2024-03-08 22:44:04,530:INFO:   Num examples = 4916
2024-03-08 22:44:04,530:INFO:   Batch size = 16
2024-03-08 22:44:04,530:INFO:   Num steps = 308
2024-03-08 22:44:04,530:INFO: ***** Running val *****
2024-03-08 22:44:04,530:INFO:   Num examples = 4916
2024-03-08 22:44:04,875:INFO: ***** Running training *****
2024-03-08 22:44:04,875:INFO:   Num examples = 10009
2024-03-08 22:44:04,875:INFO:   Batch size = 64
2024-03-08 22:44:04,875:INFO:   Num steps = 4680
2024-03-08 22:45:10,618:INFO: Effective parameters:
2024-03-08 22:45:10,618:INFO:   <<< batch_size: 64
2024-03-08 22:45:10,618:INFO:   <<< batch_size_val: 16
2024-03-08 22:45:10,618:INFO:   <<< cache_dir: 
2024-03-08 22:45:10,618:INFO:   <<< cdcr: 0
2024-03-08 22:45:10,618:INFO:   <<< clip_evl: True
2024-03-08 22:45:10,618:INFO:   <<< coef_lr: 0.002
2024-03-08 22:45:10,618:INFO:   <<< cross_model: cross-base
2024-03-08 22:45:10,618:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:45:10,618:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:45:10,618:INFO:   <<< datatype: activity
2024-03-08 22:45:10,618:INFO:   <<< do_eval: False
2024-03-08 22:45:10,618:INFO:   <<< do_lower_case: False
2024-03-08 22:45:10,618:INFO:   <<< do_pretrain: False
2024-03-08 22:45:10,618:INFO:   <<< do_train: True
2024-03-08 22:45:10,618:INFO:   <<< epochs: 30
2024-03-08 22:45:10,618:INFO:   <<< eval_frame_order: 0
2024-03-08 22:45:10,618:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:45:10,618:INFO:   <<< feature_framerate: 1
2024-03-08 22:45:10,618:INFO:   <<< features_path: ./data
2024-03-08 22:45:10,618:INFO:   <<< fp16: False
2024-03-08 22:45:10,618:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:45:10,618:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:45:10,618:INFO:   <<< gpu: 0
2024-03-08 22:45:10,618:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:45:10,618:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:45:10,618:INFO:   <<< init_model: None
2024-03-08 22:45:10,618:INFO:   <<< interaction: no
2024-03-08 22:45:10,618:INFO:   <<< linear_patch: 2d
2024-03-08 22:45:10,618:INFO:   <<< local_rank: 0
2024-03-08 22:45:10,618:INFO:   <<< loose_type: True
2024-03-08 22:45:10,618:INFO:   <<< lr: 0.001
2024-03-08 22:45:10,618:INFO:   <<< lr_decay: 0.9
2024-03-08 22:45:10,618:INFO:   <<< margin: 0.1
2024-03-08 22:45:10,618:INFO:   <<< max_frames: 64
2024-03-08 22:45:10,618:INFO:   <<< max_words: 77
2024-03-08 22:45:10,618:INFO:   <<< mergeclip: False
2024-03-08 22:45:10,618:INFO:   <<< mergeweight: 0.5
2024-03-08 22:45:10,618:INFO:   <<< n_display: 50
2024-03-08 22:45:10,618:INFO:   <<< n_gpu: 1
2024-03-08 22:45:10,618:INFO:   <<< n_pair: 1
2024-03-08 22:45:10,618:INFO:   <<< negative_weighting: 1
2024-03-08 22:45:10,618:INFO:   <<< num_thread_reader: 1
2024-03-08 22:45:10,618:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:45:10,618:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:45:10,618:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:45:10,619:INFO:   <<< rank: 0
2024-03-08 22:45:10,619:INFO:   <<< resume_model: None
2024-03-08 22:45:10,619:INFO:   <<< sampled_use_mil: False
2024-03-08 22:45:10,619:INFO:   <<< seed: 42
2024-03-08 22:45:10,619:INFO:   <<< sim_header: meanP
2024-03-08 22:45:10,619:INFO:   <<< slice_framepos: 2
2024-03-08 22:45:10,619:INFO:   <<< task_type: retrieval
2024-03-08 22:45:10,619:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:45:10,619:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:45:10,619:INFO:   <<< train_frame_order: 0
2024-03-08 22:45:10,619:INFO:   <<< use_mil: False
2024-03-08 22:45:10,619:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:45:10,619:INFO:   <<< video_dim: 1024
2024-03-08 22:45:10,619:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:45:10,619:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:45:10,619:INFO:   <<< world_size: 1
2024-03-08 22:45:10,619:INFO:   <<< wti_arch: 0
2024-03-08 22:45:10,619:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:45:11,862:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:45:11,862:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:45:11,862:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:45:11,862:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:45:11,862:WARNING: Test retrieval by loose type.
2024-03-08 22:45:11,862:WARNING: 	 embed_dim: 768
2024-03-08 22:45:11,862:WARNING: 	 image_resolution: 224
2024-03-08 22:45:11,862:WARNING: 	 vision_layers: 24
2024-03-08 22:45:11,862:WARNING: 	 vision_width: 1024
2024-03-08 22:45:11,862:WARNING: 	 vision_patch_size: 14
2024-03-08 22:45:11,863:WARNING: 	 context_length: 77
2024-03-08 22:45:11,863:WARNING: 	 vocab_size: 49408
2024-03-08 22:45:11,863:WARNING: 	 transformer_width: 768
2024-03-08 22:45:11,863:WARNING: 	 transformer_heads: 12
2024-03-08 22:45:11,863:WARNING: 	 transformer_layers: 12
2024-03-08 22:45:11,863:WARNING: 		 linear_patch: 2d
2024-03-08 22:45:11,863:WARNING: 	 cut_top_layer: 0
2024-03-08 22:45:13,632:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,675:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,716:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,758:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,799:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,840:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,882:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,924:INFO: Drop path rate: 0.0
2024-03-08 22:45:13,965:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,007:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,048:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,090:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,131:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,173:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,214:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,255:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,295:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,336:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,377:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,419:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,460:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,501:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,543:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,585:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,627:INFO: Use checkpoint: True
2024-03-08 22:45:14,627:INFO: Checkpoint number: [24, 100]
2024-03-08 22:45:14,628:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,689:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,750:INFO: Drop path rate: 0.0
2024-03-08 22:45:14,811:INFO: Drop path rate: 0.0
2024-03-08 22:45:15,835:WARNING: 	 sim_header: meanP
2024-03-08 22:45:15,928:INFO: ***** Running test *****
2024-03-08 22:45:15,928:INFO:   Num examples = 4916
2024-03-08 22:45:15,928:INFO:   Batch size = 16
2024-03-08 22:45:15,928:INFO:   Num steps = 308
2024-03-08 22:45:15,928:INFO: ***** Running val *****
2024-03-08 22:45:15,928:INFO:   Num examples = 4916
2024-03-08 22:45:16,272:INFO: ***** Running training *****
2024-03-08 22:45:16,272:INFO:   Num examples = 10009
2024-03-08 22:45:16,272:INFO:   Batch size = 64
2024-03-08 22:45:16,272:INFO:   Num steps = 4680
2024-03-08 22:46:08,091:INFO: Effective parameters:
2024-03-08 22:46:08,091:INFO:   <<< batch_size: 64
2024-03-08 22:46:08,091:INFO:   <<< batch_size_val: 16
2024-03-08 22:46:08,091:INFO:   <<< cache_dir: 
2024-03-08 22:46:08,091:INFO:   <<< cdcr: 0
2024-03-08 22:46:08,091:INFO:   <<< clip_evl: True
2024-03-08 22:46:08,091:INFO:   <<< coef_lr: 0.002
2024-03-08 22:46:08,091:INFO:   <<< cross_model: cross-base
2024-03-08 22:46:08,091:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:46:08,091:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:46:08,091:INFO:   <<< datatype: activity
2024-03-08 22:46:08,091:INFO:   <<< do_eval: False
2024-03-08 22:46:08,091:INFO:   <<< do_lower_case: False
2024-03-08 22:46:08,091:INFO:   <<< do_pretrain: False
2024-03-08 22:46:08,091:INFO:   <<< do_train: True
2024-03-08 22:46:08,091:INFO:   <<< epochs: 30
2024-03-08 22:46:08,091:INFO:   <<< eval_frame_order: 0
2024-03-08 22:46:08,091:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:46:08,091:INFO:   <<< feature_framerate: 1
2024-03-08 22:46:08,091:INFO:   <<< features_path: ./data
2024-03-08 22:46:08,091:INFO:   <<< fp16: False
2024-03-08 22:46:08,091:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:46:08,091:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:46:08,091:INFO:   <<< gpu: 0
2024-03-08 22:46:08,091:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:46:08,091:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:46:08,091:INFO:   <<< init_model: None
2024-03-08 22:46:08,091:INFO:   <<< interaction: no
2024-03-08 22:46:08,091:INFO:   <<< linear_patch: 2d
2024-03-08 22:46:08,091:INFO:   <<< local_rank: 0
2024-03-08 22:46:08,091:INFO:   <<< loose_type: True
2024-03-08 22:46:08,091:INFO:   <<< lr: 0.001
2024-03-08 22:46:08,091:INFO:   <<< lr_decay: 0.9
2024-03-08 22:46:08,091:INFO:   <<< margin: 0.1
2024-03-08 22:46:08,091:INFO:   <<< max_frames: 64
2024-03-08 22:46:08,091:INFO:   <<< max_words: 77
2024-03-08 22:46:08,091:INFO:   <<< mergeclip: False
2024-03-08 22:46:08,091:INFO:   <<< mergeweight: 0.5
2024-03-08 22:46:08,091:INFO:   <<< n_display: 50
2024-03-08 22:46:08,091:INFO:   <<< n_gpu: 1
2024-03-08 22:46:08,091:INFO:   <<< n_pair: 1
2024-03-08 22:46:08,091:INFO:   <<< negative_weighting: 1
2024-03-08 22:46:08,091:INFO:   <<< num_thread_reader: 1
2024-03-08 22:46:08,091:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:46:08,091:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:46:08,091:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:46:08,091:INFO:   <<< rank: 0
2024-03-08 22:46:08,091:INFO:   <<< resume_model: None
2024-03-08 22:46:08,091:INFO:   <<< sampled_use_mil: False
2024-03-08 22:46:08,091:INFO:   <<< seed: 42
2024-03-08 22:46:08,091:INFO:   <<< sim_header: meanP
2024-03-08 22:46:08,091:INFO:   <<< slice_framepos: 2
2024-03-08 22:46:08,091:INFO:   <<< task_type: retrieval
2024-03-08 22:46:08,091:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:46:08,091:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:46:08,091:INFO:   <<< train_frame_order: 0
2024-03-08 22:46:08,091:INFO:   <<< use_mil: False
2024-03-08 22:46:08,091:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:46:08,091:INFO:   <<< video_dim: 1024
2024-03-08 22:46:08,091:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:46:08,091:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:46:08,091:INFO:   <<< world_size: 1
2024-03-08 22:46:08,092:INFO:   <<< wti_arch: 0
2024-03-08 22:46:08,092:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:46:09,334:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:46:09,334:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:46:09,334:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:46:09,334:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:46:09,334:WARNING: Test retrieval by loose type.
2024-03-08 22:46:09,335:WARNING: 	 embed_dim: 768
2024-03-08 22:46:09,335:WARNING: 	 image_resolution: 224
2024-03-08 22:46:09,335:WARNING: 	 vision_layers: 24
2024-03-08 22:46:09,335:WARNING: 	 vision_width: 1024
2024-03-08 22:46:09,335:WARNING: 	 vision_patch_size: 14
2024-03-08 22:46:09,335:WARNING: 	 context_length: 77
2024-03-08 22:46:09,335:WARNING: 	 vocab_size: 49408
2024-03-08 22:46:09,335:WARNING: 	 transformer_width: 768
2024-03-08 22:46:09,335:WARNING: 	 transformer_heads: 12
2024-03-08 22:46:09,335:WARNING: 	 transformer_layers: 12
2024-03-08 22:46:09,335:WARNING: 		 linear_patch: 2d
2024-03-08 22:46:09,335:WARNING: 	 cut_top_layer: 0
2024-03-08 22:46:11,103:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,146:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,187:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,230:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,271:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,313:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,354:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,395:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,437:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,478:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,519:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,560:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,602:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,644:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,685:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,727:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,769:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,811:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,852:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,894:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,936:INFO: Drop path rate: 0.0
2024-03-08 22:46:11,978:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,019:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,061:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,102:INFO: Use checkpoint: True
2024-03-08 22:46:12,102:INFO: Checkpoint number: [24, 100]
2024-03-08 22:46:12,103:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,164:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,225:INFO: Drop path rate: 0.0
2024-03-08 22:46:12,286:INFO: Drop path rate: 0.0
2024-03-08 22:46:13,320:WARNING: 	 sim_header: meanP
2024-03-08 22:46:13,415:INFO: ***** Running test *****
2024-03-08 22:46:13,415:INFO:   Num examples = 4916
2024-03-08 22:46:13,415:INFO:   Batch size = 16
2024-03-08 22:46:13,415:INFO:   Num steps = 308
2024-03-08 22:46:13,415:INFO: ***** Running val *****
2024-03-08 22:46:13,415:INFO:   Num examples = 4916
2024-03-08 22:46:13,765:INFO: ***** Running training *****
2024-03-08 22:46:13,765:INFO:   Num examples = 10009
2024-03-08 22:46:13,765:INFO:   Batch size = 64
2024-03-08 22:46:13,765:INFO:   Num steps = 4680
2024-03-08 22:49:30,615:INFO: Effective parameters:
2024-03-08 22:49:30,615:INFO:   <<< batch_size: 64
2024-03-08 22:49:30,615:INFO:   <<< batch_size_val: 16
2024-03-08 22:49:30,615:INFO:   <<< cache_dir: 
2024-03-08 22:49:30,615:INFO:   <<< cdcr: 0
2024-03-08 22:49:30,615:INFO:   <<< clip_evl: True
2024-03-08 22:49:30,615:INFO:   <<< coef_lr: 0.002
2024-03-08 22:49:30,615:INFO:   <<< cross_model: cross-base
2024-03-08 22:49:30,615:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:49:30,615:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:49:30,615:INFO:   <<< datatype: activity
2024-03-08 22:49:30,615:INFO:   <<< do_eval: False
2024-03-08 22:49:30,615:INFO:   <<< do_lower_case: False
2024-03-08 22:49:30,615:INFO:   <<< do_pretrain: False
2024-03-08 22:49:30,615:INFO:   <<< do_train: True
2024-03-08 22:49:30,615:INFO:   <<< epochs: 30
2024-03-08 22:49:30,615:INFO:   <<< eval_frame_order: 0
2024-03-08 22:49:30,615:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:49:30,615:INFO:   <<< feature_framerate: 1
2024-03-08 22:49:30,615:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 22:49:30,615:INFO:   <<< fp16: False
2024-03-08 22:49:30,615:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:49:30,615:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:49:30,615:INFO:   <<< gpu: 0
2024-03-08 22:49:30,615:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:49:30,615:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:49:30,615:INFO:   <<< init_model: None
2024-03-08 22:49:30,615:INFO:   <<< interaction: no
2024-03-08 22:49:30,615:INFO:   <<< linear_patch: 2d
2024-03-08 22:49:30,615:INFO:   <<< local_rank: 0
2024-03-08 22:49:30,615:INFO:   <<< loose_type: True
2024-03-08 22:49:30,615:INFO:   <<< lr: 0.001
2024-03-08 22:49:30,615:INFO:   <<< lr_decay: 0.9
2024-03-08 22:49:30,615:INFO:   <<< margin: 0.1
2024-03-08 22:49:30,615:INFO:   <<< max_frames: 64
2024-03-08 22:49:30,615:INFO:   <<< max_words: 77
2024-03-08 22:49:30,615:INFO:   <<< mergeclip: False
2024-03-08 22:49:30,615:INFO:   <<< mergeweight: 0.5
2024-03-08 22:49:30,615:INFO:   <<< n_display: 50
2024-03-08 22:49:30,615:INFO:   <<< n_gpu: 1
2024-03-08 22:49:30,615:INFO:   <<< n_pair: 1
2024-03-08 22:49:30,615:INFO:   <<< negative_weighting: 1
2024-03-08 22:49:30,615:INFO:   <<< num_thread_reader: 1
2024-03-08 22:49:30,615:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:49:30,615:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:49:30,616:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:49:30,616:INFO:   <<< rank: 0
2024-03-08 22:49:30,616:INFO:   <<< resume_model: None
2024-03-08 22:49:30,616:INFO:   <<< sampled_use_mil: False
2024-03-08 22:49:30,616:INFO:   <<< seed: 42
2024-03-08 22:49:30,616:INFO:   <<< sim_header: meanP
2024-03-08 22:49:30,616:INFO:   <<< slice_framepos: 2
2024-03-08 22:49:30,616:INFO:   <<< task_type: retrieval
2024-03-08 22:49:30,616:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:49:30,616:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:49:30,616:INFO:   <<< train_frame_order: 0
2024-03-08 22:49:30,616:INFO:   <<< use_mil: False
2024-03-08 22:49:30,616:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:49:30,616:INFO:   <<< video_dim: 1024
2024-03-08 22:49:30,616:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:49:30,616:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:49:30,616:INFO:   <<< world_size: 1
2024-03-08 22:49:30,616:INFO:   <<< wti_arch: 0
2024-03-08 22:49:30,616:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:49:31,857:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:49:31,857:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:49:31,857:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:49:31,857:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:49:31,857:WARNING: Test retrieval by loose type.
2024-03-08 22:49:31,857:WARNING: 	 embed_dim: 768
2024-03-08 22:49:31,857:WARNING: 	 image_resolution: 224
2024-03-08 22:49:31,857:WARNING: 	 vision_layers: 24
2024-03-08 22:49:31,857:WARNING: 	 vision_width: 1024
2024-03-08 22:49:31,857:WARNING: 	 vision_patch_size: 14
2024-03-08 22:49:31,857:WARNING: 	 context_length: 77
2024-03-08 22:49:31,858:WARNING: 	 vocab_size: 49408
2024-03-08 22:49:31,858:WARNING: 	 transformer_width: 768
2024-03-08 22:49:31,858:WARNING: 	 transformer_heads: 12
2024-03-08 22:49:31,858:WARNING: 	 transformer_layers: 12
2024-03-08 22:49:31,858:WARNING: 		 linear_patch: 2d
2024-03-08 22:49:31,858:WARNING: 	 cut_top_layer: 0
2024-03-08 22:49:33,633:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,676:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,717:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,759:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,801:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,842:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,884:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,925:INFO: Drop path rate: 0.0
2024-03-08 22:49:33,968:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,010:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,052:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,095:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,138:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,181:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,223:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,266:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,309:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,351:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,394:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,436:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,478:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,521:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,564:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,607:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,648:INFO: Use checkpoint: True
2024-03-08 22:49:34,649:INFO: Checkpoint number: [24, 100]
2024-03-08 22:49:34,649:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,710:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,771:INFO: Drop path rate: 0.0
2024-03-08 22:49:34,834:INFO: Drop path rate: 0.0
2024-03-08 22:49:35,860:WARNING: 	 sim_header: meanP
2024-03-08 22:49:35,955:INFO: ***** Running test *****
2024-03-08 22:49:35,955:INFO:   Num examples = 4916
2024-03-08 22:49:35,955:INFO:   Batch size = 16
2024-03-08 22:49:35,955:INFO:   Num steps = 308
2024-03-08 22:49:35,955:INFO: ***** Running val *****
2024-03-08 22:49:35,955:INFO:   Num examples = 4916
2024-03-08 22:49:36,309:INFO: ***** Running training *****
2024-03-08 22:49:36,309:INFO:   Num examples = 10009
2024-03-08 22:49:36,309:INFO:   Batch size = 64
2024-03-08 22:49:36,309:INFO:   Num steps = 4680
2024-03-08 22:50:12,285:INFO: Effective parameters:
2024-03-08 22:50:12,285:INFO:   <<< batch_size: 64
2024-03-08 22:50:12,285:INFO:   <<< batch_size_val: 16
2024-03-08 22:50:12,285:INFO:   <<< cache_dir: 
2024-03-08 22:50:12,285:INFO:   <<< cdcr: 0
2024-03-08 22:50:12,285:INFO:   <<< clip_evl: True
2024-03-08 22:50:12,285:INFO:   <<< coef_lr: 0.002
2024-03-08 22:50:12,285:INFO:   <<< cross_model: cross-base
2024-03-08 22:50:12,285:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 22:50:12,285:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 22:50:12,285:INFO:   <<< datatype: activity
2024-03-08 22:50:12,285:INFO:   <<< do_eval: False
2024-03-08 22:50:12,285:INFO:   <<< do_lower_case: False
2024-03-08 22:50:12,285:INFO:   <<< do_pretrain: False
2024-03-08 22:50:12,285:INFO:   <<< do_train: True
2024-03-08 22:50:12,285:INFO:   <<< epochs: 30
2024-03-08 22:50:12,285:INFO:   <<< eval_frame_order: 0
2024-03-08 22:50:12,285:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 22:50:12,285:INFO:   <<< feature_framerate: 1
2024-03-08 22:50:12,285:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 22:50:12,285:INFO:   <<< fp16: False
2024-03-08 22:50:12,285:INFO:   <<< fp16_opt_level: O1
2024-03-08 22:50:12,285:INFO:   <<< freeze_layer_num: 0
2024-03-08 22:50:12,285:INFO:   <<< gpu: 0
2024-03-08 22:50:12,285:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 22:50:12,285:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 22:50:12,286:INFO:   <<< init_model: None
2024-03-08 22:50:12,286:INFO:   <<< interaction: no
2024-03-08 22:50:12,286:INFO:   <<< linear_patch: 2d
2024-03-08 22:50:12,286:INFO:   <<< local_rank: 0
2024-03-08 22:50:12,286:INFO:   <<< loose_type: True
2024-03-08 22:50:12,286:INFO:   <<< lr: 0.001
2024-03-08 22:50:12,286:INFO:   <<< lr_decay: 0.9
2024-03-08 22:50:12,286:INFO:   <<< margin: 0.1
2024-03-08 22:50:12,286:INFO:   <<< max_frames: 64
2024-03-08 22:50:12,286:INFO:   <<< max_words: 77
2024-03-08 22:50:12,286:INFO:   <<< mergeclip: False
2024-03-08 22:50:12,286:INFO:   <<< mergeweight: 0.5
2024-03-08 22:50:12,286:INFO:   <<< n_display: 50
2024-03-08 22:50:12,286:INFO:   <<< n_gpu: 1
2024-03-08 22:50:12,286:INFO:   <<< n_pair: 1
2024-03-08 22:50:12,286:INFO:   <<< negative_weighting: 1
2024-03-08 22:50:12,286:INFO:   <<< num_thread_reader: 1
2024-03-08 22:50:12,286:INFO:   <<< output_dir: vidintern_output
2024-03-08 22:50:12,286:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 22:50:12,286:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 22:50:12,286:INFO:   <<< rank: 0
2024-03-08 22:50:12,286:INFO:   <<< resume_model: None
2024-03-08 22:50:12,286:INFO:   <<< sampled_use_mil: False
2024-03-08 22:50:12,286:INFO:   <<< seed: 42
2024-03-08 22:50:12,286:INFO:   <<< sim_header: meanP
2024-03-08 22:50:12,286:INFO:   <<< slice_framepos: 2
2024-03-08 22:50:12,286:INFO:   <<< task_type: retrieval
2024-03-08 22:50:12,286:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 22:50:12,286:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 22:50:12,286:INFO:   <<< train_frame_order: 0
2024-03-08 22:50:12,286:INFO:   <<< use_mil: False
2024-03-08 22:50:12,286:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 22:50:12,286:INFO:   <<< video_dim: 1024
2024-03-08 22:50:12,286:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 22:50:12,286:INFO:   <<< warmup_proportion: 0.1
2024-03-08 22:50:12,286:INFO:   <<< world_size: 1
2024-03-08 22:50:12,286:INFO:   <<< wti_arch: 0
2024-03-08 22:50:12,286:INFO: device: cuda:0 n_gpu: 1
2024-03-08 22:50:13,529:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 22:50:13,529:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 22:50:13,529:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 22:50:13,529:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 22:50:13,529:WARNING: Test retrieval by loose type.
2024-03-08 22:50:13,530:WARNING: 	 embed_dim: 768
2024-03-08 22:50:13,530:WARNING: 	 image_resolution: 224
2024-03-08 22:50:13,530:WARNING: 	 vision_layers: 24
2024-03-08 22:50:13,530:WARNING: 	 vision_width: 1024
2024-03-08 22:50:13,530:WARNING: 	 vision_patch_size: 14
2024-03-08 22:50:13,530:WARNING: 	 context_length: 77
2024-03-08 22:50:13,530:WARNING: 	 vocab_size: 49408
2024-03-08 22:50:13,530:WARNING: 	 transformer_width: 768
2024-03-08 22:50:13,530:WARNING: 	 transformer_heads: 12
2024-03-08 22:50:13,530:WARNING: 	 transformer_layers: 12
2024-03-08 22:50:13,530:WARNING: 		 linear_patch: 2d
2024-03-08 22:50:13,530:WARNING: 	 cut_top_layer: 0
2024-03-08 22:50:15,298:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,340:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,383:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,425:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,468:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,511:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,553:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,594:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,636:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,677:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,719:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,760:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,801:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,843:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,884:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,926:INFO: Drop path rate: 0.0
2024-03-08 22:50:15,968:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,009:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,050:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,091:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,133:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,174:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,216:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,258:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,299:INFO: Use checkpoint: True
2024-03-08 22:50:16,299:INFO: Checkpoint number: [24, 100]
2024-03-08 22:50:16,300:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,362:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,423:INFO: Drop path rate: 0.0
2024-03-08 22:50:16,485:INFO: Drop path rate: 0.0
2024-03-08 22:50:17,509:WARNING: 	 sim_header: meanP
2024-03-08 22:50:17,601:INFO: ***** Running test *****
2024-03-08 22:50:17,601:INFO:   Num examples = 4916
2024-03-08 22:50:17,601:INFO:   Batch size = 16
2024-03-08 22:50:17,601:INFO:   Num steps = 308
2024-03-08 22:50:17,601:INFO: ***** Running val *****
2024-03-08 22:50:17,601:INFO:   Num examples = 4916
2024-03-08 22:50:17,946:INFO: ***** Running training *****
2024-03-08 22:50:17,946:INFO:   Num examples = 10009
2024-03-08 22:50:17,946:INFO:   Batch size = 64
2024-03-08 22:50:17,946:INFO:   Num steps = 4680
2024-03-08 23:14:13,077:INFO: Effective parameters:
2024-03-08 23:14:13,078:INFO:   <<< batch_size: 64
2024-03-08 23:14:13,078:INFO:   <<< batch_size_val: 16
2024-03-08 23:14:13,078:INFO:   <<< cache_dir: 
2024-03-08 23:14:13,078:INFO:   <<< cdcr: 0
2024-03-08 23:14:13,078:INFO:   <<< clip_evl: True
2024-03-08 23:14:13,078:INFO:   <<< coef_lr: 0.002
2024-03-08 23:14:13,078:INFO:   <<< cross_model: cross-base
2024-03-08 23:14:13,078:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:14:13,078:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:14:13,078:INFO:   <<< datatype: activity
2024-03-08 23:14:13,079:INFO:   <<< do_eval: False
2024-03-08 23:14:13,079:INFO:   <<< do_lower_case: False
2024-03-08 23:14:13,079:INFO:   <<< do_pretrain: False
2024-03-08 23:14:13,079:INFO:   <<< do_train: True
2024-03-08 23:14:13,079:INFO:   <<< epochs: 30
2024-03-08 23:14:13,079:INFO:   <<< eval_frame_order: 0
2024-03-08 23:14:13,079:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:14:13,079:INFO:   <<< feature_framerate: 1
2024-03-08 23:14:13,079:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:14:13,079:INFO:   <<< fp16: False
2024-03-08 23:14:13,079:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:14:13,079:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:14:13,079:INFO:   <<< gpu: 0
2024-03-08 23:14:13,079:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:14:13,079:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:14:13,079:INFO:   <<< init_model: None
2024-03-08 23:14:13,079:INFO:   <<< interaction: no
2024-03-08 23:14:13,079:INFO:   <<< linear_patch: 2d
2024-03-08 23:14:13,079:INFO:   <<< local_rank: 0
2024-03-08 23:14:13,079:INFO:   <<< loose_type: True
2024-03-08 23:14:13,079:INFO:   <<< lr: 0.001
2024-03-08 23:14:13,079:INFO:   <<< lr_decay: 0.9
2024-03-08 23:14:13,079:INFO:   <<< margin: 0.1
2024-03-08 23:14:13,079:INFO:   <<< max_frames: 64
2024-03-08 23:14:13,079:INFO:   <<< max_words: 77
2024-03-08 23:14:13,079:INFO:   <<< mergeclip: False
2024-03-08 23:14:13,079:INFO:   <<< mergeweight: 0.5
2024-03-08 23:14:13,079:INFO:   <<< n_display: 50
2024-03-08 23:14:13,079:INFO:   <<< n_gpu: 1
2024-03-08 23:14:13,079:INFO:   <<< n_pair: 1
2024-03-08 23:14:13,079:INFO:   <<< negative_weighting: 1
2024-03-08 23:14:13,079:INFO:   <<< num_thread_reader: 1
2024-03-08 23:14:13,079:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:14:13,079:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:14:13,079:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:14:13,079:INFO:   <<< rank: 0
2024-03-08 23:14:13,079:INFO:   <<< resume_model: None
2024-03-08 23:14:13,079:INFO:   <<< sampled_use_mil: False
2024-03-08 23:14:13,079:INFO:   <<< seed: 42
2024-03-08 23:14:13,079:INFO:   <<< sim_header: meanP
2024-03-08 23:14:13,079:INFO:   <<< slice_framepos: 2
2024-03-08 23:14:13,079:INFO:   <<< task_type: retrieval
2024-03-08 23:14:13,079:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:14:13,079:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:14:13,079:INFO:   <<< train_frame_order: 0
2024-03-08 23:14:13,079:INFO:   <<< use_mil: False
2024-03-08 23:14:13,079:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:14:13,079:INFO:   <<< video_dim: 1024
2024-03-08 23:14:13,079:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:14:13,079:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:14:13,079:INFO:   <<< world_size: 1
2024-03-08 23:14:13,079:INFO:   <<< wti_arch: 0
2024-03-08 23:14:13,079:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:14:14,385:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:14:14,386:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:14:14,386:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:14:14,386:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:14:14,386:WARNING: Test retrieval by loose type.
2024-03-08 23:14:14,386:WARNING: 	 embed_dim: 768
2024-03-08 23:14:14,386:WARNING: 	 image_resolution: 224
2024-03-08 23:14:14,386:WARNING: 	 vision_layers: 24
2024-03-08 23:14:14,386:WARNING: 	 vision_width: 1024
2024-03-08 23:14:14,386:WARNING: 	 vision_patch_size: 14
2024-03-08 23:14:14,386:WARNING: 	 context_length: 77
2024-03-08 23:14:14,386:WARNING: 	 vocab_size: 49408
2024-03-08 23:14:14,386:WARNING: 	 transformer_width: 768
2024-03-08 23:14:14,386:WARNING: 	 transformer_heads: 12
2024-03-08 23:14:14,386:WARNING: 	 transformer_layers: 12
2024-03-08 23:14:14,386:WARNING: 		 linear_patch: 2d
2024-03-08 23:14:14,386:WARNING: 	 cut_top_layer: 0
2024-03-08 23:14:16,241:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,284:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,328:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,372:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,415:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,457:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,500:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,543:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,587:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,630:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,672:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,714:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,756:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,799:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,841:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,884:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,928:INFO: Drop path rate: 0.0
2024-03-08 23:14:16,971:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,014:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,056:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,098:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,141:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,184:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,227:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,270:INFO: Use checkpoint: True
2024-03-08 23:14:17,270:INFO: Checkpoint number: [24, 100]
2024-03-08 23:14:17,270:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,333:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,394:INFO: Drop path rate: 0.0
2024-03-08 23:14:17,456:INFO: Drop path rate: 0.0
2024-03-08 23:14:18,501:WARNING: 	 sim_header: meanP
2024-03-08 23:14:18,531:INFO: ***** Running test *****
2024-03-08 23:14:18,531:INFO:   Num examples = 1243
2024-03-08 23:14:18,531:INFO:   Batch size = 16
2024-03-08 23:14:18,531:INFO:   Num steps = 78
2024-03-08 23:14:18,531:INFO: ***** Running val *****
2024-03-08 23:14:18,532:INFO:   Num examples = 1243
2024-03-08 23:14:18,676:INFO: ***** Running training *****
2024-03-08 23:14:18,676:INFO:   Num examples = 4212
2024-03-08 23:14:18,676:INFO:   Batch size = 64
2024-03-08 23:14:18,676:INFO:   Num steps = 1950
2024-03-08 23:25:03,991:INFO: Effective parameters:
2024-03-08 23:25:03,992:INFO:   <<< batch_size: 64
2024-03-08 23:25:03,992:INFO:   <<< batch_size_val: 16
2024-03-08 23:25:03,992:INFO:   <<< cache_dir: 
2024-03-08 23:25:03,992:INFO:   <<< cdcr: 0
2024-03-08 23:25:03,992:INFO:   <<< clip_evl: True
2024-03-08 23:25:03,992:INFO:   <<< coef_lr: 0.002
2024-03-08 23:25:03,992:INFO:   <<< cross_model: cross-base
2024-03-08 23:25:03,992:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:25:03,992:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:25:03,992:INFO:   <<< datatype: activity
2024-03-08 23:25:03,992:INFO:   <<< do_eval: False
2024-03-08 23:25:03,992:INFO:   <<< do_lower_case: False
2024-03-08 23:25:03,992:INFO:   <<< do_pretrain: False
2024-03-08 23:25:03,992:INFO:   <<< do_train: True
2024-03-08 23:25:03,992:INFO:   <<< epochs: 30
2024-03-08 23:25:03,992:INFO:   <<< eval_frame_order: 0
2024-03-08 23:25:03,992:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:25:03,992:INFO:   <<< feature_framerate: 1
2024-03-08 23:25:03,992:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:25:03,992:INFO:   <<< fp16: False
2024-03-08 23:25:03,992:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:25:03,992:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:25:03,992:INFO:   <<< gpu: 0
2024-03-08 23:25:03,992:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:25:03,992:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:25:03,992:INFO:   <<< init_model: None
2024-03-08 23:25:03,992:INFO:   <<< interaction: no
2024-03-08 23:25:03,992:INFO:   <<< linear_patch: 2d
2024-03-08 23:25:03,992:INFO:   <<< local_rank: 0
2024-03-08 23:25:03,992:INFO:   <<< loose_type: True
2024-03-08 23:25:03,992:INFO:   <<< lr: 0.001
2024-03-08 23:25:03,992:INFO:   <<< lr_decay: 0.9
2024-03-08 23:25:03,992:INFO:   <<< margin: 0.1
2024-03-08 23:25:03,992:INFO:   <<< max_frames: 64
2024-03-08 23:25:03,992:INFO:   <<< max_words: 77
2024-03-08 23:25:03,992:INFO:   <<< mergeclip: False
2024-03-08 23:25:03,992:INFO:   <<< mergeweight: 0.5
2024-03-08 23:25:03,992:INFO:   <<< n_display: 50
2024-03-08 23:25:03,992:INFO:   <<< n_gpu: 1
2024-03-08 23:25:03,992:INFO:   <<< n_pair: 1
2024-03-08 23:25:03,992:INFO:   <<< negative_weighting: 1
2024-03-08 23:25:03,992:INFO:   <<< num_thread_reader: 1
2024-03-08 23:25:03,992:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:25:03,992:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:25:03,992:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:25:03,992:INFO:   <<< rank: 0
2024-03-08 23:25:03,992:INFO:   <<< resume_model: None
2024-03-08 23:25:03,992:INFO:   <<< sampled_use_mil: False
2024-03-08 23:25:03,992:INFO:   <<< seed: 42
2024-03-08 23:25:03,992:INFO:   <<< sim_header: meanP
2024-03-08 23:25:03,992:INFO:   <<< slice_framepos: 2
2024-03-08 23:25:03,992:INFO:   <<< task_type: retrieval
2024-03-08 23:25:03,992:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:25:03,992:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:25:03,992:INFO:   <<< train_frame_order: 0
2024-03-08 23:25:03,992:INFO:   <<< use_mil: False
2024-03-08 23:25:03,992:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:25:03,992:INFO:   <<< video_dim: 1024
2024-03-08 23:25:03,992:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:25:03,992:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:25:03,992:INFO:   <<< world_size: 1
2024-03-08 23:25:03,992:INFO:   <<< wti_arch: 0
2024-03-08 23:25:03,992:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:25:06,245:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:25:06,257:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:25:06,257:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:25:06,257:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:25:06,257:WARNING: Test retrieval by loose type.
2024-03-08 23:25:06,257:WARNING: 	 embed_dim: 768
2024-03-08 23:25:06,257:WARNING: 	 image_resolution: 224
2024-03-08 23:25:06,257:WARNING: 	 vision_layers: 24
2024-03-08 23:25:06,257:WARNING: 	 vision_width: 1024
2024-03-08 23:25:06,257:WARNING: 	 vision_patch_size: 14
2024-03-08 23:25:06,257:WARNING: 	 context_length: 77
2024-03-08 23:25:06,257:WARNING: 	 vocab_size: 49408
2024-03-08 23:25:06,257:WARNING: 	 transformer_width: 768
2024-03-08 23:25:06,257:WARNING: 	 transformer_heads: 12
2024-03-08 23:25:06,257:WARNING: 	 transformer_layers: 12
2024-03-08 23:25:06,257:WARNING: 		 linear_patch: 2d
2024-03-08 23:25:06,257:WARNING: 	 cut_top_layer: 0
2024-03-08 23:25:08,108:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,152:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,195:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,238:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,279:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,322:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,363:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,406:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,448:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,492:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,539:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,586:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,631:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,679:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,724:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,765:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,808:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,849:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,891:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,933:INFO: Drop path rate: 0.0
2024-03-08 23:25:08,975:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,016:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,057:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,099:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,140:INFO: Use checkpoint: True
2024-03-08 23:25:09,140:INFO: Checkpoint number: [24, 100]
2024-03-08 23:25:09,140:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,202:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,262:INFO: Drop path rate: 0.0
2024-03-08 23:25:09,323:INFO: Drop path rate: 0.0
2024-03-08 23:25:10,364:WARNING: 	 sim_header: meanP
2024-03-08 23:25:10,398:INFO: ***** Running test *****
2024-03-08 23:25:10,398:INFO:   Num examples = 1243
2024-03-08 23:25:10,398:INFO:   Batch size = 16
2024-03-08 23:25:10,398:INFO:   Num steps = 78
2024-03-08 23:25:10,398:INFO: ***** Running val *****
2024-03-08 23:25:10,398:INFO:   Num examples = 1243
2024-03-08 23:25:10,554:INFO: ***** Running training *****
2024-03-08 23:25:10,554:INFO:   Num examples = 4212
2024-03-08 23:25:10,554:INFO:   Batch size = 64
2024-03-08 23:25:10,554:INFO:   Num steps = 1950
2024-03-08 23:26:31,827:INFO: Effective parameters:
2024-03-08 23:26:31,827:INFO:   <<< batch_size: 64
2024-03-08 23:26:31,827:INFO:   <<< batch_size_val: 16
2024-03-08 23:26:31,827:INFO:   <<< cache_dir: 
2024-03-08 23:26:31,827:INFO:   <<< cdcr: 0
2024-03-08 23:26:31,827:INFO:   <<< clip_evl: True
2024-03-08 23:26:31,827:INFO:   <<< coef_lr: 0.002
2024-03-08 23:26:31,827:INFO:   <<< cross_model: cross-base
2024-03-08 23:26:31,827:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:26:31,827:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:26:31,827:INFO:   <<< datatype: activity
2024-03-08 23:26:31,828:INFO:   <<< do_eval: False
2024-03-08 23:26:31,828:INFO:   <<< do_lower_case: False
2024-03-08 23:26:31,828:INFO:   <<< do_pretrain: False
2024-03-08 23:26:31,828:INFO:   <<< do_train: True
2024-03-08 23:26:31,828:INFO:   <<< epochs: 30
2024-03-08 23:26:31,828:INFO:   <<< eval_frame_order: 0
2024-03-08 23:26:31,828:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:26:31,828:INFO:   <<< feature_framerate: 1
2024-03-08 23:26:31,828:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:26:31,828:INFO:   <<< fp16: False
2024-03-08 23:26:31,828:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:26:31,828:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:26:31,828:INFO:   <<< gpu: 0
2024-03-08 23:26:31,828:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:26:31,828:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:26:31,828:INFO:   <<< init_model: None
2024-03-08 23:26:31,828:INFO:   <<< interaction: no
2024-03-08 23:26:31,828:INFO:   <<< linear_patch: 2d
2024-03-08 23:26:31,828:INFO:   <<< local_rank: 0
2024-03-08 23:26:31,828:INFO:   <<< loose_type: True
2024-03-08 23:26:31,828:INFO:   <<< lr: 0.001
2024-03-08 23:26:31,828:INFO:   <<< lr_decay: 0.9
2024-03-08 23:26:31,828:INFO:   <<< margin: 0.1
2024-03-08 23:26:31,828:INFO:   <<< max_frames: 64
2024-03-08 23:26:31,828:INFO:   <<< max_words: 77
2024-03-08 23:26:31,828:INFO:   <<< mergeclip: False
2024-03-08 23:26:31,828:INFO:   <<< mergeweight: 0.5
2024-03-08 23:26:31,828:INFO:   <<< n_display: 50
2024-03-08 23:26:31,828:INFO:   <<< n_gpu: 1
2024-03-08 23:26:31,828:INFO:   <<< n_pair: 1
2024-03-08 23:26:31,828:INFO:   <<< negative_weighting: 1
2024-03-08 23:26:31,828:INFO:   <<< num_thread_reader: 1
2024-03-08 23:26:31,828:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:26:31,828:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:26:31,828:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:26:31,828:INFO:   <<< rank: 0
2024-03-08 23:26:31,828:INFO:   <<< resume_model: None
2024-03-08 23:26:31,828:INFO:   <<< sampled_use_mil: False
2024-03-08 23:26:31,828:INFO:   <<< seed: 42
2024-03-08 23:26:31,828:INFO:   <<< sim_header: meanP
2024-03-08 23:26:31,828:INFO:   <<< slice_framepos: 2
2024-03-08 23:26:31,828:INFO:   <<< task_type: retrieval
2024-03-08 23:26:31,828:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:26:31,828:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:26:31,828:INFO:   <<< train_frame_order: 0
2024-03-08 23:26:31,828:INFO:   <<< use_mil: False
2024-03-08 23:26:31,828:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:26:31,828:INFO:   <<< video_dim: 1024
2024-03-08 23:26:31,828:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:26:31,828:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:26:31,828:INFO:   <<< world_size: 1
2024-03-08 23:26:31,828:INFO:   <<< wti_arch: 0
2024-03-08 23:26:31,828:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:26:33,108:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:26:33,108:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:26:33,109:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:26:33,109:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:26:33,109:WARNING: Test retrieval by loose type.
2024-03-08 23:26:33,109:WARNING: 	 embed_dim: 768
2024-03-08 23:26:33,109:WARNING: 	 image_resolution: 224
2024-03-08 23:26:33,109:WARNING: 	 vision_layers: 24
2024-03-08 23:26:33,109:WARNING: 	 vision_width: 1024
2024-03-08 23:26:33,109:WARNING: 	 vision_patch_size: 14
2024-03-08 23:26:33,109:WARNING: 	 context_length: 77
2024-03-08 23:26:33,109:WARNING: 	 vocab_size: 49408
2024-03-08 23:26:33,109:WARNING: 	 transformer_width: 768
2024-03-08 23:26:33,109:WARNING: 	 transformer_heads: 12
2024-03-08 23:26:33,109:WARNING: 	 transformer_layers: 12
2024-03-08 23:26:33,109:WARNING: 		 linear_patch: 2d
2024-03-08 23:26:33,109:WARNING: 	 cut_top_layer: 0
2024-03-08 23:26:35,003:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,046:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,089:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,132:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,175:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,222:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,265:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,308:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,350:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,393:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,436:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,481:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,524:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,567:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,609:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,652:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,697:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,739:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,781:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,823:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,865:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,908:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,951:INFO: Drop path rate: 0.0
2024-03-08 23:26:35,994:INFO: Drop path rate: 0.0
2024-03-08 23:26:36,036:INFO: Use checkpoint: True
2024-03-08 23:26:36,036:INFO: Checkpoint number: [24, 100]
2024-03-08 23:26:36,037:INFO: Drop path rate: 0.0
2024-03-08 23:26:36,099:INFO: Drop path rate: 0.0
2024-03-08 23:26:36,168:INFO: Drop path rate: 0.0
2024-03-08 23:26:36,240:INFO: Drop path rate: 0.0
2024-03-08 23:26:37,337:WARNING: 	 sim_header: meanP
2024-03-08 23:26:37,365:INFO: ***** Running test *****
2024-03-08 23:26:37,365:INFO:   Num examples = 1243
2024-03-08 23:26:37,365:INFO:   Batch size = 16
2024-03-08 23:26:37,365:INFO:   Num steps = 78
2024-03-08 23:26:37,365:INFO: ***** Running val *****
2024-03-08 23:26:37,365:INFO:   Num examples = 1243
2024-03-08 23:26:37,521:INFO: ***** Running training *****
2024-03-08 23:26:37,521:INFO:   Num examples = 4212
2024-03-08 23:26:37,521:INFO:   Batch size = 64
2024-03-08 23:26:37,521:INFO:   Num steps = 1950
2024-03-08 23:27:37,859:INFO: Effective parameters:
2024-03-08 23:27:37,859:INFO:   <<< batch_size: 64
2024-03-08 23:27:37,859:INFO:   <<< batch_size_val: 16
2024-03-08 23:27:37,859:INFO:   <<< cache_dir: 
2024-03-08 23:27:37,859:INFO:   <<< cdcr: 0
2024-03-08 23:27:37,859:INFO:   <<< clip_evl: True
2024-03-08 23:27:37,859:INFO:   <<< coef_lr: 0.002
2024-03-08 23:27:37,859:INFO:   <<< cross_model: cross-base
2024-03-08 23:27:37,859:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:27:37,859:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:27:37,859:INFO:   <<< datatype: activity
2024-03-08 23:27:37,859:INFO:   <<< do_eval: False
2024-03-08 23:27:37,859:INFO:   <<< do_lower_case: False
2024-03-08 23:27:37,859:INFO:   <<< do_pretrain: False
2024-03-08 23:27:37,859:INFO:   <<< do_train: True
2024-03-08 23:27:37,859:INFO:   <<< epochs: 30
2024-03-08 23:27:37,859:INFO:   <<< eval_frame_order: 0
2024-03-08 23:27:37,859:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:27:37,859:INFO:   <<< feature_framerate: 1
2024-03-08 23:27:37,859:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:27:37,859:INFO:   <<< fp16: False
2024-03-08 23:27:37,859:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:27:37,859:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:27:37,860:INFO:   <<< gpu: 0
2024-03-08 23:27:37,860:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:27:37,860:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:27:37,860:INFO:   <<< init_model: None
2024-03-08 23:27:37,860:INFO:   <<< interaction: no
2024-03-08 23:27:37,860:INFO:   <<< linear_patch: 2d
2024-03-08 23:27:37,860:INFO:   <<< local_rank: 0
2024-03-08 23:27:37,860:INFO:   <<< loose_type: True
2024-03-08 23:27:37,860:INFO:   <<< lr: 0.001
2024-03-08 23:27:37,860:INFO:   <<< lr_decay: 0.9
2024-03-08 23:27:37,860:INFO:   <<< margin: 0.1
2024-03-08 23:27:37,860:INFO:   <<< max_frames: 64
2024-03-08 23:27:37,860:INFO:   <<< max_words: 77
2024-03-08 23:27:37,860:INFO:   <<< mergeclip: False
2024-03-08 23:27:37,860:INFO:   <<< mergeweight: 0.5
2024-03-08 23:27:37,860:INFO:   <<< n_display: 50
2024-03-08 23:27:37,860:INFO:   <<< n_gpu: 1
2024-03-08 23:27:37,860:INFO:   <<< n_pair: 1
2024-03-08 23:27:37,860:INFO:   <<< negative_weighting: 1
2024-03-08 23:27:37,860:INFO:   <<< num_thread_reader: 1
2024-03-08 23:27:37,860:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:27:37,860:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:27:37,860:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:27:37,860:INFO:   <<< rank: 0
2024-03-08 23:27:37,860:INFO:   <<< resume_model: None
2024-03-08 23:27:37,860:INFO:   <<< sampled_use_mil: False
2024-03-08 23:27:37,860:INFO:   <<< seed: 42
2024-03-08 23:27:37,860:INFO:   <<< sim_header: meanP
2024-03-08 23:27:37,860:INFO:   <<< slice_framepos: 2
2024-03-08 23:27:37,860:INFO:   <<< task_type: retrieval
2024-03-08 23:27:37,860:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:27:37,860:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:27:37,860:INFO:   <<< train_frame_order: 0
2024-03-08 23:27:37,860:INFO:   <<< use_mil: False
2024-03-08 23:27:37,860:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:27:37,860:INFO:   <<< video_dim: 1024
2024-03-08 23:27:37,860:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:27:37,860:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:27:37,860:INFO:   <<< world_size: 1
2024-03-08 23:27:37,860:INFO:   <<< wti_arch: 0
2024-03-08 23:27:37,860:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:27:39,168:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:27:39,169:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:27:39,169:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:27:39,169:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:27:39,169:WARNING: Test retrieval by loose type.
2024-03-08 23:27:39,169:WARNING: 	 embed_dim: 768
2024-03-08 23:27:39,169:WARNING: 	 image_resolution: 224
2024-03-08 23:27:39,169:WARNING: 	 vision_layers: 24
2024-03-08 23:27:39,169:WARNING: 	 vision_width: 1024
2024-03-08 23:27:39,169:WARNING: 	 vision_patch_size: 14
2024-03-08 23:27:39,169:WARNING: 	 context_length: 77
2024-03-08 23:27:39,169:WARNING: 	 vocab_size: 49408
2024-03-08 23:27:39,169:WARNING: 	 transformer_width: 768
2024-03-08 23:27:39,169:WARNING: 	 transformer_heads: 12
2024-03-08 23:27:39,169:WARNING: 	 transformer_layers: 12
2024-03-08 23:27:39,169:WARNING: 		 linear_patch: 2d
2024-03-08 23:27:39,169:WARNING: 	 cut_top_layer: 0
2024-03-08 23:27:41,074:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,117:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,159:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,203:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,249:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,291:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,334:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,377:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,420:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,466:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,509:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,552:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,594:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,637:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,681:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,726:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,769:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,811:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,854:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,897:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,945:INFO: Drop path rate: 0.0
2024-03-08 23:27:41,988:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,031:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,074:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,117:INFO: Use checkpoint: True
2024-03-08 23:27:42,117:INFO: Checkpoint number: [24, 100]
2024-03-08 23:27:42,118:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,193:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,261:INFO: Drop path rate: 0.0
2024-03-08 23:27:42,323:INFO: Drop path rate: 0.0
2024-03-08 23:27:43,457:WARNING: 	 sim_header: meanP
2024-03-08 23:27:43,485:INFO: ***** Running test *****
2024-03-08 23:27:43,485:INFO:   Num examples = 1243
2024-03-08 23:27:43,485:INFO:   Batch size = 16
2024-03-08 23:27:43,485:INFO:   Num steps = 78
2024-03-08 23:27:43,485:INFO: ***** Running val *****
2024-03-08 23:27:43,485:INFO:   Num examples = 1243
2024-03-08 23:27:43,635:INFO: ***** Running training *****
2024-03-08 23:27:43,635:INFO:   Num examples = 4212
2024-03-08 23:27:43,635:INFO:   Batch size = 64
2024-03-08 23:27:43,635:INFO:   Num steps = 1950
2024-03-08 23:29:32,083:INFO: Effective parameters:
2024-03-08 23:29:32,083:INFO:   <<< batch_size: 64
2024-03-08 23:29:32,083:INFO:   <<< batch_size_val: 16
2024-03-08 23:29:32,083:INFO:   <<< cache_dir: 
2024-03-08 23:29:32,083:INFO:   <<< cdcr: 0
2024-03-08 23:29:32,083:INFO:   <<< clip_evl: True
2024-03-08 23:29:32,083:INFO:   <<< coef_lr: 0.002
2024-03-08 23:29:32,083:INFO:   <<< cross_model: cross-base
2024-03-08 23:29:32,083:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:29:32,083:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:29:32,083:INFO:   <<< datatype: activity
2024-03-08 23:29:32,083:INFO:   <<< do_eval: False
2024-03-08 23:29:32,083:INFO:   <<< do_lower_case: False
2024-03-08 23:29:32,083:INFO:   <<< do_pretrain: False
2024-03-08 23:29:32,083:INFO:   <<< do_train: True
2024-03-08 23:29:32,083:INFO:   <<< epochs: 30
2024-03-08 23:29:32,083:INFO:   <<< eval_frame_order: 0
2024-03-08 23:29:32,083:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:29:32,083:INFO:   <<< feature_framerate: 1
2024-03-08 23:29:32,083:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:29:32,083:INFO:   <<< fp16: False
2024-03-08 23:29:32,083:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:29:32,083:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:29:32,083:INFO:   <<< gpu: 0
2024-03-08 23:29:32,083:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:29:32,083:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:29:32,083:INFO:   <<< init_model: None
2024-03-08 23:29:32,083:INFO:   <<< interaction: no
2024-03-08 23:29:32,083:INFO:   <<< linear_patch: 2d
2024-03-08 23:29:32,083:INFO:   <<< local_rank: 0
2024-03-08 23:29:32,083:INFO:   <<< loose_type: True
2024-03-08 23:29:32,083:INFO:   <<< lr: 0.001
2024-03-08 23:29:32,083:INFO:   <<< lr_decay: 0.9
2024-03-08 23:29:32,083:INFO:   <<< margin: 0.1
2024-03-08 23:29:32,083:INFO:   <<< max_frames: 64
2024-03-08 23:29:32,083:INFO:   <<< max_words: 77
2024-03-08 23:29:32,083:INFO:   <<< mergeclip: False
2024-03-08 23:29:32,083:INFO:   <<< mergeweight: 0.5
2024-03-08 23:29:32,083:INFO:   <<< n_display: 50
2024-03-08 23:29:32,083:INFO:   <<< n_gpu: 1
2024-03-08 23:29:32,083:INFO:   <<< n_pair: 1
2024-03-08 23:29:32,083:INFO:   <<< negative_weighting: 1
2024-03-08 23:29:32,083:INFO:   <<< num_thread_reader: 1
2024-03-08 23:29:32,083:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:29:32,083:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:29:32,083:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:29:32,083:INFO:   <<< rank: 0
2024-03-08 23:29:32,083:INFO:   <<< resume_model: None
2024-03-08 23:29:32,083:INFO:   <<< sampled_use_mil: False
2024-03-08 23:29:32,084:INFO:   <<< seed: 42
2024-03-08 23:29:32,084:INFO:   <<< sim_header: meanP
2024-03-08 23:29:32,084:INFO:   <<< slice_framepos: 2
2024-03-08 23:29:32,084:INFO:   <<< task_type: retrieval
2024-03-08 23:29:32,084:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:29:32,084:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:29:32,084:INFO:   <<< train_frame_order: 0
2024-03-08 23:29:32,084:INFO:   <<< use_mil: False
2024-03-08 23:29:32,084:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:29:32,084:INFO:   <<< video_dim: 1024
2024-03-08 23:29:32,084:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:29:32,084:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:29:32,084:INFO:   <<< world_size: 1
2024-03-08 23:29:32,084:INFO:   <<< wti_arch: 0
2024-03-08 23:29:32,084:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:29:33,412:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:29:33,412:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:29:33,412:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:29:33,412:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:29:33,412:WARNING: Test retrieval by loose type.
2024-03-08 23:29:33,413:WARNING: 	 embed_dim: 768
2024-03-08 23:29:33,413:WARNING: 	 image_resolution: 224
2024-03-08 23:29:33,413:WARNING: 	 vision_layers: 24
2024-03-08 23:29:33,413:WARNING: 	 vision_width: 1024
2024-03-08 23:29:33,413:WARNING: 	 vision_patch_size: 14
2024-03-08 23:29:33,413:WARNING: 	 context_length: 77
2024-03-08 23:29:33,413:WARNING: 	 vocab_size: 49408
2024-03-08 23:29:33,413:WARNING: 	 transformer_width: 768
2024-03-08 23:29:33,413:WARNING: 	 transformer_heads: 12
2024-03-08 23:29:33,413:WARNING: 	 transformer_layers: 12
2024-03-08 23:29:33,413:WARNING: 		 linear_patch: 2d
2024-03-08 23:29:33,413:WARNING: 	 cut_top_layer: 0
2024-03-08 23:29:35,340:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,384:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,428:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,471:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,520:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,564:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,607:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,650:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,693:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,738:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,785:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,829:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,873:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,916:INFO: Drop path rate: 0.0
2024-03-08 23:29:35,959:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,006:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,050:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,093:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,136:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,179:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,223:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,270:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,314:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,358:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,401:INFO: Use checkpoint: True
2024-03-08 23:29:36,401:INFO: Checkpoint number: [24, 100]
2024-03-08 23:29:36,402:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,493:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,567:INFO: Drop path rate: 0.0
2024-03-08 23:29:36,640:INFO: Drop path rate: 0.0
2024-03-08 23:29:37,810:WARNING: 	 sim_header: meanP
2024-03-08 23:29:37,838:INFO: ***** Running test *****
2024-03-08 23:29:37,838:INFO:   Num examples = 1243
2024-03-08 23:29:37,838:INFO:   Batch size = 16
2024-03-08 23:29:37,838:INFO:   Num steps = 78
2024-03-08 23:29:37,838:INFO: ***** Running val *****
2024-03-08 23:29:37,838:INFO:   Num examples = 1243
2024-03-08 23:29:38,013:INFO: ***** Running training *****
2024-03-08 23:29:38,013:INFO:   Num examples = 4212
2024-03-08 23:29:38,013:INFO:   Batch size = 64
2024-03-08 23:29:38,013:INFO:   Num steps = 1950
2024-03-08 23:32:25,906:INFO: Effective parameters:
2024-03-08 23:32:25,907:INFO:   <<< batch_size: 64
2024-03-08 23:32:25,907:INFO:   <<< batch_size_val: 16
2024-03-08 23:32:25,907:INFO:   <<< cache_dir: 
2024-03-08 23:32:25,907:INFO:   <<< cdcr: 0
2024-03-08 23:32:25,907:INFO:   <<< clip_evl: True
2024-03-08 23:32:25,907:INFO:   <<< coef_lr: 0.002
2024-03-08 23:32:25,907:INFO:   <<< cross_model: cross-base
2024-03-08 23:32:25,907:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:32:25,907:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:32:25,907:INFO:   <<< datatype: activity
2024-03-08 23:32:25,907:INFO:   <<< do_eval: False
2024-03-08 23:32:25,907:INFO:   <<< do_lower_case: False
2024-03-08 23:32:25,907:INFO:   <<< do_pretrain: False
2024-03-08 23:32:25,907:INFO:   <<< do_train: True
2024-03-08 23:32:25,907:INFO:   <<< epochs: 1
2024-03-08 23:32:25,907:INFO:   <<< eval_frame_order: 0
2024-03-08 23:32:25,907:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:32:25,907:INFO:   <<< feature_framerate: 1
2024-03-08 23:32:25,907:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:32:25,907:INFO:   <<< fp16: False
2024-03-08 23:32:25,907:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:32:25,907:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:32:25,907:INFO:   <<< gpu: 0
2024-03-08 23:32:25,907:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:32:25,907:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:32:25,907:INFO:   <<< init_model: None
2024-03-08 23:32:25,907:INFO:   <<< interaction: no
2024-03-08 23:32:25,907:INFO:   <<< linear_patch: 2d
2024-03-08 23:32:25,907:INFO:   <<< local_rank: 0
2024-03-08 23:32:25,907:INFO:   <<< loose_type: True
2024-03-08 23:32:25,907:INFO:   <<< lr: 0.001
2024-03-08 23:32:25,907:INFO:   <<< lr_decay: 0.9
2024-03-08 23:32:25,907:INFO:   <<< margin: 0.1
2024-03-08 23:32:25,907:INFO:   <<< max_frames: 64
2024-03-08 23:32:25,907:INFO:   <<< max_words: 77
2024-03-08 23:32:25,907:INFO:   <<< mergeclip: False
2024-03-08 23:32:25,907:INFO:   <<< mergeweight: 0.5
2024-03-08 23:32:25,907:INFO:   <<< n_display: 50
2024-03-08 23:32:25,907:INFO:   <<< n_gpu: 1
2024-03-08 23:32:25,907:INFO:   <<< n_pair: 1
2024-03-08 23:32:25,907:INFO:   <<< negative_weighting: 1
2024-03-08 23:32:25,907:INFO:   <<< num_thread_reader: 1
2024-03-08 23:32:25,907:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:32:25,907:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:32:25,907:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:32:25,907:INFO:   <<< rank: 0
2024-03-08 23:32:25,907:INFO:   <<< resume_model: None
2024-03-08 23:32:25,907:INFO:   <<< sampled_use_mil: False
2024-03-08 23:32:25,907:INFO:   <<< seed: 42
2024-03-08 23:32:25,907:INFO:   <<< sim_header: meanP
2024-03-08 23:32:25,907:INFO:   <<< slice_framepos: 2
2024-03-08 23:32:25,907:INFO:   <<< task_type: retrieval
2024-03-08 23:32:25,907:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:32:25,907:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:32:25,907:INFO:   <<< train_frame_order: 0
2024-03-08 23:32:25,907:INFO:   <<< use_mil: False
2024-03-08 23:32:25,907:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:32:25,907:INFO:   <<< video_dim: 1024
2024-03-08 23:32:25,907:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:32:25,907:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:32:25,907:INFO:   <<< world_size: 1
2024-03-08 23:32:25,907:INFO:   <<< wti_arch: 0
2024-03-08 23:32:25,907:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:32:27,178:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:32:27,179:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:32:27,179:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:32:27,179:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:32:27,179:WARNING: Test retrieval by loose type.
2024-03-08 23:32:27,179:WARNING: 	 embed_dim: 768
2024-03-08 23:32:27,180:WARNING: 	 image_resolution: 224
2024-03-08 23:32:27,180:WARNING: 	 vision_layers: 24
2024-03-08 23:32:27,180:WARNING: 	 vision_width: 1024
2024-03-08 23:32:27,180:WARNING: 	 vision_patch_size: 14
2024-03-08 23:32:27,180:WARNING: 	 context_length: 77
2024-03-08 23:32:27,180:WARNING: 	 vocab_size: 49408
2024-03-08 23:32:27,180:WARNING: 	 transformer_width: 768
2024-03-08 23:32:27,180:WARNING: 	 transformer_heads: 12
2024-03-08 23:32:27,180:WARNING: 	 transformer_layers: 12
2024-03-08 23:32:27,180:WARNING: 		 linear_patch: 2d
2024-03-08 23:32:27,180:WARNING: 	 cut_top_layer: 0
2024-03-08 23:32:29,011:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,054:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,097:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,140:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,183:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,228:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,271:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,314:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,357:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,402:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,446:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,488:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,531:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,574:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,617:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,660:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,703:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,745:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,787:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,831:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,874:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,917:INFO: Drop path rate: 0.0
2024-03-08 23:32:29,960:INFO: Drop path rate: 0.0
2024-03-08 23:32:30,002:INFO: Drop path rate: 0.0
2024-03-08 23:32:30,046:INFO: Use checkpoint: True
2024-03-08 23:32:30,046:INFO: Checkpoint number: [24, 100]
2024-03-08 23:32:30,047:INFO: Drop path rate: 0.0
2024-03-08 23:32:30,110:INFO: Drop path rate: 0.0
2024-03-08 23:32:30,180:INFO: Drop path rate: 0.0
2024-03-08 23:32:30,245:INFO: Drop path rate: 0.0
2024-03-08 23:32:31,326:WARNING: 	 sim_header: meanP
2024-03-08 23:32:31,354:INFO: ***** Running test *****
2024-03-08 23:32:31,354:INFO:   Num examples = 1243
2024-03-08 23:32:31,354:INFO:   Batch size = 16
2024-03-08 23:32:31,354:INFO:   Num steps = 78
2024-03-08 23:32:31,354:INFO: ***** Running val *****
2024-03-08 23:32:31,354:INFO:   Num examples = 1243
2024-03-08 23:32:31,502:INFO: ***** Running training *****
2024-03-08 23:32:31,502:INFO:   Num examples = 4212
2024-03-08 23:32:31,502:INFO:   Batch size = 64
2024-03-08 23:32:31,502:INFO:   Num steps = 65
2024-03-08 23:33:40,120:INFO: Effective parameters:
2024-03-08 23:33:40,120:INFO:   <<< batch_size: 64
2024-03-08 23:33:40,120:INFO:   <<< batch_size_val: 16
2024-03-08 23:33:40,120:INFO:   <<< cache_dir: 
2024-03-08 23:33:40,120:INFO:   <<< cdcr: 0
2024-03-08 23:33:40,120:INFO:   <<< clip_evl: True
2024-03-08 23:33:40,120:INFO:   <<< coef_lr: 0.002
2024-03-08 23:33:40,120:INFO:   <<< cross_model: cross-base
2024-03-08 23:33:40,120:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:33:40,120:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:33:40,120:INFO:   <<< datatype: activity
2024-03-08 23:33:40,120:INFO:   <<< do_eval: False
2024-03-08 23:33:40,120:INFO:   <<< do_lower_case: False
2024-03-08 23:33:40,120:INFO:   <<< do_pretrain: False
2024-03-08 23:33:40,120:INFO:   <<< do_train: True
2024-03-08 23:33:40,120:INFO:   <<< epochs: 1
2024-03-08 23:33:40,120:INFO:   <<< eval_frame_order: 0
2024-03-08 23:33:40,120:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:33:40,120:INFO:   <<< feature_framerate: 1
2024-03-08 23:33:40,120:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:33:40,120:INFO:   <<< fp16: False
2024-03-08 23:33:40,120:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:33:40,120:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:33:40,120:INFO:   <<< gpu: 0
2024-03-08 23:33:40,120:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:33:40,120:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:33:40,120:INFO:   <<< init_model: None
2024-03-08 23:33:40,120:INFO:   <<< interaction: no
2024-03-08 23:33:40,120:INFO:   <<< linear_patch: 2d
2024-03-08 23:33:40,120:INFO:   <<< local_rank: 0
2024-03-08 23:33:40,120:INFO:   <<< loose_type: True
2024-03-08 23:33:40,120:INFO:   <<< lr: 0.001
2024-03-08 23:33:40,120:INFO:   <<< lr_decay: 0.9
2024-03-08 23:33:40,120:INFO:   <<< margin: 0.1
2024-03-08 23:33:40,120:INFO:   <<< max_frames: 64
2024-03-08 23:33:40,120:INFO:   <<< max_words: 77
2024-03-08 23:33:40,120:INFO:   <<< mergeclip: False
2024-03-08 23:33:40,120:INFO:   <<< mergeweight: 0.5
2024-03-08 23:33:40,120:INFO:   <<< n_display: 50
2024-03-08 23:33:40,120:INFO:   <<< n_gpu: 1
2024-03-08 23:33:40,120:INFO:   <<< n_pair: 1
2024-03-08 23:33:40,120:INFO:   <<< negative_weighting: 1
2024-03-08 23:33:40,120:INFO:   <<< num_thread_reader: 1
2024-03-08 23:33:40,120:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:33:40,120:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:33:40,120:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:33:40,120:INFO:   <<< rank: 0
2024-03-08 23:33:40,120:INFO:   <<< resume_model: None
2024-03-08 23:33:40,121:INFO:   <<< sampled_use_mil: False
2024-03-08 23:33:40,121:INFO:   <<< seed: 42
2024-03-08 23:33:40,121:INFO:   <<< sim_header: meanP
2024-03-08 23:33:40,121:INFO:   <<< slice_framepos: 2
2024-03-08 23:33:40,121:INFO:   <<< task_type: retrieval
2024-03-08 23:33:40,121:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:33:40,121:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:33:40,121:INFO:   <<< train_frame_order: 0
2024-03-08 23:33:40,121:INFO:   <<< use_mil: False
2024-03-08 23:33:40,121:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:33:40,121:INFO:   <<< video_dim: 1024
2024-03-08 23:33:40,121:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:33:40,121:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:33:40,121:INFO:   <<< world_size: 1
2024-03-08 23:33:40,121:INFO:   <<< wti_arch: 0
2024-03-08 23:33:40,121:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:33:41,398:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:33:41,398:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:33:41,398:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:33:41,398:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:33:41,399:WARNING: Test retrieval by loose type.
2024-03-08 23:33:41,399:WARNING: 	 embed_dim: 768
2024-03-08 23:33:41,399:WARNING: 	 image_resolution: 224
2024-03-08 23:33:41,399:WARNING: 	 vision_layers: 24
2024-03-08 23:33:41,399:WARNING: 	 vision_width: 1024
2024-03-08 23:33:41,399:WARNING: 	 vision_patch_size: 14
2024-03-08 23:33:41,399:WARNING: 	 context_length: 77
2024-03-08 23:33:41,399:WARNING: 	 vocab_size: 49408
2024-03-08 23:33:41,399:WARNING: 	 transformer_width: 768
2024-03-08 23:33:41,400:WARNING: 	 transformer_heads: 12
2024-03-08 23:33:41,400:WARNING: 	 transformer_layers: 12
2024-03-08 23:33:41,400:WARNING: 		 linear_patch: 2d
2024-03-08 23:33:41,400:WARNING: 	 cut_top_layer: 0
2024-03-08 23:33:43,253:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,294:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,342:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,399:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,457:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,515:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,567:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,618:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,663:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,707:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,752:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,794:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,836:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,879:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,921:INFO: Drop path rate: 0.0
2024-03-08 23:33:43,963:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,004:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,047:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,090:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,133:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,175:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,218:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,260:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,303:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,345:INFO: Use checkpoint: True
2024-03-08 23:33:44,345:INFO: Checkpoint number: [24, 100]
2024-03-08 23:33:44,347:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,411:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,472:INFO: Drop path rate: 0.0
2024-03-08 23:33:44,536:INFO: Drop path rate: 0.0
2024-03-08 23:33:45,600:WARNING: 	 sim_header: meanP
2024-03-08 23:33:45,628:INFO: ***** Running test *****
2024-03-08 23:33:45,628:INFO:   Num examples = 1243
2024-03-08 23:33:45,628:INFO:   Batch size = 16
2024-03-08 23:33:45,628:INFO:   Num steps = 78
2024-03-08 23:33:45,628:INFO: ***** Running val *****
2024-03-08 23:33:45,628:INFO:   Num examples = 1243
2024-03-08 23:33:45,778:INFO: ***** Running training *****
2024-03-08 23:33:45,778:INFO:   Num examples = 4212
2024-03-08 23:33:45,778:INFO:   Batch size = 64
2024-03-08 23:33:45,778:INFO:   Num steps = 65
2024-03-08 23:36:09,625:INFO: Effective parameters:
2024-03-08 23:36:09,625:INFO:   <<< batch_size: 64
2024-03-08 23:36:09,625:INFO:   <<< batch_size_val: 16
2024-03-08 23:36:09,625:INFO:   <<< cache_dir: 
2024-03-08 23:36:09,625:INFO:   <<< cdcr: 0
2024-03-08 23:36:09,625:INFO:   <<< clip_evl: True
2024-03-08 23:36:09,625:INFO:   <<< coef_lr: 0.002
2024-03-08 23:36:09,625:INFO:   <<< cross_model: cross-base
2024-03-08 23:36:09,625:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:36:09,625:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:36:09,625:INFO:   <<< datatype: activity
2024-03-08 23:36:09,625:INFO:   <<< do_eval: False
2024-03-08 23:36:09,625:INFO:   <<< do_lower_case: False
2024-03-08 23:36:09,625:INFO:   <<< do_pretrain: False
2024-03-08 23:36:09,625:INFO:   <<< do_train: True
2024-03-08 23:36:09,625:INFO:   <<< epochs: 1
2024-03-08 23:36:09,625:INFO:   <<< eval_frame_order: 0
2024-03-08 23:36:09,625:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:36:09,625:INFO:   <<< feature_framerate: 1
2024-03-08 23:36:09,625:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:36:09,625:INFO:   <<< fp16: False
2024-03-08 23:36:09,625:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:36:09,625:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:36:09,625:INFO:   <<< gpu: 0
2024-03-08 23:36:09,625:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:36:09,625:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:36:09,625:INFO:   <<< init_model: None
2024-03-08 23:36:09,625:INFO:   <<< interaction: no
2024-03-08 23:36:09,625:INFO:   <<< linear_patch: 2d
2024-03-08 23:36:09,625:INFO:   <<< local_rank: 0
2024-03-08 23:36:09,625:INFO:   <<< loose_type: True
2024-03-08 23:36:09,625:INFO:   <<< lr: 0.001
2024-03-08 23:36:09,625:INFO:   <<< lr_decay: 0.9
2024-03-08 23:36:09,625:INFO:   <<< margin: 0.1
2024-03-08 23:36:09,625:INFO:   <<< max_frames: 64
2024-03-08 23:36:09,625:INFO:   <<< max_words: 77
2024-03-08 23:36:09,625:INFO:   <<< mergeclip: False
2024-03-08 23:36:09,625:INFO:   <<< mergeweight: 0.5
2024-03-08 23:36:09,625:INFO:   <<< n_display: 50
2024-03-08 23:36:09,626:INFO:   <<< n_gpu: 1
2024-03-08 23:36:09,626:INFO:   <<< n_pair: 1
2024-03-08 23:36:09,626:INFO:   <<< negative_weighting: 1
2024-03-08 23:36:09,626:INFO:   <<< num_thread_reader: 1
2024-03-08 23:36:09,626:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:36:09,626:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:36:09,626:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:36:09,626:INFO:   <<< rank: 0
2024-03-08 23:36:09,626:INFO:   <<< resume_model: None
2024-03-08 23:36:09,626:INFO:   <<< sampled_use_mil: False
2024-03-08 23:36:09,626:INFO:   <<< seed: 42
2024-03-08 23:36:09,626:INFO:   <<< sim_header: meanP
2024-03-08 23:36:09,626:INFO:   <<< slice_framepos: 2
2024-03-08 23:36:09,626:INFO:   <<< task_type: retrieval
2024-03-08 23:36:09,626:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:36:09,626:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:36:09,626:INFO:   <<< train_frame_order: 0
2024-03-08 23:36:09,626:INFO:   <<< use_mil: False
2024-03-08 23:36:09,626:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:36:09,626:INFO:   <<< video_dim: 1024
2024-03-08 23:36:09,626:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:36:09,626:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:36:09,626:INFO:   <<< world_size: 1
2024-03-08 23:36:09,626:INFO:   <<< wti_arch: 0
2024-03-08 23:36:09,626:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:36:10,937:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:36:10,937:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:36:10,937:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:36:10,937:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:36:10,937:WARNING: Test retrieval by loose type.
2024-03-08 23:36:10,937:WARNING: 	 embed_dim: 768
2024-03-08 23:36:10,937:WARNING: 	 image_resolution: 224
2024-03-08 23:36:10,937:WARNING: 	 vision_layers: 24
2024-03-08 23:36:10,937:WARNING: 	 vision_width: 1024
2024-03-08 23:36:10,937:WARNING: 	 vision_patch_size: 14
2024-03-08 23:36:10,937:WARNING: 	 context_length: 77
2024-03-08 23:36:10,937:WARNING: 	 vocab_size: 49408
2024-03-08 23:36:10,937:WARNING: 	 transformer_width: 768
2024-03-08 23:36:10,937:WARNING: 	 transformer_heads: 12
2024-03-08 23:36:10,937:WARNING: 	 transformer_layers: 12
2024-03-08 23:36:10,937:WARNING: 		 linear_patch: 2d
2024-03-08 23:36:10,937:WARNING: 	 cut_top_layer: 0
2024-03-08 23:36:12,786:INFO: Drop path rate: 0.0
2024-03-08 23:36:12,829:INFO: Drop path rate: 0.0
2024-03-08 23:36:12,873:INFO: Drop path rate: 0.0
2024-03-08 23:36:12,916:INFO: Drop path rate: 0.0
2024-03-08 23:36:12,959:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,001:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,045:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,089:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,132:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,175:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,218:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,260:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,302:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,344:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,386:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,428:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,470:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,513:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,555:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,597:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,640:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,683:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,726:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,769:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,811:INFO: Use checkpoint: True
2024-03-08 23:36:13,811:INFO: Checkpoint number: [24, 100]
2024-03-08 23:36:13,812:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,876:INFO: Drop path rate: 0.0
2024-03-08 23:36:13,938:INFO: Drop path rate: 0.0
2024-03-08 23:36:14,001:INFO: Drop path rate: 0.0
2024-03-08 23:36:15,095:WARNING: 	 sim_header: meanP
2024-03-08 23:36:15,123:INFO: ***** Running test *****
2024-03-08 23:36:15,123:INFO:   Num examples = 1243
2024-03-08 23:36:15,123:INFO:   Batch size = 16
2024-03-08 23:36:15,123:INFO:   Num steps = 78
2024-03-08 23:36:15,123:INFO: ***** Running val *****
2024-03-08 23:36:15,123:INFO:   Num examples = 1243
2024-03-08 23:36:15,272:INFO: ***** Running training *****
2024-03-08 23:36:15,272:INFO:   Num examples = 4212
2024-03-08 23:36:15,272:INFO:   Batch size = 64
2024-03-08 23:36:15,272:INFO:   Num steps = 65
2024-03-08 23:36:50,838:INFO: Effective parameters:
2024-03-08 23:36:50,838:INFO:   <<< batch_size: 64
2024-03-08 23:36:50,838:INFO:   <<< batch_size_val: 16
2024-03-08 23:36:50,838:INFO:   <<< cache_dir: 
2024-03-08 23:36:50,838:INFO:   <<< cdcr: 0
2024-03-08 23:36:50,838:INFO:   <<< clip_evl: True
2024-03-08 23:36:50,838:INFO:   <<< coef_lr: 0.002
2024-03-08 23:36:50,838:INFO:   <<< cross_model: cross-base
2024-03-08 23:36:50,838:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:36:50,838:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:36:50,838:INFO:   <<< datatype: activity
2024-03-08 23:36:50,838:INFO:   <<< do_eval: False
2024-03-08 23:36:50,838:INFO:   <<< do_lower_case: False
2024-03-08 23:36:50,838:INFO:   <<< do_pretrain: False
2024-03-08 23:36:50,838:INFO:   <<< do_train: True
2024-03-08 23:36:50,838:INFO:   <<< epochs: 1
2024-03-08 23:36:50,838:INFO:   <<< eval_frame_order: 0
2024-03-08 23:36:50,838:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:36:50,838:INFO:   <<< feature_framerate: 1
2024-03-08 23:36:50,838:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:36:50,838:INFO:   <<< fp16: False
2024-03-08 23:36:50,838:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:36:50,838:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:36:50,838:INFO:   <<< gpu: 0
2024-03-08 23:36:50,838:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:36:50,838:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:36:50,839:INFO:   <<< init_model: None
2024-03-08 23:36:50,839:INFO:   <<< interaction: no
2024-03-08 23:36:50,839:INFO:   <<< linear_patch: 2d
2024-03-08 23:36:50,839:INFO:   <<< local_rank: 0
2024-03-08 23:36:50,839:INFO:   <<< loose_type: True
2024-03-08 23:36:50,839:INFO:   <<< lr: 0.001
2024-03-08 23:36:50,839:INFO:   <<< lr_decay: 0.9
2024-03-08 23:36:50,839:INFO:   <<< margin: 0.1
2024-03-08 23:36:50,839:INFO:   <<< max_frames: 64
2024-03-08 23:36:50,839:INFO:   <<< max_words: 77
2024-03-08 23:36:50,839:INFO:   <<< mergeclip: False
2024-03-08 23:36:50,839:INFO:   <<< mergeweight: 0.5
2024-03-08 23:36:50,839:INFO:   <<< n_display: 50
2024-03-08 23:36:50,839:INFO:   <<< n_gpu: 1
2024-03-08 23:36:50,839:INFO:   <<< n_pair: 1
2024-03-08 23:36:50,839:INFO:   <<< negative_weighting: 1
2024-03-08 23:36:50,839:INFO:   <<< num_thread_reader: 1
2024-03-08 23:36:50,839:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:36:50,839:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:36:50,839:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:36:50,839:INFO:   <<< rank: 0
2024-03-08 23:36:50,839:INFO:   <<< resume_model: None
2024-03-08 23:36:50,839:INFO:   <<< sampled_use_mil: False
2024-03-08 23:36:50,839:INFO:   <<< seed: 42
2024-03-08 23:36:50,839:INFO:   <<< sim_header: meanP
2024-03-08 23:36:50,839:INFO:   <<< slice_framepos: 2
2024-03-08 23:36:50,839:INFO:   <<< task_type: retrieval
2024-03-08 23:36:50,839:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:36:50,839:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:36:50,839:INFO:   <<< train_frame_order: 0
2024-03-08 23:36:50,839:INFO:   <<< use_mil: False
2024-03-08 23:36:50,839:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:36:50,839:INFO:   <<< video_dim: 1024
2024-03-08 23:36:50,839:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:36:50,839:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:36:50,839:INFO:   <<< world_size: 1
2024-03-08 23:36:50,839:INFO:   <<< wti_arch: 0
2024-03-08 23:36:50,839:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:36:52,116:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:36:52,116:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:36:52,117:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:36:52,117:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:36:52,117:WARNING: Test retrieval by loose type.
2024-03-08 23:36:52,117:WARNING: 	 embed_dim: 768
2024-03-08 23:36:52,117:WARNING: 	 image_resolution: 224
2024-03-08 23:36:52,117:WARNING: 	 vision_layers: 24
2024-03-08 23:36:52,117:WARNING: 	 vision_width: 1024
2024-03-08 23:36:52,117:WARNING: 	 vision_patch_size: 14
2024-03-08 23:36:52,117:WARNING: 	 context_length: 77
2024-03-08 23:36:52,117:WARNING: 	 vocab_size: 49408
2024-03-08 23:36:52,117:WARNING: 	 transformer_width: 768
2024-03-08 23:36:52,117:WARNING: 	 transformer_heads: 12
2024-03-08 23:36:52,117:WARNING: 	 transformer_layers: 12
2024-03-08 23:36:52,117:WARNING: 		 linear_patch: 2d
2024-03-08 23:36:52,117:WARNING: 	 cut_top_layer: 0
2024-03-08 23:36:53,958:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,002:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,046:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,089:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,133:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,176:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,220:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,262:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,305:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,348:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,391:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,434:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,477:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,520:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,563:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,607:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,650:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,692:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,735:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,778:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,822:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,864:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,907:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,949:INFO: Drop path rate: 0.0
2024-03-08 23:36:54,991:INFO: Use checkpoint: True
2024-03-08 23:36:54,991:INFO: Checkpoint number: [24, 100]
2024-03-08 23:36:54,992:INFO: Drop path rate: 0.0
2024-03-08 23:36:55,055:INFO: Drop path rate: 0.0
2024-03-08 23:36:55,116:INFO: Drop path rate: 0.0
2024-03-08 23:36:55,180:INFO: Drop path rate: 0.0
2024-03-08 23:36:56,230:WARNING: 	 sim_header: meanP
2024-03-08 23:36:56,258:INFO: ***** Running test *****
2024-03-08 23:36:56,258:INFO:   Num examples = 1243
2024-03-08 23:36:56,258:INFO:   Batch size = 16
2024-03-08 23:36:56,258:INFO:   Num steps = 78
2024-03-08 23:36:56,258:INFO: ***** Running val *****
2024-03-08 23:36:56,258:INFO:   Num examples = 1243
2024-03-08 23:36:56,404:INFO: ***** Running training *****
2024-03-08 23:36:56,404:INFO:   Num examples = 4212
2024-03-08 23:36:56,404:INFO:   Batch size = 64
2024-03-08 23:36:56,404:INFO:   Num steps = 65
2024-03-08 23:40:55,193:INFO: Effective parameters:
2024-03-08 23:40:55,193:INFO:   <<< batch_size: 16
2024-03-08 23:40:55,193:INFO:   <<< batch_size_val: 16
2024-03-08 23:40:55,193:INFO:   <<< cache_dir: 
2024-03-08 23:40:55,193:INFO:   <<< cdcr: 0
2024-03-08 23:40:55,194:INFO:   <<< clip_evl: True
2024-03-08 23:40:55,194:INFO:   <<< coef_lr: 0.002
2024-03-08 23:40:55,194:INFO:   <<< cross_model: cross-base
2024-03-08 23:40:55,194:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:40:55,194:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:40:55,194:INFO:   <<< datatype: activity
2024-03-08 23:40:55,194:INFO:   <<< do_eval: False
2024-03-08 23:40:55,194:INFO:   <<< do_lower_case: False
2024-03-08 23:40:55,194:INFO:   <<< do_pretrain: False
2024-03-08 23:40:55,194:INFO:   <<< do_train: True
2024-03-08 23:40:55,194:INFO:   <<< epochs: 1
2024-03-08 23:40:55,194:INFO:   <<< eval_frame_order: 0
2024-03-08 23:40:55,194:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:40:55,194:INFO:   <<< feature_framerate: 1
2024-03-08 23:40:55,194:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:40:55,194:INFO:   <<< fp16: False
2024-03-08 23:40:55,194:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:40:55,194:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:40:55,194:INFO:   <<< gpu: 0
2024-03-08 23:40:55,194:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:40:55,194:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:40:55,194:INFO:   <<< init_model: None
2024-03-08 23:40:55,194:INFO:   <<< interaction: no
2024-03-08 23:40:55,194:INFO:   <<< linear_patch: 2d
2024-03-08 23:40:55,194:INFO:   <<< local_rank: 0
2024-03-08 23:40:55,194:INFO:   <<< loose_type: True
2024-03-08 23:40:55,194:INFO:   <<< lr: 0.001
2024-03-08 23:40:55,194:INFO:   <<< lr_decay: 0.9
2024-03-08 23:40:55,194:INFO:   <<< margin: 0.1
2024-03-08 23:40:55,194:INFO:   <<< max_frames: 64
2024-03-08 23:40:55,194:INFO:   <<< max_words: 77
2024-03-08 23:40:55,194:INFO:   <<< mergeclip: False
2024-03-08 23:40:55,194:INFO:   <<< mergeweight: 0.5
2024-03-08 23:40:55,194:INFO:   <<< n_display: 50
2024-03-08 23:40:55,194:INFO:   <<< n_gpu: 1
2024-03-08 23:40:55,194:INFO:   <<< n_pair: 1
2024-03-08 23:40:55,194:INFO:   <<< negative_weighting: 1
2024-03-08 23:40:55,194:INFO:   <<< num_thread_reader: 1
2024-03-08 23:40:55,194:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:40:55,194:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:40:55,194:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:40:55,194:INFO:   <<< rank: 0
2024-03-08 23:40:55,194:INFO:   <<< resume_model: None
2024-03-08 23:40:55,194:INFO:   <<< sampled_use_mil: False
2024-03-08 23:40:55,194:INFO:   <<< seed: 42
2024-03-08 23:40:55,194:INFO:   <<< sim_header: meanP
2024-03-08 23:40:55,194:INFO:   <<< slice_framepos: 2
2024-03-08 23:40:55,194:INFO:   <<< task_type: retrieval
2024-03-08 23:40:55,194:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:40:55,194:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:40:55,194:INFO:   <<< train_frame_order: 0
2024-03-08 23:40:55,194:INFO:   <<< use_mil: False
2024-03-08 23:40:55,194:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:40:55,194:INFO:   <<< video_dim: 1024
2024-03-08 23:40:55,194:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:40:55,194:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:40:55,194:INFO:   <<< world_size: 1
2024-03-08 23:40:55,194:INFO:   <<< wti_arch: 0
2024-03-08 23:40:55,194:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:40:56,508:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:40:56,508:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:40:56,508:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:40:56,509:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:40:56,509:WARNING: Test retrieval by loose type.
2024-03-08 23:40:56,509:WARNING: 	 embed_dim: 768
2024-03-08 23:40:56,509:WARNING: 	 image_resolution: 224
2024-03-08 23:40:56,509:WARNING: 	 vision_layers: 24
2024-03-08 23:40:56,509:WARNING: 	 vision_width: 1024
2024-03-08 23:40:56,509:WARNING: 	 vision_patch_size: 14
2024-03-08 23:40:56,509:WARNING: 	 context_length: 77
2024-03-08 23:40:56,509:WARNING: 	 vocab_size: 49408
2024-03-08 23:40:56,509:WARNING: 	 transformer_width: 768
2024-03-08 23:40:56,509:WARNING: 	 transformer_heads: 12
2024-03-08 23:40:56,510:WARNING: 	 transformer_layers: 12
2024-03-08 23:40:56,510:WARNING: 		 linear_patch: 2d
2024-03-08 23:40:56,510:WARNING: 	 cut_top_layer: 0
2024-03-08 23:40:58,345:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,388:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,430:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,472:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,517:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,560:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,603:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,647:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,691:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,735:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,777:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,821:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,864:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,908:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,951:INFO: Drop path rate: 0.0
2024-03-08 23:40:58,995:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,038:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,082:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,126:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,169:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,212:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,256:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,299:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,342:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,385:INFO: Use checkpoint: True
2024-03-08 23:40:59,385:INFO: Checkpoint number: [24, 100]
2024-03-08 23:40:59,386:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,447:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,509:INFO: Drop path rate: 0.0
2024-03-08 23:40:59,571:INFO: Drop path rate: 0.0
2024-03-08 23:41:00,627:WARNING: 	 sim_header: meanP
2024-03-08 23:41:00,658:INFO: ***** Running test *****
2024-03-08 23:41:00,658:INFO:   Num examples = 1243
2024-03-08 23:41:00,658:INFO:   Batch size = 16
2024-03-08 23:41:00,659:INFO:   Num steps = 78
2024-03-08 23:41:00,659:INFO: ***** Running val *****
2024-03-08 23:41:00,659:INFO:   Num examples = 1243
2024-03-08 23:41:00,808:INFO: ***** Running training *****
2024-03-08 23:41:00,809:INFO:   Num examples = 4212
2024-03-08 23:41:00,809:INFO:   Batch size = 16
2024-03-08 23:41:00,809:INFO:   Num steps = 263
2024-03-08 23:42:21,249:INFO: Effective parameters:
2024-03-08 23:42:21,249:INFO:   <<< batch_size: 8
2024-03-08 23:42:21,249:INFO:   <<< batch_size_val: 8
2024-03-08 23:42:21,249:INFO:   <<< cache_dir: 
2024-03-08 23:42:21,249:INFO:   <<< cdcr: 0
2024-03-08 23:42:21,249:INFO:   <<< clip_evl: True
2024-03-08 23:42:21,249:INFO:   <<< coef_lr: 0.002
2024-03-08 23:42:21,249:INFO:   <<< cross_model: cross-base
2024-03-08 23:42:21,249:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:42:21,249:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:42:21,249:INFO:   <<< datatype: activity
2024-03-08 23:42:21,249:INFO:   <<< do_eval: False
2024-03-08 23:42:21,249:INFO:   <<< do_lower_case: False
2024-03-08 23:42:21,249:INFO:   <<< do_pretrain: False
2024-03-08 23:42:21,249:INFO:   <<< do_train: True
2024-03-08 23:42:21,249:INFO:   <<< epochs: 1
2024-03-08 23:42:21,249:INFO:   <<< eval_frame_order: 0
2024-03-08 23:42:21,249:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:42:21,249:INFO:   <<< feature_framerate: 1
2024-03-08 23:42:21,249:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:42:21,250:INFO:   <<< fp16: False
2024-03-08 23:42:21,250:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:42:21,250:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:42:21,250:INFO:   <<< gpu: 0
2024-03-08 23:42:21,250:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:42:21,250:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:42:21,250:INFO:   <<< init_model: None
2024-03-08 23:42:21,250:INFO:   <<< interaction: no
2024-03-08 23:42:21,250:INFO:   <<< linear_patch: 2d
2024-03-08 23:42:21,250:INFO:   <<< local_rank: 0
2024-03-08 23:42:21,250:INFO:   <<< loose_type: True
2024-03-08 23:42:21,250:INFO:   <<< lr: 0.001
2024-03-08 23:42:21,250:INFO:   <<< lr_decay: 0.9
2024-03-08 23:42:21,250:INFO:   <<< margin: 0.1
2024-03-08 23:42:21,250:INFO:   <<< max_frames: 64
2024-03-08 23:42:21,250:INFO:   <<< max_words: 77
2024-03-08 23:42:21,250:INFO:   <<< mergeclip: False
2024-03-08 23:42:21,250:INFO:   <<< mergeweight: 0.5
2024-03-08 23:42:21,250:INFO:   <<< n_display: 50
2024-03-08 23:42:21,250:INFO:   <<< n_gpu: 1
2024-03-08 23:42:21,250:INFO:   <<< n_pair: 1
2024-03-08 23:42:21,250:INFO:   <<< negative_weighting: 1
2024-03-08 23:42:21,250:INFO:   <<< num_thread_reader: 1
2024-03-08 23:42:21,250:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:42:21,250:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:42:21,250:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:42:21,250:INFO:   <<< rank: 0
2024-03-08 23:42:21,250:INFO:   <<< resume_model: None
2024-03-08 23:42:21,250:INFO:   <<< sampled_use_mil: False
2024-03-08 23:42:21,250:INFO:   <<< seed: 42
2024-03-08 23:42:21,250:INFO:   <<< sim_header: meanP
2024-03-08 23:42:21,250:INFO:   <<< slice_framepos: 2
2024-03-08 23:42:21,250:INFO:   <<< task_type: retrieval
2024-03-08 23:42:21,250:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:42:21,250:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:42:21,250:INFO:   <<< train_frame_order: 0
2024-03-08 23:42:21,250:INFO:   <<< use_mil: False
2024-03-08 23:42:21,250:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:42:21,250:INFO:   <<< video_dim: 1024
2024-03-08 23:42:21,250:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:42:21,250:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:42:21,250:INFO:   <<< world_size: 1
2024-03-08 23:42:21,250:INFO:   <<< wti_arch: 0
2024-03-08 23:42:21,250:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:42:22,539:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:42:22,539:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:42:22,539:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:42:22,539:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:42:22,539:WARNING: Test retrieval by loose type.
2024-03-08 23:42:22,540:WARNING: 	 embed_dim: 768
2024-03-08 23:42:22,540:WARNING: 	 image_resolution: 224
2024-03-08 23:42:22,540:WARNING: 	 vision_layers: 24
2024-03-08 23:42:22,540:WARNING: 	 vision_width: 1024
2024-03-08 23:42:22,540:WARNING: 	 vision_patch_size: 14
2024-03-08 23:42:22,540:WARNING: 	 context_length: 77
2024-03-08 23:42:22,540:WARNING: 	 vocab_size: 49408
2024-03-08 23:42:22,540:WARNING: 	 transformer_width: 768
2024-03-08 23:42:22,540:WARNING: 	 transformer_heads: 12
2024-03-08 23:42:22,540:WARNING: 	 transformer_layers: 12
2024-03-08 23:42:22,540:WARNING: 		 linear_patch: 2d
2024-03-08 23:42:22,540:WARNING: 	 cut_top_layer: 0
2024-03-08 23:42:24,394:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,438:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,482:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,525:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,569:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,613:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,657:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,701:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,744:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,787:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,831:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,875:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,918:INFO: Drop path rate: 0.0
2024-03-08 23:42:24,961:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,004:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,047:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,091:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,133:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,175:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,218:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,260:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,304:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,346:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,388:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,431:INFO: Use checkpoint: True
2024-03-08 23:42:25,431:INFO: Checkpoint number: [24, 100]
2024-03-08 23:42:25,431:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,494:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,555:INFO: Drop path rate: 0.0
2024-03-08 23:42:25,616:INFO: Drop path rate: 0.0
2024-03-08 23:42:26,674:WARNING: 	 sim_header: meanP
2024-03-08 23:42:26,703:INFO: ***** Running test *****
2024-03-08 23:42:26,704:INFO:   Num examples = 1243
2024-03-08 23:42:26,704:INFO:   Batch size = 8
2024-03-08 23:42:26,704:INFO:   Num steps = 156
2024-03-08 23:42:26,704:INFO: ***** Running val *****
2024-03-08 23:42:26,704:INFO:   Num examples = 1243
2024-03-08 23:42:26,851:INFO: ***** Running training *****
2024-03-08 23:42:26,851:INFO:   Num examples = 4212
2024-03-08 23:42:26,851:INFO:   Batch size = 8
2024-03-08 23:42:26,851:INFO:   Num steps = 526
2024-03-08 23:43:13,465:INFO: Effective parameters:
2024-03-08 23:43:13,465:INFO:   <<< batch_size: 1
2024-03-08 23:43:13,465:INFO:   <<< batch_size_val: 1
2024-03-08 23:43:13,465:INFO:   <<< cache_dir: 
2024-03-08 23:43:13,465:INFO:   <<< cdcr: 0
2024-03-08 23:43:13,465:INFO:   <<< clip_evl: True
2024-03-08 23:43:13,465:INFO:   <<< coef_lr: 0.002
2024-03-08 23:43:13,465:INFO:   <<< cross_model: cross-base
2024-03-08 23:43:13,465:INFO:   <<< cross_num_hidden_layers: 4
2024-03-08 23:43:13,465:INFO:   <<< data_path: ./data/ActivityNet/
2024-03-08 23:43:13,465:INFO:   <<< datatype: activity
2024-03-08 23:43:13,465:INFO:   <<< do_eval: False
2024-03-08 23:43:13,465:INFO:   <<< do_lower_case: False
2024-03-08 23:43:13,465:INFO:   <<< do_pretrain: False
2024-03-08 23:43:13,465:INFO:   <<< do_train: True
2024-03-08 23:43:13,465:INFO:   <<< epochs: 1
2024-03-08 23:43:13,465:INFO:   <<< eval_frame_order: 0
2024-03-08 23:43:13,465:INFO:   <<< expand_msrvtt_sentences: True
2024-03-08 23:43:13,465:INFO:   <<< feature_framerate: 1
2024-03-08 23:43:13,465:INFO:   <<< features_path: /home/totuanan/Workplace/AICityChallenge2024_Track2/feat_extractor/data/retrieval/videos
2024-03-08 23:43:13,465:INFO:   <<< fp16: False
2024-03-08 23:43:13,465:INFO:   <<< fp16_opt_level: O1
2024-03-08 23:43:13,465:INFO:   <<< freeze_layer_num: 0
2024-03-08 23:43:13,465:INFO:   <<< gpu: 0
2024-03-08 23:43:13,465:INFO:   <<< gradient_accumulation_steps: 1
2024-03-08 23:43:13,465:INFO:   <<< hard_negative_rate: 0.5
2024-03-08 23:43:13,465:INFO:   <<< init_model: None
2024-03-08 23:43:13,465:INFO:   <<< interaction: no
2024-03-08 23:43:13,465:INFO:   <<< linear_patch: 2d
2024-03-08 23:43:13,465:INFO:   <<< local_rank: 0
2024-03-08 23:43:13,465:INFO:   <<< loose_type: True
2024-03-08 23:43:13,465:INFO:   <<< lr: 0.001
2024-03-08 23:43:13,465:INFO:   <<< lr_decay: 0.9
2024-03-08 23:43:13,465:INFO:   <<< margin: 0.1
2024-03-08 23:43:13,465:INFO:   <<< max_frames: 64
2024-03-08 23:43:13,465:INFO:   <<< max_words: 77
2024-03-08 23:43:13,465:INFO:   <<< mergeclip: False
2024-03-08 23:43:13,465:INFO:   <<< mergeweight: 0.5
2024-03-08 23:43:13,465:INFO:   <<< n_display: 50
2024-03-08 23:43:13,465:INFO:   <<< n_gpu: 1
2024-03-08 23:43:13,465:INFO:   <<< n_pair: 1
2024-03-08 23:43:13,465:INFO:   <<< negative_weighting: 1
2024-03-08 23:43:13,465:INFO:   <<< num_thread_reader: 1
2024-03-08 23:43:13,465:INFO:   <<< output_dir: vidintern_output
2024-03-08 23:43:13,465:INFO:   <<< pretrained_clip_name: ViT-L/14
2024-03-08 23:43:13,465:INFO:   <<< pretrained_path: ViT-L/14
2024-03-08 23:43:13,465:INFO:   <<< rank: 0
2024-03-08 23:43:13,465:INFO:   <<< resume_model: None
2024-03-08 23:43:13,465:INFO:   <<< sampled_use_mil: False
2024-03-08 23:43:13,465:INFO:   <<< seed: 42
2024-03-08 23:43:13,466:INFO:   <<< sim_header: meanP
2024-03-08 23:43:13,466:INFO:   <<< slice_framepos: 2
2024-03-08 23:43:13,466:INFO:   <<< task_type: retrieval
2024-03-08 23:43:13,466:INFO:   <<< text_num_hidden_layers: 12
2024-03-08 23:43:13,466:INFO:   <<< train_csv: data/MSR-VTT/anns/MSRVTT_train.9k.csv
2024-03-08 23:43:13,466:INFO:   <<< train_frame_order: 0
2024-03-08 23:43:13,466:INFO:   <<< use_mil: False
2024-03-08 23:43:13,466:INFO:   <<< val_csv: data/MSR-VTT/anns/MSRVTT_JSFUSION_test.csv
2024-03-08 23:43:13,466:INFO:   <<< video_dim: 1024
2024-03-08 23:43:13,466:INFO:   <<< visual_num_hidden_layers: 12
2024-03-08 23:43:13,466:INFO:   <<< warmup_proportion: 0.1
2024-03-08 23:43:13,466:INFO:   <<< world_size: 1
2024-03-08 23:43:13,466:INFO:   <<< wti_arch: 0
2024-03-08 23:43:13,466:INFO: device: cuda:0 n_gpu: 1
2024-03-08 23:43:14,754:INFO: loading archive file /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base
2024-03-08 23:43:14,755:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-03-08 23:43:14,755:INFO: Weight doesn't exsits. /home/totuanan/Workplace/AICityChallenge2024_Track2/Video-Text-Retrieval/modules/cross-base/cross_pytorch_model.bin
2024-03-08 23:43:14,755:WARNING: Stage-One:True, Stage-Two:False
2024-03-08 23:43:14,755:WARNING: Test retrieval by loose type.
2024-03-08 23:43:14,755:WARNING: 	 embed_dim: 768
2024-03-08 23:43:14,755:WARNING: 	 image_resolution: 224
2024-03-08 23:43:14,755:WARNING: 	 vision_layers: 24
2024-03-08 23:43:14,755:WARNING: 	 vision_width: 1024
2024-03-08 23:43:14,755:WARNING: 	 vision_patch_size: 14
2024-03-08 23:43:14,755:WARNING: 	 context_length: 77
2024-03-08 23:43:14,755:WARNING: 	 vocab_size: 49408
2024-03-08 23:43:14,755:WARNING: 	 transformer_width: 768
2024-03-08 23:43:14,755:WARNING: 	 transformer_heads: 12
2024-03-08 23:43:14,755:WARNING: 	 transformer_layers: 12
2024-03-08 23:43:14,755:WARNING: 		 linear_patch: 2d
2024-03-08 23:43:14,755:WARNING: 	 cut_top_layer: 0
2024-03-08 23:43:16,618:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,661:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,704:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,747:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,791:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,835:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,878:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,921:INFO: Drop path rate: 0.0
2024-03-08 23:43:16,964:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,009:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,053:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,096:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,139:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,182:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,227:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,269:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,311:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,354:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,396:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,440:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,482:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,525:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,569:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,612:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,656:INFO: Use checkpoint: True
2024-03-08 23:43:17,656:INFO: Checkpoint number: [24, 100]
2024-03-08 23:43:17,657:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,720:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,783:INFO: Drop path rate: 0.0
2024-03-08 23:43:17,847:INFO: Drop path rate: 0.0
2024-03-08 23:43:18,903:WARNING: 	 sim_header: meanP
2024-03-08 23:43:18,933:INFO: ***** Running test *****
2024-03-08 23:43:18,933:INFO:   Num examples = 1243
2024-03-08 23:43:18,933:INFO:   Batch size = 1
2024-03-08 23:43:18,933:INFO:   Num steps = 1243
2024-03-08 23:43:18,933:INFO: ***** Running val *****
2024-03-08 23:43:18,933:INFO:   Num examples = 1243
2024-03-08 23:43:19,079:INFO: ***** Running training *****
2024-03-08 23:43:19,079:INFO:   Num examples = 4212
2024-03-08 23:43:19,079:INFO:   Batch size = 1
2024-03-08 23:43:19,079:INFO:   Num steps = 4212
